<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shafa Abid Automation BD | Premium Industrial Solutions</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brandBlue: '#2196F3',
              brandOrange: '#FF5722',
              brandDark: '#1A1A1A',
              brandGray: '#F3F4F6',
              wechat: '#07C160',
              facebook: '#1877F2',
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
            animation: {
              'scroll': 'scroll 40s linear infinite',
              'fade-in': 'fadeIn 0.5s ease-out forwards',
              'slide-in': 'slideIn 0.3s ease-out forwards',
              'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'blink-soft': 'blinkSoft 1.5s ease-in-out infinite',
              'pulse-border': 'pulseBorder 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            },
            keyframes: {
              scroll: {
                '0%': { transform: 'translateX(0)' },
                '100%': { transform: 'translateX(-100%)' },
              },
              fadeIn: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              },
              slideIn: {
                '0%': { transform: 'translateX(100%)' },
                '100%': { transform: 'translateX(0)' },
              },
              blinkSoft: {
                '0%, 100%': { 
                  opacity: '1',
                  backgroundColor: '#f97316',
                  boxShadow: '0 0 10px #f97316'
                },
                '50%': { 
                  opacity: '0.8',
                  backgroundColor: '#fb923c',
                  boxShadow: '0 0 15px #f97316'
                }
              },
              pulseBorder: {
                '0%, 100%': { borderColor: '#f97316', borderWidth: '2px' },
                '50%': { borderColor: '#2196F3', borderWidth: '3px' },
              }
            }
          }
        }
      }
    </script>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <!-- Leaflet for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            scroll-behavior: smooth; 
            background-color: #F8FAFC;
        }
        .glass { 
            background: rgba(255, 255, 255, 0.98); 
            backdrop-filter: blur(10px); 
            border-bottom: 1px solid rgba(33, 150, 243, 0.1); 
        }
        .hero-overlay { 
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(33, 150, 243, 0.3) 100%); 
        }
        ::-webkit-scrollbar { 
            width: 8px; 
        }
        ::-webkit-scrollbar-track { 
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb { 
            background: #2196F3; 
            border-radius: 4px; 
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #FF5722;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .star-rating {
            color: #FFD700;
        }
        @media print {
            .no-print {
                display: none;
            }
        }
        .invoice-price {
            text-align: right;
            font-family: 'Courier New', monospace;
            letter-spacing: 0.5px;
        }
        .payment-notification {
            background-color: #EFF6FF;
            border-left: 4px solid #2196F3;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            margin-top: 8px;
        }
        .warranty-badge {
            background-color: #E8F5E9;
            color: #2E7D32;
            border: 1px solid #A5D6A7;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 10px;
            font-weight: bold;
            display: inline-block;
        }
        .stock-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            display: inline-block;
        }
        .stock-instock {
            background-color: #10b981;
            color: white;
        }
        .stock-preorder {
            background-color: #f97316;
            color: white;
        }
        .stock-outofstock {
            background-color: #ef4444;
            color: white;
        }
        .tracking-btn {
            background-color: #25D366;
            color: white;
            transition: all 0.3s;
        }
        .tracking-btn:hover {
            background-color: #20bd5a;
            transform: translateY(-1px);
        }
        .document-upload {
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .document-upload:hover {
            border-color: #2196F3;
            background-color: #f0f9ff;
        }
        .document-file {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin-top: 4px;
            transition: all 0.2s;
            cursor: pointer;
        }
        .document-file:hover {
            background-color: #f1f5f9;
            border-color: #2196F3;
        }
        .product-modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        .product-modal {
            background-color: white;
            border-radius: 32px;
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        .close-modal {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }
        .close-modal:hover {
            background-color: #fee2e2;
            color: #ef4444;
        }
        .blink-soft-button {
            animation: blinkSoft 1.5s ease-in-out infinite !important;
            font-weight: 900;
            position: relative;
            overflow: hidden;
            border: 2px solid black;
            color: #f25b0a;
            text-transform: uppercase;
            letter-spacing: 1px;
            background-color: #f97316;
            transition: all 0.3s ease;
        }
        .blink-soft-button:hover {
            transform: scale(1.05);
            border-color: #2196F3;
        }
        @keyframes blinkSoft {
            0%, 100% { 
                opacity: 1;
                background-color: #f97316;
                box-shadow: 0 0 10px #f97316;
            }
            50% { 
                opacity: 0.8;
                background-color: #fb923c;
                box-shadow: 0 0 20px #f97316;
            }
        }
        .transaction-id-yellow {
            background-color: #fef9c3;
            color: #854d0e;
            border: 1px solid #facc15;
            padding: 2px 8px;
            border-radius: 16px;
            font-weight: bold;
            font-size: 10px;
            display: inline-block;
        }
        .transaction-id-green {
            background-color: #dcfce7;
            color: #166534;
            border: 1px solid #4ade80;
            padding: 2px 8px;
            border-radius: 16px;
            font-weight: bold;
            font-size: 10px;
            display: inline-block;
        }
        .quote-highlight {
            background: linear-gradient(135deg, #fee2e2 0%, #ffc0c0 100%);
            border-left: 6px solid #ef4444;
            padding: 16px;
            border-radius: 12px;
            margin: 12px 0;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
        }
        .quote-highlight-text {
            color: #b91c1c;
            font-weight: 800;
            font-size: 15px;
            line-height: 1.6;
        }
        .mismatch-warning {
            background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);
            border-left: 6px solid #f97316;
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
            font-size: 12px;
            font-weight: bold;
            color: #9a3412;
        }
        .mismatch-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
        }
        .mismatch-icon {
            color: #f97316;
            font-size: 14px;
        }
        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #2196F3;
        }
        .profile-pic-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #2196F3;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }
        .profile-header {
            background: linear-gradient(135deg, #2196F3 0%, #FF5722 100%);
            padding: 32px;
            border-radius: 24px;
            color: white;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .password-input-container {
            position: relative;
        }
        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #64748b;
            transition: color 0.2s;
        }
        .password-toggle:hover {
            color: #2196F3;
        }
        .document-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 9px;
            font-weight: bold;
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
            cursor: pointer;
        }
        .document-badge:hover {
            background-color: #d0ebd0;
        }
        .certificate-preview {
            max-width: 200px;
            max-height: 200px;
            object-fit: contain;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
        }
        .doc-viewer-modal {
            position: fixed;
            inset: 0;
            background-color: rgba(0,0,0,0.95);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .doc-viewer-content {
            background: white;
            border-radius: 24px;
            max-width: 90vw;
            max-height: 90vh;
            overflow: auto;
            padding: 24px;
            position: relative;
        }
        .doc-viewer-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2001;
        }
        .doc-viewer-close:hover {
            background: #fee2e2;
            color: #ef4444;
        }
        .map-container {
            height: 300px;
            width: 100%;
            border-radius: 16px;
            overflow: hidden;
            margin-top: 16px;
            z-index: 1;
        }
        .wechat-qr-modal {
            position: fixed;
            inset: 0;
            background-color: rgba(0,0,0,0.9);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .wechat-qr-content {
            background: white;
            border-radius: 24px;
            max-width: 400px;
            width: 100%;
            padding: 32px;
            text-align: center;
            position: relative;
        }
        .order-table-row {
            transition: all 0.2s;
        }
        .order-table-row:hover {
            background-color: #f8fafc;
        }
        .status-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            display: inline-block;
        }
        .print-btn {
            background-color: #6366f1;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }
        .print-btn:hover {
            background-color: #4f46e5;
        }
        .processing-active {
            border: 2px solid #f97316;
            animation: pulse 2s infinite;
        }
        .shipping-info-box {
            background: linear-gradient(135deg, #f3f4f6 0%, #ffffff 100%);
            border: 2px solid #2196F3;
            border-radius: 16px;
            padding: 20px;
            margin: 10px 0;
        }
        .document-upload-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
        }
        .upload-label {
            font-size: 10px;
            font-weight: bold;
            color: #64748b;
            text-transform: uppercase;
            margin-bottom: 4px;
            display: block;
        }
        .qr-preview {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .qr-preview:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .social-link {
            transition: all 0.3s;
        }
        .social-link:hover {
            transform: translateY(-2px);
        }
        .quote-extra-field {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px;
            margin-top: 12px;
            background-color: #f8fafc;
        }
        .product-image-upload {
            display: inline-block;
            width: 80px;
            height: 80px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            text-align: center;
            line-height: 76px;
            cursor: pointer;
            margin-right: 8px;
            margin-bottom: 8px;
            overflow: hidden;
        }
        .product-image-upload img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .product-image-upload:hover {
            border-color: #2196F3;
        }
    </style>
</head>
<body class="bg-slate-50 text-brandDark antialiased selection:bg-brandBlue selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useRef, useCallback } = React;

        // Supabase Configuration
const supabaseUrl = 'https://ymsgbefursktbjgjdfy.supabase.co';
const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inltc2diZWZ1cnNrdGJpamdqZGZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNDY2NDgsImV4cCI6MjA4NzYyMjY0OH0.luUFjfy0XFOUZfPjsyI2FbZvUuq_xYB4wVDfDUlKrDc';
const supabase = window.supabase.createClient(supabaseUrl, supabaseAnonKey);
        
        // --- CONSTANTS & DATA ---
        const COMPANY_INFO = {
          name: "Shafa Abid Automation BD",
          shortName: "Shafa Abid",
          slogan: "Electrical & Electronics Solution",
          phone: "+880 1869-552775",
          whatsapp: "+880 1406-503242",
          email: "shafaabidautomation.bd@gmail.com",
          address: "Shop No: 01, Coat para, Kumira-4314, Sitakunda, Chattogram, Bangladesh",
          mapLink: "https://www.google.com/maps/place/Shafa+Abid+Automation+BD/@22.501896,91.7119933,17z/data=!4m14!1m7!3m6!1s0x30acd10664ffbd39:0xc53e11fe209baee3!2sShafa+Abid+Automation+BD!8m2!3d22.501896!4d91.7119933!16s%2Fg%2F11x5wscn8w!3m5!1s0x30acd10664ffbd39:0xc53e11fe209baee3!8m2!3d22.501896!4d91.7119933!16s%2Fg%2F11x5wscn8w?entry=ttu&g_ep=EgoyMDI2MDIxOC4wIKXMDSoASAFQAw%3D%3D",
          facebook: "https://web.facebook.com/profile.php?id=61574697974139",
          wechat: "wxid_sfs46z54x88o22",
          tradeLicense: "05/470",
          bin: "007107446-0508",
          coordinates: {
            lat: 22.6167,
            lng: 91.6500
          },
          bankDetails: {
            accountName: "SHAFA ABID AUTOMATION BD",
            accountNumber: "1234567890123456",
            branch: "KHATUNGANJ, CTG",
            bankName: "UNITED COMMERCIAL BANK PLC",
            mobileBanking: "01406503242"
          }
        };

        const ADMIN_PASSWORD = "0054";
        const DEFAULT_LOGO = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='80' viewBox='0 0 200 80'%3E%3Crect width='200' height='80' fill='%232196F3'/%3E%3Ctext x='20' y='30' font-family='Arial' font-size='16' fill='white' font-weight='bold'%3EShafa%3C/text%3E%3Ctext x='20' y='50' font-family='Arial' font-size='16' fill='white' font-weight='bold'%3EAbid%3C/text%3E%3Ctext x='20' y='70' font-family='Arial' font-size='12' fill='white'%3EAutomation BD%3C/text%3E%3C/svg%3E"; 
        
        const DEFAULT_HERO_CONFIG = {
            interval: 5,
            images: [
                "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?auto=format&fit=crop&q=80&w=2070",
                "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&q=80&w=2070",
                "https://images.unsplash.com/photo-1531297461136-82e5a7d2b0e7?auto=format&fit=crop&q=80&w=2070",
                "https://images.unsplash.com/photo-1581092335871-4c8eef2f8e7c?auto=format&fit=crop&q=80&w=2070",
                "https://images.unsplash.com/photo-1581092918056-0c4c3acd5e9f?auto=format&fit=crop&q=80&w=2070"
            ]
        };

        const STOCK_STATUS_OPTIONS = [
            { value: 'in-stock', label: 'IN STOCK', color: 'bg-green-500' },
            { value: '7-15-days', label: '7-15 DAYS', color: 'bg-orange-500' },
            { value: '15-30-days', label: '15-30 DAYS', color: 'bg-orange-500' },
            { value: '30-45-days', label: '30-45 DAYS', color: 'bg-orange-500' },
            { value: 'out-of-stock', label: 'OUT OF STOCK', color: 'bg-red-500' }
        ];

        const LEAD_TIME_OPTIONS = [
            '7-15 days',
            '15-30 days', 
            '30-45 days',
            '45-60 days',
            '2-3 months',
            '3-4 months',
            '4-6 months',
            'Contact for exact timeline'
        ];

        const WARRANTY_OPTIONS = [
            '3 months',
            '6 months',
            '1 year'
        ];

        const WARRANTY_TERMS = {
            '3 months': 'Warranty applicable for 3 months in case of manufacture defect, low quality of product. Warranty not applicable for physical damage and due to short circuit by User.',
            '6 months': 'Warranty applicable for 6 months in case of manufacture defect, low quality of product. Warranty not applicable for physical damage and due to short circuit by User.',
            '1 year': 'Warranty applicable for 1 year in case of manufacture defect, low quality of product. Warranty not applicable for physical damage and due to short circuit by User.'
        };

        const REFUND_POLICY = 'Refund Policy: When products are low quality, broken by our team, or wrong products then refund within 4 hours, but must need proofed by pictures, unboxing videos provided in our customer care WhatsApp. Otherwise refund not provided from our side.';

        const BANK_TRANSFER_TERMS = 'For Bank Transfer: We will provide Mushak-6.3. You must provide Mushak-6.6 with VDS & TDS Challan copy after delivery.';

        const DEFAULT_ORIGIN_OPTIONS = ['China', 'India', 'Germany', 'USA', 'Japan', 'South Korea', 'Italy', 'UK', 'Taiwan', 'Other'];
        
        const COURIER_PLATFORMS = [
            { id: 'paperfly', name: 'PaperFly', url: 'https://paperfly.com.bd/tracking?tracking_number=' },
            { id: 'steadfast', name: 'SteadFast', url: 'https://steadfast.com.bd/tracking/' },
            { id: 'redx', name: 'REDX BD', url: 'https://redx.com.bd/tracking/' },
            { id: 'pathao', name: 'Pathao', url: 'https://pathao.com/courier/track/' },
            { id: 'sundarban', name: 'Sundarban Courier', url: 'https://tracking.sundarbancourierltd.com/?cnnumber=' }
        ];

        const CONDITION_OPTIONS = ['Brand New', 'Refurbished', 'Second-hand', 'Ship Used', 'Reconditioned', 'Factory Sealed'];

        // WhatsApp number formatter
        const formatWhatsAppNumber = (phone) => {
            if (!phone) return '';
            const digits = phone.replace(/\D/g, '');
            if (digits.length === 11 && digits.startsWith('0')) {
                return '+880' + digits.substring(1);
            } else if (digits.length === 10 && digits.startsWith('1')) {
                return '+880' + digits;
            } else if (digits.length === 13 && digits.startsWith('880')) {
                return '+' + digits;
            } else if (phone.startsWith('+880')) {
                return phone;
            } else {
                return '+880' + digits;
            }
        };

        const getWhatsAppLink = (phone, message) => {
            const formatted = formatWhatsAppNumber(phone);
            const digits = formatted.replace(/\D/g, '');
            return `https://wa.me/${digits}?text=${encodeURIComponent(message)}`;
        };

        const PAYMENT_NOTIFICATIONS = {
            cod: "âœ“ Cash on Delivery - Pay when you receive the products (No AIT/VAT applicable)",
            bkash: "ðŸ“± Please send payment to " + COMPANY_INFO.bankDetails.mobileBanking + " (bKash) and submit transaction ID. For assistance, WhatsApp us at " + formatWhatsAppNumber(COMPANY_INFO.whatsapp),
            nagad: "ðŸ“± Please send payment to " + COMPANY_INFO.bankDetails.mobileBanking + " (Nagad) and submit transaction ID. For assistance, WhatsApp us at " + formatWhatsAppNumber(COMPANY_INFO.whatsapp),
            rocket: "ðŸ“± Please send payment to " + COMPANY_INFO.bankDetails.mobileBanking + " (Rocket) and submit transaction ID. For assistance, WhatsApp us at " + formatWhatsAppNumber(COMPANY_INFO.whatsapp),
            bank: "ðŸ¦ " + BANK_TRANSFER_TERMS + " Pay to: " + COMPANY_INFO.bankDetails.accountName + " - A/C: " + COMPANY_INFO.bankDetails.accountNumber + " - " + COMPANY_INFO.bankDetails.bankName + " - Branch: " + COMPANY_INFO.bankDetails.branch + " | WhatsApp: " + formatWhatsAppNumber(COMPANY_INFO.whatsapp)
        };

        const INITIAL_BRANDS = [
            { id: 'b1', name: 'Siemens', logo: 'https://upload.wikimedia.org/wikipedia/commons/5/5f/Siemens-logo.svg' },
            { id: 'b2', name: 'ABB', logo: 'https://upload.wikimedia.org/wikipedia/commons/0/00/ABB_logo.svg' },
            { id: 'b3', name: 'Schneider Electric', logo: 'https://upload.wikimedia.org/wikipedia/commons/9/95/Schneider_Electric_2007.svg' },
            { id: 'b4', name: 'Phoenix Contact', logo: 'https://upload.wikimedia.org/wikipedia/commons/0/0b/Phoenix_Contact_logo.svg' },
            { id: 'b5', name: 'Omron', logo: 'https://upload.wikimedia.org/wikipedia/commons/5/50/Omron_logo.svg' },
            { id: 'b6', name: 'Mitsubishi Electric', logo: 'https://upload.wikimedia.org/wikipedia/commons/b/b7/Mitsubishi-Electric-Logo.svg' },
            { id: 'b7', name: 'Wago', logo: 'https://upload.wikimedia.org/wikipedia/commons/9/9c/Wago_Logo.svg' },
            { id: 'b8', name: 'Eaton', logo: 'https://upload.wikimedia.org/wikipedia/commons/e/e3/Eaton_Corporation_logo.svg' }
        ];

        const INITIAL_PRODUCTS = [
          { id: '1', name: 'Siemens SIMATIC S7-1200 PLC CPU 1214C DC/DC/DC', brand: 'Siemens', origin: 'Germany', category: 'PLCs', image: 'https://images.unsplash.com/photo-1590959651373-a3db0f38a961?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 25000, description: 'Compact CPU with 14 DI/10 DO, 2 AI, includes program memory', datasheet: null },
          { id: '2', name: 'ABB ACS355 Variable Frequency Drive 5.5kW 3-Phase', brand: 'ABB', origin: 'China', category: 'VFDs', image: 'https://images.unsplash.com/photo-1618764400608-9e7115e37341?auto=format&fit=crop&q=80&w=400', stockStatus: '15-30-days', price: 45000, description: 'Sensorless vector control, IP20 enclosure, built-in EMC filter', leadTime: '15-30 days', datasheet: null },
          { id: '3', name: 'Schneider TeSys Deca Contactor 18A AC3 220V', brand: 'Schneider Electric', origin: 'France', category: 'Contactors', image: 'https://images.unsplash.com/photo-1558486012-817176f84c6d?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 3500, description: '3-pole contactor with 1NO auxiliary contact, screw terminals', datasheet: null },
          { id: '4', name: 'Phoenix Contact Quint Power Supply 24V/10A', brand: 'Phoenix Contact', origin: 'Germany', category: 'Power Supplies', image: 'https://images.unsplash.com/photo-1619623631988-c750b3f57285?auto=format&fit=crop&q=80&w=400', stockStatus: 'out-of-stock', price: 12000, description: 'Primary-switched power supply, SFB technology, 24V DC', datasheet: null },
          { id: '5', name: 'Bosch Rexroth IndraDrive Servo Motor MSK 050C', brand: 'Rexroth', origin: 'Germany', category: 'Motors', image: 'https://images.unsplash.com/photo-1581092160562-40aa08e78837?auto=format&fit=crop&q=80&w=400', stockStatus: '30-45-days', price: 85000, description: 'High dynamic synchronous servo motor with resolver', leadTime: '30-45 days', datasheet: null },
          { id: '6', name: 'Wago 221 Series Lever-Nut Connectors (50-pack)', brand: 'Wago', origin: 'Germany', category: 'Connectors', image: 'https://images.unsplash.com/photo-1619623631988-c750b3f57285?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 1250, description: 'Compact splicing connectors for all conductor types, 32A, 450V', datasheet: null },
          { id: '7', name: 'Siemens SIMATIC HMI KTP700 Basic PN', brand: 'Siemens', origin: 'Germany', category: 'HMIs', image: 'https://images.unsplash.com/photo-1590959651373-a3db0f38a961?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 32000, description: '7" TFT display, touch screen, 8 function keys, PROFINET interface', datasheet: null },
          { id: '8', name: 'Schneider Acti9 iC60N MCB 16A 3P C-Curve', brand: 'Schneider Electric', origin: 'France', category: 'Circuit Breakers', image: 'https://images.unsplash.com/photo-1558486012-817176f84c6d?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 1200, description: 'Multi-standard circuit breaker, 6kA breaking capacity', datasheet: null },
          { id: '9', name: 'ABB Emax 2 Air Circuit Breaker 1600A E2.2', brand: 'ABB', origin: 'China', category: 'Circuit Breakers', image: 'https://images.unsplash.com/photo-1618764400608-9e7115e37341?auto=format&fit=crop&q=80&w=400', stockStatus: '7-15-days', price: 150000, description: 'Embedded connectivity, Ekip Touch protection unit', leadTime: '7-15 days', datasheet: null },
          { id: '10', name: 'Phoenix Relay Module RIF-1 Series 24VDC', brand: 'Phoenix Contact', origin: 'Germany', category: 'Relays', image: 'https://images.unsplash.com/photo-1619623631988-c750b3f57285?auto=format&fit=crop&q=80&w=400', stockStatus: 'in-stock', price: 850, description: 'Complete relay module with push-in technology', datasheet: null }
        ];

        const SERVICES = [
            { icon: "fa-project-diagram", title: "Panel Design & Fabrication", desc: "Custom HT/LT, MCC, PCC, and PFI panels designed and fabricated to international standards." },
            { icon: "fa-microchip", title: "PLC & SCADA Automation", desc: "Advanced programming, system integration, and commissioning for all major brands." },
            { icon: "fa-tools", title: "24/7 Maintenance Support", desc: "Emergency on-site troubleshooting, preventive maintenance, and technical support." },
            { icon: "fa-chart-line", title: "Energy Management", desc: "Power quality analysis, energy auditing, and efficiency optimization solutions." },
            { icon: "fa-robot", title: "Industrial Robotics", desc: "Robot programming, integration, and maintenance for manufacturing automation." },
            { icon: "fa-graduation-cap", title: "Technical Training", desc: "Hands-on training programs for engineers and technicians on automation systems." }
        ];

        const validatePhoneNumber = (phone) => {
            const digits = phone.replace(/\D/g, '');
            return digits.length === 11 && digits.startsWith('0');
        };

        const formatPhoneNumber = (phone) => {
            const digits = phone.replace(/\D/g, '');
            if (digits.length === 11 && digits.startsWith('0')) {
                return '+88' + digits;
            }
            return phone;
        };

        // PDF Generation Function - FIXED FORMATTING
        const generateInvoicePDF = (order, logo, documents = {}) => {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });
            
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 15;
            
            let yPos = margin;
            
            // Company Header with Logo
            try {
                if (logo && logo.startsWith('data:image')) {
                    doc.addImage(logo, 'PNG', margin, yPos, 35, 17, undefined, 'MEDIUM');
                } else {
                    doc.setFontSize(18);
                    doc.setTextColor(33, 150, 243);
                    doc.setFont('helvetica', 'bold');
                    doc.text('Shafa Abid', margin, yPos + 8);
                    doc.setFontSize(12);
                    doc.setTextColor(100);
                    doc.text('Automation BD', margin, yPos + 15);
                }
            } catch (e) {
                doc.setFontSize(18);
                doc.setTextColor(33, 150, 243);
                doc.setFont('helvetica', 'bold');
                doc.text('Shafa Abid', margin, yPos + 8);
                doc.setFontSize(12);
                doc.setTextColor(100);
                doc.text('Automation BD', margin, yPos + 15);
            }
            
            // Company Name and Details
            doc.setFontSize(16);
            doc.setTextColor(33, 150, 243);
            doc.setFont('helvetica', 'bold');
            doc.text(COMPANY_INFO.name, pageWidth - margin, yPos + 5, { align: 'right' });
            
            doc.setFontSize(8);
            doc.setTextColor(100);
            doc.setFont('helvetica', 'normal');
            doc.text(COMPANY_INFO.slogan, pageWidth - margin, yPos + 12, { align: 'right' });
            doc.text(COMPANY_INFO.address, pageWidth - margin, yPos + 17, { align: 'right' });
            doc.text(`Tel: ${COMPANY_INFO.phone} | Email: ${COMPANY_INFO.email} | WhatsApp: ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`, pageWidth - margin, yPos + 22, { align: 'right' });
            
            yPos += 30;
            
            // Separator Line
            doc.setDrawColor(200, 200, 200);
            doc.line(margin, yPos - 2, pageWidth - margin, yPos - 2);
            
            // Invoice Title
            doc.setFontSize(20);
            doc.setTextColor(0);
            doc.setFont('helvetica', 'bold');
            doc.text('TAX INVOICE', pageWidth / 2, yPos, { align: 'center' });
            
            yPos += 8;
            
            // Software Generated Note
            doc.setFontSize(8);
            doc.setTextColor(150);
            doc.setFont('helvetica', 'italic');
            doc.text('SOFTWARE GENERATED INVOICE - NO SIGNATURE REQUIRED', pageWidth / 2, yPos, { align: 'center' });
            
            yPos += 8;
            
            // Separator Line
            doc.setDrawColor(200, 200, 200);
            doc.line(margin, yPos, pageWidth - margin, yPos);
            
            yPos += 8;
            
            // Invoice Details
            doc.setFontSize(9);
            doc.setTextColor(60);
            doc.setFont('helvetica', 'normal');
            
            doc.text(`Invoice No: INV-${order.id}`, margin, yPos);
            doc.text(`Date: ${order.date}`, margin, yPos + 5);
            doc.text(`Order ID: ${order.id}`, margin, yPos + 10);
            
            doc.text(`Trade License: ${COMPANY_INFO.tradeLicense}`, pageWidth - margin - 60, yPos);
            doc.text(`BIN: ${COMPANY_INFO.bin}`, pageWidth - margin - 60, yPos + 5);
            
            if (order.status === 'Approved' || order.status === 'Shipped') {
                const deliveryDate = new Date();
                deliveryDate.setDate(deliveryDate.getDate() + (order.leadTime ? parseInt(order.leadTime) : 15));
                doc.text(`Est. Delivery: ${deliveryDate.toLocaleDateString()}`, pageWidth - margin - 60, yPos + 10);
            }
            
            yPos += 18;
            
            // Bill To Section
            doc.setFillColor(245, 245, 245);
            doc.rect(margin, yPos - 3, pageWidth - (margin * 2), 20, 'F');
            
            doc.setFontSize(11);
            doc.setTextColor(33, 150, 243);
            doc.setFont('helvetica', 'bold');
            doc.text('Bill To:', margin + 2, yPos + 4);
            
            doc.setFontSize(9);
            doc.setTextColor(0);
            doc.setFont('helvetica', 'normal');
            doc.text(order.customer.name, margin + 2, yPos + 10);
            doc.text(formatPhoneNumber(order.customer.phone), margin + 2, yPos + 15);
            doc.text(`${order.customer.road}, ${order.customer.thana}, ${order.customer.city}`, margin + 2, yPos + 20);
            
            yPos += 25;
            
            // Table Configuration
            const tableColumn = [
                { header: 'SL', dataKey: 'sl' },
                { header: 'Product', dataKey: 'product' },
                { header: 'Brand/Origin', dataKey: 'brandOrigin' },
                { header: 'Qty', dataKey: 'qty' },
                { header: 'Unit Price (à§³)', dataKey: 'unitPrice' },
                { header: 'Total (à§³)', dataKey: 'total' }
            ];
            
            const tableRows = [];
            let subtotal = 0;
            
            order.items.forEach((item, index) => {
                const unitPrice = order.quotedPrice ? order.quotedPrice / item.qty : (item.price || 0);
                const itemTotal = order.quotedPrice || (item.price ? item.price * item.qty : 0);
                subtotal += itemTotal;
                
                tableRows.push({
                    sl: index + 1,
                    product: item.name.length > 40 ? item.name.substring(0, 37) + '...' : item.name,
                    brandOrigin: `${item.brand}${item.origin ? ', ' + item.origin : ''}`,
                    qty: item.qty,
                    unitPrice: unitPrice.toFixed(2),
                    total: itemTotal.toFixed(2)
                });
            });
            
            // Generate Table
            doc.autoTable({
                columns: tableColumn,
                body: tableRows,
                startY: yPos,
                margin: { left: margin, right: margin },
                styles: {
                    fontSize: 8,
                    cellPadding: 3,
                    lineColor: [200, 200, 200],
                    lineWidth: 0.1,
                    font: 'helvetica',
                    textColor: [0, 0, 0]
                },
                headStyles: {
                    fillColor: [33, 150, 243],
                    textColor: [255, 255, 255],
                    fontStyle: 'bold',
                    fontSize: 9,
                    halign: 'center'
                },
                columnStyles: {
                    sl: { cellWidth: 15, halign: 'center' },
                    product: { cellWidth: 'auto' },
                    brandOrigin: { cellWidth: 35, halign: 'center' },
                    qty: { cellWidth: 15, halign: 'center' },
                    unitPrice: { cellWidth: 30, halign: 'right', fontStyle: 'bold' },
                    total: { cellWidth: 30, halign: 'right', fontStyle: 'bold' }
                },
                foot: [['', '', '', '', 'Total:', `${subtotal.toFixed(2)} à§³`]],
                footStyles: {
                    fillColor: [240, 240, 240],
                    textColor: [0, 0, 0],
                    fontStyle: 'bold',
                    halign: 'right',
                    fontSize: 9
                }
            });
            
            yPos = doc.lastAutoTable.finalY + 10;
            
            // Price Calculation Box
            const calcBoxWidth = 80;
            const calcBoxX = pageWidth - margin - calcBoxWidth;
            
            doc.setFillColor(250, 250, 250);
            doc.rect(calcBoxX, yPos, calcBoxWidth, 50, 'F');
            doc.setDrawColor(200, 200, 200);
            doc.rect(calcBoxX, yPos, calcBoxWidth, 50, 'S');
            
            doc.setFontSize(9);
            doc.setTextColor(60);
            doc.setFont('helvetica', 'normal');
            
            let calcY = yPos + 8;
            
            if (order.payment?.method === 'cod') {
                doc.setFontSize(11);
                doc.setTextColor(33, 150, 243);
                doc.setFont('helvetica', 'bold');
                doc.text('NET PRICE:', calcBoxX + 5, calcY + 12);
                doc.setFontSize(14);
                const netPrice = (order.quotedPrice || order.totals?.subtotal || 0).toFixed(2);
                doc.text(`${netPrice} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 12, { align: 'right' });
            } else if (order.totals) {
                doc.text('Subtotal:', calcBoxX + 5, calcY);
                doc.text(`${order.totals.subtotal.toFixed(2)} à§³`, calcBoxX + calcBoxWidth - 5, calcY, { align: 'right' });
                
                doc.text('AIT (5%):', calcBoxX + 5, calcY + 8);
                doc.text(`${order.totals.ait.toFixed(2)} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 8, { align: 'right' });
                
                doc.setFont('helvetica', 'bold');
                doc.text('Total after AIT:', calcBoxX + 5, calcY + 16);
                doc.text(`${order.totals.totalWithAit.toFixed(2)} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 16, { align: 'right' });
                doc.setFont('helvetica', 'normal');
                
                doc.text('VAT (10%):', calcBoxX + 5, calcY + 24);
                doc.text(`${order.totals.vat.toFixed(2)} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 24, { align: 'right' });
                
                doc.setFontSize(11);
                doc.setTextColor(33, 150, 243);
                doc.setFont('helvetica', 'bold');
                doc.text('GRAND TOTAL:', calcBoxX + 5, calcY + 34);
                doc.text(`${order.totals.grandTotal.toFixed(2)} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 34, { align: 'right' });
            } else if (order.quotedPrice) {
                doc.setFontSize(11);
                doc.setTextColor(33, 150, 243);
                doc.setFont('helvetica', 'bold');
                doc.text('QUOTED PRICE:', calcBoxX + 5, calcY + 20);
                doc.setFontSize(14);
                const quotedPrice = order.quotedPrice.toFixed(2);
                doc.text(`${quotedPrice} à§³`, calcBoxX + calcBoxWidth - 5, calcY + 20, { align: 'right' });
            }
            
            // Payment Details
            let infoY = yPos;
            
            if (order.payment) {
                doc.setFontSize(9);
                doc.setTextColor(60);
                doc.setFont('helvetica', 'bold');
                doc.text('Payment Details:', margin, infoY);
                
                doc.setFont('helvetica', 'normal');
                const paymentMethod = order.payment.method === 'N/A' ? 'Quote - Payment Pending' : order.payment.method.toUpperCase();
                doc.text(`Method: ${paymentMethod}`, margin, infoY + 5);
                
                if (order.payment.method === 'bank') {
                    doc.text(`Pay to: ${COMPANY_INFO.bankDetails.accountName}`, margin, infoY + 10);
                    doc.text(`A/C: ${COMPANY_INFO.bankDetails.accountNumber}`, margin, infoY + 15);
                    doc.text(`Bank: ${COMPANY_INFO.bankDetails.bankName}`, margin, infoY + 20);
                    doc.text(`Branch: ${COMPANY_INFO.bankDetails.branch}`, margin, infoY + 25);
                } else if (order.payment.method !== 'cod' && order.payment.method !== 'N/A') {
                    doc.text(`Pay to: ${COMPANY_INFO.bankDetails.mobileBanking} (${order.payment.method.toUpperCase()})`, margin, infoY + 10);
                } else if (order.payment.method === 'N/A') {
                    doc.text(`Payment will be processed after quote acceptance`, margin, infoY + 10);
                }
                
                if (order.payment.trxId && order.payment.trxId !== 'N/A') {
                    doc.text(`Transaction ID: ${order.payment.trxId}`, margin, infoY + (order.payment.method === 'bank' ? 30 : 15));
                }
                
                doc.text(`WhatsApp: ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`, margin, infoY + (order.payment.method === 'bank' ? 35 : 20));
            }
            
            yPos += 65;
            
            // Warranty Section
            if (order.warranty) {
                doc.setFillColor(240, 255, 240);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'F');
                doc.setDrawColor(100, 200, 100);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'S');
                
                doc.setFontSize(9);
                doc.setTextColor(0, 100, 0);
                doc.setFont('helvetica', 'bold');
                doc.text('WARRANTY:', margin + 2, yPos + 5);
                
                doc.setFontSize(7);
                doc.setFont('helvetica', 'normal');
                const warrantyText = doc.splitTextToSize(WARRANTY_TERMS[order.warranty] || `Warranty: ${order.warranty}`, pageWidth - (margin * 2) - 4);
                doc.text(warrantyText, margin + 2, yPos + 12);
                
                yPos += 30;
            } else {
                doc.setFillColor(240, 255, 240);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 15, 'F');
                doc.setDrawColor(100, 200, 100);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 15, 'S');
                
                doc.setFontSize(9);
                doc.setTextColor(0, 100, 0);
                doc.setFont('helvetica', 'bold');
                doc.text('WARRANTY:', margin + 2, yPos + 5);
                
                doc.setFontSize(7);
                doc.setFont('helvetica', 'normal');
                doc.text('Standard warranty applies as per product terms.', margin + 2, yPos + 10);
                
                yPos += 20;
            }
            
            // Bank Transfer Terms
            if (order.payment?.method === 'bank') {
                doc.setFillColor(255, 250, 200);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'F');
                doc.setDrawColor(200, 150, 0);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'S');
                
                doc.setFontSize(9);
                doc.setTextColor(150, 100, 0);
                doc.setFont('helvetica', 'bold');
                doc.text('BANK TRANSFER TERMS:', margin + 2, yPos + 5);
                
                doc.setFontSize(7);
                doc.setFont('helvetica', 'normal');
                const bankText = doc.splitTextToSize(BANK_TRANSFER_TERMS, pageWidth - (margin * 2) - 4);
                doc.text(bankText, margin + 2, yPos + 12);
                
                yPos += 30;
            } else if (order.payment?.method !== 'cod' && order.payment?.method && order.payment.method !== 'N/A') {
                doc.setFillColor(230, 240, 255);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'F');
                doc.setDrawColor(100, 150, 200);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 25, 'S');
                
                doc.setFontSize(9);
                doc.setTextColor(0, 50, 100);
                doc.setFont('helvetica', 'bold');
                doc.text(`${order.payment.method.toUpperCase()} PAYMENT:`, margin + 2, yPos + 5);
                
                doc.setFontSize(7);
                doc.setFont('helvetica', 'normal');
                const paymentText = doc.splitTextToSize(PAYMENT_NOTIFICATIONS[order.payment.method] || `Payment via ${order.payment.method.toUpperCase()}`, pageWidth - (margin * 2) - 4);
                doc.text(paymentText, margin + 2, yPos + 12);
                
                yPos += 30;
            }
            
            // Documents Section
            if (documents.mushak6_6 || documents.vds || documents.tds || documents.bin_certificate || documents.customer_bin) {
                doc.setFillColor(240, 240, 255);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 20, 'F');
                doc.setDrawColor(100, 100, 200);
                doc.rect(margin, yPos, pageWidth - (margin * 2), 20, 'S');
                
                doc.setFontSize(9);
                doc.setTextColor(50, 50, 150);
                doc.setFont('helvetica', 'bold');
                doc.text('DOCUMENTS SUBMITTED:', margin + 2, yPos + 5);
                
                doc.setFontSize(7);
                doc.setFont('helvetica', 'normal');
                let docText = '';
                if (documents.mushak6_6) docText += 'Mushak-6.6 âœ“ ';
                if (documents.vds) docText += 'VDS âœ“ ';
                if (documents.tds) docText += 'TDS âœ“ ';
                if (documents.bin_certificate) docText += 'BIN (Admin) âœ“ ';
                if (documents.customer_bin) docText += 'BIN (Customer) âœ“ ';
                doc.text(docText, margin + 2, yPos + 12);
                
                yPos += 25;
            }
            
            // Check for new page
            if (yPos > pageHeight - 40) {
                doc.addPage();
                yPos = margin;
            }
            
            // Refund Policy
            doc.setFillColor(255, 240, 240);
            doc.rect(margin, yPos, pageWidth - (margin * 2), 30, 'F');
            doc.setDrawColor(200, 100, 100);
            doc.rect(margin, yPos, pageWidth - (margin * 2), 30, 'S');
            
            doc.setFontSize(10);
            doc.setTextColor(200, 0, 0);
            doc.setFont('helvetica', 'bold');
            doc.text('REFUND POLICY', margin + 2, yPos + 5);
            
            doc.setFontSize(7);
            doc.setTextColor(100, 0, 0);
            doc.setFont('helvetica', 'normal');
            const refundLines = doc.splitTextToSize(REFUND_POLICY, pageWidth - (margin * 2) - 4);
            doc.text(refundLines, margin + 2, yPos + 12);
            
            yPos += 35;
            
            // Footer
            doc.setDrawColor(200, 200, 200);
            doc.line(margin, pageHeight - 20, pageWidth - margin, pageHeight - 20);
            
            doc.setFontSize(8);
            doc.setTextColor(150);
            doc.setFont('helvetica', 'italic');
            doc.text('This is a computer generated invoice. No signature or seal required.', pageWidth / 2, pageHeight - 15, { align: 'center' });
            doc.text('Thank you for your business! For any queries, WhatsApp us at ' + formatWhatsAppNumber(COMPANY_INFO.whatsapp), pageWidth / 2, pageHeight - 10, { align: 'center' });
            
            // Save with proper filename
            doc.save(`invoice-${order.id}.pdf`);
        };

        // --- QR CODE MANAGEMENT FUNCTIONS ---
        const generateQRCodeData = (type, url) => {
            // Using a free QR code API service
            return `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(url)}`;
        };

        // --- SUPABASE DATA LOADING FUNCTIONS ---
        const loadProductsFromSupabase = async () => {
            try {
                const { data, error } = await supabase
                    .from('products')
                    .select('*');
                
                if (error) {
                    console.error('Error loading products from Supabase:', error);
                    return null;
                }
                return data;
            } catch (error) {
                console.error('Supabase products loading error:', error);
                return null;
            }
        };

        const loadOrdersFromSupabase = async () => {
            try {
                const { data, error } = await supabase
                    .from('orders')
                    .select('*');
                
                if (error) {
                    console.error('Error loading orders from Supabase:', error);
                    return null;
                }
                return data;
            } catch (error) {
                console.error('Supabase orders loading error:', error);
                return null;
            }
        };

        const loadUsersFromSupabase = async () => {
            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('*');
                
                if (error) {
                    console.error('Error loading users from Supabase:', error);
                    return null;
                }
                return data;
            } catch (error) {
                console.error('Supabase users loading error:', error);
                return null;
            }
        };

        const saveProductToSupabase = async (product) => {
            try {
                const { data, error } = await supabase
                    .from('products')
                    .insert([product]);
                
                if (error) {
                    console.error('Error saving product to Supabase:', error);
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Supabase product save error:', error);
                return false;
            }
        };

        const saveOrderToSupabase = async (order) => {
            try {
                const { data, error } = await supabase
                    .from('orders')
                    .insert([order]);
                
                if (error) {
                    console.error('Error saving order to Supabase:', error);
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Supabase order save error:', error);
                return false;
            }
        };

        const saveUserToSupabase = async (user) => {
            try {
                const { data, error } = await supabase
                    .from('users')
                    .insert([user]);
                
                if (error) {
                    console.error('Error saving user to Supabase:', error);
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Supabase user save error:', error);
                return false;
            }
        };

        const updateOrderInSupabase = async (orderId, updates) => {
            try {
                const { data, error } = await supabase
                    .from('orders')
                    .update(updates)
                    .eq('order_id', orderId);
                
                if (error) {
                    console.error('Error updating order in Supabase:', error);
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Supabase order update error:', error);
                return false;
            }
        };

        const uploadFileToStorage = async (bucket, file, fileName) => {
            try {
                const { data, error } = await supabase.storage
                    .from(bucket)
                    .upload(fileName, file, {
                        cacheControl: '3600',
                        upsert: false
                    });
                
                if (error) {
                    console.error('Error uploading file to Supabase:', error);
                    return null;
                }
                
                // Get public URL
                const { data: urlData } = supabase.storage
                    .from(bucket)
                    .getPublicUrl(fileName);
                
                return urlData.publicUrl;
            } catch (error) {
                console.error('Supabase file upload error:', error);
                return null;
            }
        };

        // --- MAIN APP COMPONENT ---
        const App = () => {
            const [isAdmin, setIsAdmin] = useState(false);
            const [isAdminMode, setIsAdminMode] = useState(false);
            const [adminTab, setAdminTab] = useState('orders'); 
            const [adminView, setAdminView] = useState('list');
            
            const [activeSection, setActiveSection] = useState('home');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [selectedBrand, setSelectedBrand] = useState(null);
            const [showProfileDropdown, setShowProfileDropdown] = useState(false);
            const [showEditProfileModal, setShowEditProfileModal] = useState(false);

            // QR Code States
            const [facebookQR, setFacebookQR] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_facebook_qr');
                    return saved ? JSON.parse(saved) : null;
                } catch {
                    return null;
                }
            });
            
            const [mapQR, setMapQR] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_map_qr');
                    return saved ? JSON.parse(saved) : null;
                } catch {
                    return null;
                }
            });
            
            const [wechatQR, setWechatQR] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_wechat_qr');
                    return saved ? JSON.parse(saved) : null;
                } catch {
                    return null;
                }
            });

            // Product modal state
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [productQty, setProductQty] = useState(1);
            const [isProductModalOpen, setIsProductModalOpen] = useState(false);

            // Auth State
            const [currentUser, setCurrentUser] = useState(null);
            const [showAuthModal, setShowAuthModal] = useState(false);
            const [authMode, setAuthMode] = useState('login');
            const [authForm, setAuthForm] = useState({ name: '', phone: '', password: '', road: '', thana: '', city: '', profilePic: null });
            const [showPassword, setShowPassword] = useState(false);
            const [passwordStrength, setPasswordStrength] = useState('');
            const [suggestedPassword, setSuggestedPassword] = useState('');

            const [showAdminLogin, setShowAdminLogin] = useState(false);
            const [adminLoginInput, setAdminLoginInput] = useState('');
            
            const [searchQuery, setSearchQuery] = useState('');
            const [activeCategory, setActiveCategory] = useState('All');

            // Document viewer state
            const [docViewer, setDocViewer] = useState({ open: false, data: null, type: '', name: '' });

            // --- CART & ORDERS STATE ---
            const [cart, setCart] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_cart_v2');
                    return saved ? JSON.parse(saved) : [];
                } catch {
                    return [];
                }
            });
            const [isCartOpen, setIsCartOpen] = useState(false);
            
            const [orders, setOrders] = useState([]);
            const [users, setUsers] = useState([]);
            const [products, setProducts] = useState([]);
            const [loading, setLoading] = useState(true);

            // --- CERTIFICATES STATE ---
            const [tradeLicenseFile, setTradeLicenseFile] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_trade_license');
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        if (parsed && parsed.data) {
                            return parsed;
                        }
                    }
                    return null;
                } catch (e) {
                    console.error('Error loading trade license:', e);
                    return null;
                }
            });
            
            const [binCertificateFile, setBinCertificateFile] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_bin_certificate');
                    return saved ? JSON.parse(saved) : null;
                } catch (e) {
                    console.error('Error loading BIN certificate:', e);
                    return null;
                }
            });

            // --- ORIGIN OPTIONS STATE ---
            const [originOptions, setOriginOptions] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_origin_options');
                    return saved ? JSON.parse(saved) : DEFAULT_ORIGIN_OPTIONS;
                } catch {
                    return DEFAULT_ORIGIN_OPTIONS;
                }
            });

            // --- Mushak-6.3 and BIN Upload State (Admin) ---
            const [showMushak63Modal, setShowMushak63Modal] = useState(false);
            const [currentOrderForMushak63, setCurrentOrderForMushak63] = useState(null);
            const [mushak63File, setMushak63File] = useState(null);
            const [binFile, setBinFile] = useState(null);

            // --- INQUIRY/ORDER FORM STATE ---
            const [isOrderModalOpen, setIsOrderModalOpen] = useState(false);
            const [selectedProductForQuote, setSelectedProductForQuote] = useState(null);
            const [showAddressModal, setShowAddressModal] = useState(false);
            const [selectedOrderForDetails, setSelectedOrderForDetails] = useState(null);
            const [statusMessage, setStatusMessage] = useState('');
            const [showStatusModal, setShowStatusModal] = useState(false);
            const [currentOrderId, setCurrentOrderId] = useState(null);
            const [currentStatus, setCurrentStatus] = useState('');
            const [showConfirmModal, setShowConfirmModal] = useState(false);
            const [quoteToConfirm, setQuoteToConfirm] = useState(null);
            const [showInterestModal, setShowInterestModal] = useState(false);
            const [selectedOrderForInterest, setSelectedOrderForInterest] = useState(null);
            const [showReviewModal, setShowReviewModal] = useState(false);
            const [orderToReview, setOrderToReview] = useState(null);
            const [showDeclineModal, setShowDeclineModal] = useState(false);
            const [declineReason, setDeclineReason] = useState('');
            const [declineOrderId, setDeclineOrderId] = useState(null);
            const [showTrxModal, setShowTrxModal] = useState(false);
            const [currentOrderForTrx, setCurrentOrderForTrx] = useState(null);
            const [trxInput, setTrxInput] = useState('');
            
            // Tracking state
            const [showTrackingModal, setShowTrackingModal] = useState(false);
            const [currentOrderForTracking, setCurrentOrderForTracking] = useState(null);
            const [trackingPlatform, setTrackingPlatform] = useState('');
            const [trackingNumber, setTrackingNumber] = useState('');
            const [trackingMushak63, setTrackingMushak63] = useState(null);
            const [trackingBin, setTrackingBin] = useState(null);
            
            // Document upload state (Customer)
            const [showDocumentModal, setShowDocumentModal] = useState(false);
            const [currentOrderForDocs, setCurrentOrderForDocs] = useState(null);
            const [mushak6_6File, setMushak6_6File] = useState(null);
            const [vdsFile, setVdsFile] = useState(null);
            const [tdsFile, setTdsFile] = useState(null);
            const [customerBinFile, setCustomerBinFile] = useState(null);
            
            const [customerForm, setCustomerForm] = useState({
                name: '', phone: '', road: '', thana: '', city: '', qty: 1, deliveryTime: '',
                origin: '', condition: '', leadTime: '', warranty: '',
                prNumber: '', productSerialNumbers: '', prFile: null, productPictures: []
            });
            const [paymentMethod, setPaymentMethod] = useState('cod');
            const [trxId, setTrxId] = useState('');
            
            // Review state
            const [reviewRating, setReviewRating] = useState(5);
            const [reviewComment, setReviewComment] = useState('');
            
            // Price confirmation for quotes
            const [quoteSubtotal, setQuoteSubtotal] = useState('');
            const [quoteAIT, setQuoteAIT] = useState('');
            const [quoteVAT, setQuoteVAT] = useState('');
            const [quoteGrandTotal, setQuoteGrandTotal] = useState('');
            const [quoteLeadTime, setQuoteLeadTime] = useState('');
            const [quoteWarranty, setQuoteWarranty] = useState('');
            const [quoteOrigin, setQuoteOrigin] = useState('');
            const [originalPrice, setOriginalPrice] = useState('');

            // Mismatch detection for quotes
            const [quoteMismatches, setQuoteMismatches] = useState([]);

            // --- STATE DATA ---
            const [logo, setLogo] = useState(() => localStorage.getItem('sa_logo_v2') || DEFAULT_LOGO);
            const [heroConfig, setHeroConfig] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_hero_config_v2');
                    return saved ? JSON.parse(saved) : DEFAULT_HERO_CONFIG;
                } catch {
                    return DEFAULT_HERO_CONFIG;
                }
            });
            const [brands, setBrands] = useState(() => {
                try {
                    const saved = localStorage.getItem('sa_brands_v2');
                    return saved ? JSON.parse(saved) : INITIAL_BRANDS;
                } catch {
                    return INITIAL_BRANDS;
                }
            });

            // --- QR CODE UPLOAD STATE ---
            const [qrForm, setQrForm] = useState({
                facebook: { type: 'url', url: '', data: null },
                map: { type: 'url', url: '', data: null },
                wechat: { type: 'url', url: '', data: null }
            });

            // --- LOAD DATA FROM SUPABASE ON INITIAL RENDER ---
            useEffect(() => {
                const loadData = async () => {
                    setLoading(true);
                    
                    // Load products
                    const productsData = await loadProductsFromSupabase();
                    if (productsData && productsData.length > 0) {
                        setProducts(productsData);
                    } else {
                        // Fallback to initial products if Supabase has no data
                        setProducts(INITIAL_PRODUCTS);
                        // Optionally save initial products to Supabase
                        for (const product of INITIAL_PRODUCTS) {
                            await saveProductToSupabase(product);
                        }
                    }
                    
                    // Load orders
                    const ordersData = await loadOrdersFromSupabase();
                    if (ordersData) {
                        setOrders(ordersData);
                    }
                    
                    // Load users
                    const usersData = await loadUsersFromSupabase();
                    if (usersData) {
                        setUsers(usersData);
                    }
                    
                    setLoading(false);
                };
                
                loadData();
            }, []);

            // --- HERO SLIDER ---
            const [currentSlide, setCurrentSlide] = useState(0);
            useEffect(() => {
                const activeImages = heroConfig.images.filter(img => img && img.trim() !== "");
                if (activeImages.length <= 1) return;
                const timer = setInterval(() => {
                    setCurrentSlide(prev => (prev + 1) % activeImages.length);
                }, (heroConfig.interval || 5) * 1000);
                return () => clearInterval(timer);
            }, [heroConfig]);

            // --- PERSISTENCE (localStorage fallback) ---
            useEffect(() => localStorage.setItem('sa_logo_v2', logo), [logo]);
            useEffect(() => localStorage.setItem('sa_hero_config_v2', JSON.stringify(heroConfig)), [heroConfig]);
            useEffect(() => localStorage.setItem('sa_brands_v2', JSON.stringify(brands)), [brands]);
            useEffect(() => localStorage.setItem('sa_cart_v2', JSON.stringify(cart)), [cart]);
            useEffect(() => localStorage.setItem('sa_origin_options', JSON.stringify(originOptions)), [originOptions]);
            
            // Persist QR codes
            useEffect(() => {
                if (facebookQR) localStorage.setItem('sa_facebook_qr', JSON.stringify(facebookQR));
                else localStorage.removeItem('sa_facebook_qr');
            }, [facebookQR]);
            
            useEffect(() => {
                if (mapQR) localStorage.setItem('sa_map_qr', JSON.stringify(mapQR));
                else localStorage.removeItem('sa_map_qr');
            }, [mapQR]);
            
            useEffect(() => {
                if (wechatQR) localStorage.setItem('sa_wechat_qr', JSON.stringify(wechatQR));
                else localStorage.removeItem('sa_wechat_qr');
            }, [wechatQR]);
            
            // Persist certificate files
            useEffect(() => {
                try {
                    if (tradeLicenseFile && tradeLicenseFile.data) {
                        localStorage.setItem('sa_trade_license', JSON.stringify(tradeLicenseFile));
                    } else {
                        localStorage.removeItem('sa_trade_license');
                    }
                } catch (e) {
                    console.error('Error saving trade license:', e);
                }
            }, [tradeLicenseFile]);
            
            useEffect(() => {
                try {
                    if (binCertificateFile && binCertificateFile.data) {
                        localStorage.setItem('sa_bin_certificate', JSON.stringify(binCertificateFile));
                    } else {
                        localStorage.removeItem('sa_bin_certificate');
                    }
                } catch (e) {
                    console.error('Error saving BIN certificate:', e);
                }
            }, [binCertificateFile]);

            // --- AUTH LOGIC ---
            const checkPasswordStrength = (password) => {
                if (!password) return '';
                if (password.length < 6) return 'Weak';
                if (password.length < 8) return 'Medium';
                if (/[!@#$%^&*]/.test(password) && /[A-Z]/.test(password) && /[0-9]/.test(password)) return 'Strong';
                return 'Medium';
            };

            const generatePasswordSuggestion = () => {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
                let password = '';
                for (let i = 0; i < 12; i++) {
                    password += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return password;
            };

            useEffect(() => {
                if (authMode === 'register') {
                    setSuggestedPassword(generatePasswordSuggestion());
                }
            }, [authMode]);

            const handleProfilePicUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setAuthForm({...authForm, profilePic: reader.result});
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleAuthSubmit = async (e) => {
                e.preventDefault();
                if (!validatePhoneNumber(authForm.phone)) {
                    alert('Please enter a valid 11-digit phone number starting with 0');
                    return;
                }

                if (authMode === 'register') {
                    // Check if user exists in Supabase
                    const { data: existingUser } = await supabase
                        .from('users')
                        .select('*')
                        .eq('phone', authForm.phone);
                    
                    if (existingUser && existingUser.length > 0) {
                        alert('User already exists with this phone number!');
                        return;
                    }
                    
                    const newUser = { 
                        ...authForm, 
                        id: Date.now().toString(), 
                        createdAt: new Date().toISOString(),
                        address: authForm.road ? {
                            road: authForm.road,
                            thana: authForm.thana || '',
                            city: authForm.city || ''
                        } : null,
                        profilePic: authForm.profilePic || `https://ui-avatars.com/api/?name=${encodeURIComponent(authForm.name)}&background=2196F3&color=fff&size=128`
                    };
                    
                    // Save to Supabase
                    await saveUserToSupabase(newUser);
                    
                    // Update local state
                    setUsers([...users, newUser]);
                    setCurrentUser(newUser);
                    setShowAuthModal(false);
                    setCustomerForm({
                        name: newUser.name,
                        phone: newUser.phone,
                        road: newUser.address?.road || '',
                        thana: newUser.address?.thana || '',
                        city: newUser.address?.city || '',
                        qty: 1,
                        deliveryTime: '',
                        origin: '',
                        condition: '',
                        leadTime: '',
                        warranty: '',
                        prNumber: '',
                        productSerialNumbers: '',
                        prFile: null,
                        productPictures: []
                    });
                    setAuthForm({ name: '', phone: '', password: '', road: '', thana: '', city: '', profilePic: null });
                    alert('Account created successfully!');
                } else {
                    // Login - check Supabase
                    const { data: user } = await supabase
                        .from('users')
                        .select('*')
                        .eq('phone', authForm.phone)
                        .eq('password', authForm.password);
                    
                    if (user && user.length > 0) {
                        setCurrentUser(user[0]);
                        setShowAuthModal(false);
                        setCustomerForm({
                            name: user[0].name,
                            phone: user[0].phone,
                            road: user[0].address?.road || '',
                            thana: user[0].address?.thana || '',
                            city: user[0].address?.city || '',
                            qty: 1,
                            deliveryTime: '',
                            origin: '',
                            condition: '',
                            leadTime: '',
                            warranty: '',
                            prNumber: '',
                            productSerialNumbers: '',
                            prFile: null,
                            productPictures: []
                        });
                        setAuthForm({ name: '', phone: '', password: '', road: '', thana: '', city: '', profilePic: null });
                    } else {
                        alert('Invalid phone number or password');
                    }
                }
            };

            // Edit Profile Function
            const handleEditProfile = async (e) => {
                e.preventDefault();
                if (currentUser) {
                    const updatedUser = {
                        ...currentUser,
                        name: customerForm.name,
                        phone: currentUser.phone,
                        address: {
                            road: customerForm.road,
                            thana: customerForm.thana,
                            city: customerForm.city
                        },
                        profilePic: customerForm.profilePic || currentUser.profilePic
                    };
                    
                    // Update in Supabase
                    await supabase
                        .from('users')
                        .update(updatedUser)
                        .eq('id', currentUser.id);
                    
                    setUsers(users.map(u => u.id === currentUser.id ? updatedUser : u));
                    setCurrentUser(updatedUser);
                    setShowEditProfileModal(false);
                    alert('Profile updated successfully!');
                }
            };

            const handleDeleteProfilePic = () => {
                if (currentUser) {
                    const updatedUser = {
                        ...currentUser,
                        profilePic: `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=2196F3&color=fff&size=128`
                    };
                    setUsers(users.map(u => u.id === currentUser.id ? updatedUser : u));
                    setCurrentUser(updatedUser);
                    setCustomerForm({...customerForm, profilePic: null});
                }
            };

            const logout = useCallback(() => {
                setCurrentUser(null);
                setCustomerForm({ name: '', phone: '', road: '', thana: '', city: '', qty: 1, deliveryTime: '', origin: '', condition: '', leadTime: '', warranty: '', prNumber: '', productSerialNumbers: '', prFile: null, productPictures: [] });
                setShowProfileDropdown(false);
            }, []);

            // --- HELPER FUNCTIONS ---
            const categories = useMemo(() => ['All', ...Array.from(new Set(products.map(p => p.category)))], [products]);
            
            const filteredProducts = useMemo(() => {
                let filtered = products.filter(p => 
                    (p.name.toLowerCase().includes(searchQuery.toLowerCase()) || 
                     p.brand.toLowerCase().includes(searchQuery.toLowerCase()) ||
                     (p.description && p.description.toLowerCase().includes(searchQuery.toLowerCase()))) &&
                    (activeCategory === 'All' || p.category === activeCategory)
                );
                
                if (selectedBrand) {
                    filtered = filtered.filter(p => p.brand === selectedBrand);
                }
                
                return filtered;
            }, [products, searchQuery, activeCategory, selectedBrand]);

            const handleBrandClick = (brandName) => {
                setSelectedBrand(brandName);
                setActiveSection('products');
            };

            const handleAdminLogin = () => {
                if (adminLoginInput === ADMIN_PASSWORD) {
                    setIsAdmin(true);
                    setIsAdminMode(true);
                    setShowAdminLogin(false);
                    setAdminLoginInput('');
                } else {
                    alert('Invalid Credentials');
                }
            };

            // --- PRODUCT MODAL FUNCTIONS ---
            const openProductModal = (product) => {
                setSelectedProduct(product);
                setProductQty(1);
                setIsProductModalOpen(true);
            };

            const closeProductModal = () => {
                setIsProductModalOpen(false);
                setSelectedProduct(null);
                setProductQty(1);
            };

            const addToCartFromModal = () => {
                if (selectedProduct) {
                    setCart(prev => {
                        const existing = prev.find(item => item.id === selectedProduct.id);
                        if (existing) {
                            return prev.map(item => 
                                item.id === selectedProduct.id 
                                    ? { ...item, qty: item.qty + productQty } 
                                    : item
                            );
                        }
                        return [...prev, { ...selectedProduct, qty: productQty }];
                    });
                    
                    closeProductModal();
                    
                    const toast = document.createElement('div');
                    toast.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
                    toast.textContent = `âœ“ ${selectedProduct.name} added to cart`;
                    document.body.appendChild(toast);
                    setTimeout(() => toast.remove(), 3000);
                }
            };

            // --- CART & TOTALS LOGIC ---
            const addToCart = useCallback((product) => {
                openProductModal(product);
            }, []);

            const removeFromCart = useCallback((id) => {
                setCart(prev => prev.filter(item => item.id !== id));
            }, []);

            const updateCartQty = useCallback((id, delta) => {
                setCart(prev => prev.map(item => 
                    item.id === id 
                        ? { ...item, qty: Math.max(1, item.qty + delta) } 
                        : item
                ));
            }, []);

            const cartTotals = useMemo(() => {
                const subtotal = cart.reduce((total, item) => total + (item.price * item.qty), 0);
                if (paymentMethod === 'cod') {
                    return { subtotal, ait: 0, vat: 0, totalWithAit: subtotal, grandTotal: subtotal };
                }
                const ait = subtotal * 0.05;
                const totalWithAit = subtotal + ait;
                const vat = totalWithAit * 0.10;
                const grandTotal = totalWithAit + vat;
                return { subtotal, ait, vat, totalWithAit, grandTotal };
            }, [cart, paymentMethod]);

            // --- ORDER/QUOTE LOGIC ---
            const openQuoteModal = useCallback((product) => {
                if (!currentUser) {
                    alert('Please Log In or Register to request a quote.');
                    setShowAuthModal(true);
                    return;
                }
                setSelectedProductForQuote(product);
                setCustomerForm(prev => ({ 
                    ...prev, 
                    name: currentUser.name,
                    phone: currentUser.phone,
                    road: currentUser.address?.road || '',
                    thana: currentUser.address?.thana || '',
                    city: currentUser.address?.city || '',
                    qty: 1,
                    origin: '',
                    condition: '',
                    leadTime: '',
                    warranty: '',
                    prNumber: '',
                    productSerialNumbers: '',
                    prFile: null,
                    productPictures: []
                }));
                setTrxId('');
                setPaymentMethod('cod');
                setIsOrderModalOpen(true);
                setIsCartOpen(false);
            }, [currentUser]);

            const openCheckout = useCallback(() => {
                if (!currentUser) {
                    alert('Please Log In or Register to checkout.');
                    setShowAuthModal(true);
                    return;
                }
                if (cart.length === 0) {
                    alert('Your cart is empty!');
                    return;
                }
                setSelectedProductForQuote(null);
                setCustomerForm(prev => ({ 
                    ...prev, 
                    name: currentUser.name,
                    phone: currentUser.phone,
                    road: currentUser.address?.road || '',
                    thana: currentUser.address?.thana || '',
                    city: currentUser.address?.city || '',
                    origin: '',
                    condition: '',
                    leadTime: '',
                    warranty: '',
                    prNumber: '',
                    productSerialNumbers: '',
                    prFile: null,
                    productPictures: []
                }));
                setTrxId('');
                setPaymentMethod('cod');
                setIsOrderModalOpen(true);
                setIsCartOpen(false);
            }, [currentUser, cart.length]);

            // Quote extra fields handlers
            const handlePrFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onloadend = () => {
                    setCustomerForm({...customerForm, prFile: { name: file.name, data: reader.result, type: file.type }});
                };
                reader.readAsDataURL(file);
            };

            const handleProductPictureUpload = (e) => {
                const files = Array.from(e.target.files);
                const newPictures = [...customerForm.productPictures];
                
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        newPictures.push({ name: file.name, data: reader.result, type: file.type });
                        setCustomerForm({...customerForm, productPictures: newPictures});
                    };
                    reader.readAsDataURL(file);
                });
            };

            const removeProductPicture = (index) => {
                const newPictures = [...customerForm.productPictures];
                newPictures.splice(index, 1);
                setCustomerForm({...customerForm, productPictures: newPictures});
            };

            // FIXED: submitOrder function with proper error handling
            const submitOrder = async (e) => {
                e.preventDefault();
                
                try {
                    if (!validatePhoneNumber(customerForm.phone)) {
                        alert('Please enter a valid 11-digit phone number starting with 0');
                        return;
                    }

                    if (!selectedProductForQuote && cart.length === 0) {
                        alert('No items in cart');
                        return;
                    }

                    const isSingleQuote = !!selectedProductForQuote;
                    const orderId = 'ORD-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substr(2, 4).toUpperCase();
                    const date = new Date().toLocaleString('en-BD', { timeZone: 'Asia/Dhaka' });
                    
                    const items = isSingleQuote ? [{...selectedProductForQuote, qty: parseInt(customerForm.qty) || 1}] : cart;
                    
                    let totals = null;
                    if (!isSingleQuote) {
                        if (paymentMethod === 'cod') {
                            totals = {
                                subtotal: cartTotals.subtotal,
                                ait: 0,
                                vat: 0,
                                totalWithAit: cartTotals.subtotal,
                                grandTotal: cartTotals.subtotal
                            };
                        } else {
                            totals = cartTotals;
                        }
                    }
                    
                    const newOrder = {
                        id: orderId,
                        date,
                        customerId: currentUser ? currentUser.id : 'guest',
                        customer: { ...customerForm },
                        items: items,
                        type: isSingleQuote ? 'quote' : 'order',
                        status: 'Pending',
                        statusMessage: '',
                        payment: { 
                            method: paymentMethod, 
                            trxId: trxId || null,
                            notifications: PAYMENT_NOTIFICATIONS[paymentMethod] || null,
                            trxApproved: false
                        },
                        totals: totals,
                        leadTime: isSingleQuote ? (customerForm.leadTime || null) : null,
                        warranty: isSingleQuote ? customerForm.warranty : null,
                        customerResponse: null,
                        origin: isSingleQuote ? customerForm.origin : null,
                        condition: isSingleQuote ? customerForm.condition : null,
                        review: null,
                        declineReason: null,
                        quotedPrice: null,
                        originalProductPrice: isSingleQuote ? selectedProductForQuote.price : null,
                        trackingNumber: null,
                        trackingPlatform: null,
                        trackingUrl: null,
                        estimatedDelivery: null,
                        prNumber: isSingleQuote ? customerForm.prNumber : null,
                        productSerialNumbers: isSingleQuote ? customerForm.productSerialNumbers : null,
                        prFile: isSingleQuote ? customerForm.prFile : null,
                        productPictures: isSingleQuote ? customerForm.productPictures : null,
                        documents: {
                            mushak6_3: null,
                            bin_certificate: null,
                            mushak6_6: null,
                            vds: null,
                            tds: null,
                            customer_bin: null
                        }
                    };

                    // Save to Supabase
                    await saveOrderToSupabase(newOrder);
                    
                    setOrders(prevOrders => [newOrder, ...prevOrders]);
                    
                    let message = `*${isSingleQuote ? "ðŸ” QUOTE REQUEST" : "ðŸ›’ NEW ORDER"} - ${orderId}*\n\n`;
                    message += `*ðŸ“‹ Customer Details:*\n`;
                    message += `Name: ${customerForm.name}\n`;
                    message += `Phone: ${formatPhoneNumber(customerForm.phone)}\n`;
                    message += `Address: ${customerForm.road}, ${customerForm.thana}, ${customerForm.city}\n\n`;
                    
                    message += `*ðŸ“¦ Items:*\n`;
                    items.forEach((item, idx) => {
                        message += `${idx+1}. ${item.name}\n`;
                        message += `   Brand: ${item.brand}\n`;
                        if (item.origin) message += `   Origin: ${item.origin}\n`;
                        message += `   Qty: ${item.qty}\n`;
                        if(item.stockStatus === 'in-stock') {
                            message += `   Unit Price: à§³${item.price.toLocaleString()}\n`;
                            message += `   Total: à§³${(item.price * item.qty).toLocaleString()}\n`;
                        }
                        message += `\n`;
                    });

                    message += `*ðŸ’³ Payment Method:* ${paymentMethod.toUpperCase()}\n`;
                    message += `*ðŸ“ Note:* ${PAYMENT_NOTIFICATIONS[paymentMethod]}\n`;
                    message += `*ðŸ“ž WhatsApp:* ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}\n`;

                    if(isSingleQuote) {
                        message += `*ðŸŒ Origin:* ${customerForm.origin || 'Not specified'}\n`;
                        message += `*ðŸ“¦ Condition:* ${customerForm.condition || 'Not specified'}\n`;
                        message += `*â±ï¸ Requested Lead Time:* ${customerForm.leadTime || 'Not specified'}\n`;
                        message += `*ðŸ›¡ï¸ Warranty:* ${customerForm.warranty || 'Not specified'}\n`;
                        message += `*ðŸ“… Required By:* ${customerForm.deliveryTime || 'Not specified'}\n`;
                        if (customerForm.prNumber) message += `*ðŸ“„ PR Number:* ${customerForm.prNumber}\n`;
                        if (customerForm.productSerialNumbers) message += `*ðŸ”¢ Product Serial Numbers:* ${customerForm.productSerialNumbers}\n`;
                        if (customerForm.prFile) message += `*ðŸ“Ž PR File:* Uploaded\n`;
                        if (customerForm.productPictures && customerForm.productPictures.length > 0) {
                            message += `*ðŸ“¸ Product Pictures:* ${customerForm.productPictures.length} uploaded\n`;
                        }
                    }

                    if(!isSingleQuote) {
                        if (paymentMethod === 'cod') {
                            message += `\n*ðŸ’° Net Price:* à§³${cartTotals.subtotal.toLocaleString()}\n`;
                            message += `(No AIT/VAT applicable for Cash on Delivery)\n`;
                        } else {
                            message += `\n*ðŸ’° Payment Breakdown:*\n`;
                            message += `Subtotal: à§³${cartTotals.subtotal.toLocaleString()}\n`;
                            message += `AIT (5%): à§³${cartTotals.ait.toLocaleString()}\n`;
                            message += `Total after AIT: à§³${cartTotals.totalWithAit.toLocaleString()}\n`;
                            message += `VAT (10%): à§³${cartTotals.vat.toLocaleString()}\n`;
                            message += `*GRAND TOTAL: à§³${cartTotals.grandTotal.toLocaleString()}*\n`;
                        }
                    }

                    if (paymentMethod !== 'cod' && trxId) {
                        message += `\n*ðŸ”‘ Transaction ID:* ${trxId}`;
                    }

                    if (customerForm.warranty) {
                        message += `\n\n*ðŸ›¡ï¸ Warranty Terms:*\n`;
                        message += WARRANTY_TERMS[customerForm.warranty];
                    }

                    message += `\n\n*ðŸ’° Refund Policy:*\n`;
                    message += REFUND_POLICY;
                    
                    window.open(getWhatsAppLink(COMPANY_INFO.whatsapp, message), '_blank');
                    
                    setIsOrderModalOpen(false);
                    if (!isSingleQuote) setCart([]);
                    
                    alert(`Thank you! Your ${isSingleQuote ? 'quote request' : 'order'} has been submitted.`);
                } catch (error) {
                    console.error('Order submission error:', error);
                    alert('There was an error submitting your order. Please try again.');
                }
            };

            // --- ADMIN LOGIC ---
            const updateOrderStatus = async (id, newStatus) => {
                const order = orders.find(o => o.id === id);
                
                // For quote type orders, disable status changes until admin sends quote
                if (order.type === 'quote' && order.status === 'Pending' && newStatus !== 'Hold') {
                    alert('Please send a price quote to the customer first before changing status.');
                    return;
                }
                
                // Processing mode: only Approved and Shipped are disabled, Delivered disabled
                if (order.payment?.trxId && !order.payment?.trxApproved) {
                    if (newStatus === 'Approved' || newStatus === 'Shipped' || newStatus === 'Delivered') {
                        alert('Please verify and approve the transaction ID first.');
                        return;
                    }
                }
                
                // When TXN ID is verified, auto approve order
                if (order.payment?.trxApproved && newStatus === 'Processing') {
                    const updates = {
                        status: 'Approved',
                        statusMessage: 'Transaction ID verified. Order approved automatically.'
                    };
                    
                    // Update in Supabase
                    await updateOrderInSupabase(id, updates);
                    
                    setOrders(orders.map(o => o.id === id ? { ...o, ...updates } : o));
                    
                    const message = `*Order Auto-Approved - ${id}*\n\n` +
                        `Dear ${order.customer.name},\n\n` +
                        `Your payment has been verified and your order has been automatically approved.\n` +
                        `Thank you for your business!`;
                    
                    window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
                    return;
                }
                
                // When Approved is active, Shipped becomes available
                if (order.status === 'Approved' && newStatus === 'Shipped') {
                    setCurrentOrderForTracking(order);
                    setShowTrackingModal(true);
                }
                // When Shipped is active, Delivered becomes available
                else if (order.status === 'Shipped' && newStatus === 'Delivered') {
                    const updates = {
                        status: 'Delivered',
                        statusMessage: 'Order has been marked as delivered.'
                    };
                    
                    await updateOrderInSupabase(id, updates);
                    
                    setOrders(orders.map(o => o.id === id ? { ...o, ...updates } : o));
                    
                    const message = `*Order Delivered - ${id}*\n\n` +
                        `Dear ${order.customer.name},\n\n` +
                        `Your order has been marked as delivered.\n` +
                        `Thank you for shopping with us!`;
                    
                    window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
                }
                // NEW: When Delivered is active, Done becomes available
                else if (order.status === 'Delivered' && newStatus === 'Done') {
                    // Mark order as Done/Completed/Closed - remove customer view data but keep documents for admin
                    const updates = {
                        status: 'Done',
                        statusMessage: 'Order completed. Thank you for your business!',
                        hideFromCustomer: true
                    };
                    
                    await updateOrderInSupabase(id, updates);
                    
                    setOrders(orders.map(o => o.id === id ? { ...o, ...updates } : o));
                    
                    const message = `*Order Completed - ${id}*\n\n` +
                        `Dear ${order.customer.name},\n\n` +
                        `Your order has been marked as completed.\n` +
                        `All documents are available in our system for future reference.\n\n` +
                        `Thank you for choosing Shafa Abid Automation!`;
                    
                    window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
                }
                else if (newStatus === 'Hold' || newStatus === 'Cancelled') {
                    setCurrentOrderId(id);
                    setCurrentStatus(newStatus);
                    setShowStatusModal(true);
                } else {
                    const updates = { status: newStatus, statusMessage: '' };
                    await updateOrderInSupabase(id, updates);
                    setOrders(orders.map(o => o.id === id ? { ...o, ...updates } : o));
                }
            };

            const handleStatusUpdate = async () => {
                if (currentOrderId && statusMessage) {
                    const order = orders.find(o => o.id === currentOrderId);
                    
                    const updates = {
                        status: currentStatus,
                        statusMessage: statusMessage
                    };
                    
                    await updateOrderInSupabase(currentOrderId, updates);
                    
                    setOrders(orders.map(o => o.id === currentOrderId ? { ...o, ...updates } : o));
                    
                    const message = `*Order Status Update - ${currentOrderId}*\n\n` +
                        `Dear ${order.customer.name},\n\n` +
                        `Your order has been marked as *${currentStatus}*.\n` +
                        `Reason: ${statusMessage}\n\n` +
                        `For any questions, WhatsApp us at ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                    
                    window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
                    
                    setShowStatusModal(false);
                    setStatusMessage('');
                    setCurrentOrderId(null);
                    setCurrentStatus('');
                }
            };

            const handleTrackingSubmit = async () => {
                if (currentOrderForTracking && trackingPlatform && trackingNumber) {
                    const platform = COURIER_PLATFORMS.find(p => p.id === trackingPlatform);
                    const trackingUrl = platform ? platform.url + trackingNumber : '#';
                    
                    const updates = {
                        status: 'Shipped',
                        trackingNumber: trackingNumber,
                        trackingPlatform: trackingPlatform,
                        trackingUrl: trackingUrl,
                        estimatedDelivery: new Date(Date.now() + 7*24*60*60*1000).toLocaleDateString()
                    };
                    
                    // Add documents if uploaded
                    if (trackingMushak63) {
                        updates.documents = {
                            ...currentOrderForTracking.documents,
                            mushak6_3: trackingMushak63
                        };
                    }
                    if (trackingBin) {
                        updates.documents = {
                            ...(updates.documents || currentOrderForTracking.documents || {}),
                            bin_certificate: trackingBin
                        };
                    }
                    
                    await updateOrderInSupabase(currentOrderForTracking.id, updates);
                    
                    setOrders(orders.map(o => o.id === currentOrderForTracking.id ? {
                        ...o,
                        ...updates
                    } : o));
                    
                    let docMessage = '';
                    if (trackingMushak63 || trackingBin) {
                        const docs = [];
                        if (trackingMushak63) docs.push('Mushak-6.3');
                        if (trackingBin) docs.push('BIN Certificate');
                        docMessage = `\n\nDocuments uploaded: ${docs.join(', ')}`;
                    }
                    
                    const message = `*Order Shipped - ${currentOrderForTracking.id}*\n\n` +
                        `Dear ${currentOrderForTracking.customer.name},\n\n` +
                        `Your order has been shipped via ${platform?.name}!\n` +
                        `Tracking Number: ${trackingNumber}\n` +
                        `Track your order at: ${trackingUrl}\n` +
                        `Estimated Delivery: ${new Date(Date.now() + 7*24*60*60*1000).toLocaleDateString()}${docMessage}\n\n` +
                        `For any questions, WhatsApp us at ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                    
                    window.open(getWhatsAppLink(currentOrderForTracking.customer.phone, message), '_blank');
                    
                    setShowTrackingModal(false);
                    setTrackingPlatform('');
                    setTrackingNumber('');
                    setTrackingMushak63(null);
                    setTrackingBin(null);
                    setCurrentOrderForTracking(null);
                }
            };

            // Handle processing order with transaction ID
            const handleProcessingOrder = (order) => {
                setCurrentOrderForTrx(order);
                setShowTrxModal(true);
            };

            const submitTransactionId = async () => {
                if (currentOrderForTrx && trxInput) {
                    const updates = {
                        status: 'Processing',
                        payment: {
                            ...currentOrderForTrx.payment,
                            trxId: trxInput,
                            trxApproved: false
                        },
                        statusMessage: `Transaction ID submitted: ${trxInput}. Awaiting admin approval.`
                    };
                    
                    await updateOrderInSupabase(currentOrderForTrx.id, updates);
                    
                    setOrders(orders.map(o => o.id === currentOrderForTrx.id ? {
                        ...o,
                        ...updates
                    } : o));
                    
                    const message = `*Transaction ID Submitted - ${currentOrderForTrx.id}*\n\n` +
                        `Customer: ${currentOrderForTrx.customer.name}\n` +
                        `Phone: ${currentOrderForTrx.customer.phone}\n` +
                        `Transaction ID: ${trxInput}\n\n` +
                        `Please verify and approve the order.\n\n` +
                        `WhatsApp: ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                    
                    window.open(getWhatsAppLink(COMPANY_INFO.whatsapp, message), '_blank');
                    
                    setShowTrxModal(false);
                    setTrxInput('');
                    setCurrentOrderForTrx(null);
                    
                    alert('Transaction ID submitted successfully! Admin will verify and update your order status.');
                }
            };

            // Admin approve transaction
            const approveTransaction = async (orderId) => {
                const updates = {
                    payment: {
                        ...orders.find(o => o.id === orderId).payment,
                        trxApproved: true
                    },
                    status: 'Approved',
                    statusMessage: 'Transaction ID verified and approved. Order approved automatically.'
                };
                
                await updateOrderInSupabase(orderId, updates);
                
                setOrders(orders.map(o => o.id === orderId ? { ...o, ...updates } : o));
                
                const order = orders.find(o => o.id === orderId);
                const message = `*Transaction Approved - ${orderId}*\n\n` +
                    `Dear ${order.customer.name},\n\n` +
                    `Your payment has been verified and your order has been automatically approved.\n` +
                    `Thank you for your business!`;
                
                window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
            };

            // FIXED: Handle file upload with proper error handling and data storage
            const handleFileUpload = (e, type, callback) => {
                const file = e.target.files[0];
                if (!file) return;
                
                if (file.size > 5 * 1024 * 1024) {
                    alert('File size must be less than 5MB');
                    return;
                }
                
                const validTypes = ['image/jpeg', 'image/png', 'application/pdf'];
                if (!validTypes.includes(file.type)) {
                    alert('Please upload only PDF, JPEG, or PNG files');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (event) => {
                    const fileData = {
                        name: file.name,
                        size: (file.size / 1024).toFixed(2) + ' KB',
                        type: file.type,
                        data: event.target.result,
                        uploaded: true,
                        timestamp: new Date().toISOString()
                    };
                    
                    if (type === 'mushak6_3') {
                        setMushak63File(fileData);
                    } else if (type === 'bin') {
                        setBinFile(fileData);
                    } else if (type === 'tracking_mushak63') {
                        setTrackingMushak63(fileData);
                    } else if (type === 'tracking_bin') {
                        setTrackingBin(fileData);
                    } else if (type === 'mushak6_6') {
                        setMushak6_6File(fileData);
                    } else if (type === 'vds') {
                        setVdsFile(fileData);
                    } else if (type === 'tds') {
                        setTdsFile(fileData);
                    } else if (type === 'customer_bin') {
                        setCustomerBinFile(fileData);
                    } else if (type === 'trade') {
                        setTradeLicenseFile(fileData);
                        alert('Trade License uploaded successfully!');
                    } else if (type === 'bin_certificate') {
                        setBinCertificateFile(fileData);
                        alert('BIN Certificate uploaded successfully!');
                    } else if (type === 'facebook_qr') {
                        setFacebookQR(fileData);
                        alert('Facebook QR Code uploaded successfully!');
                    } else if (type === 'map_qr') {
                        setMapQR(fileData);
                        alert('Map QR Code uploaded successfully!');
                    } else if (type === 'wechat_qr') {
                        setWechatQR(fileData);
                        alert('WeChat QR Code uploaded successfully!');
                    }
                    
                    if (callback) callback(fileData);
                };
                reader.onerror = () => {
                    alert('Error reading file. Please try again.');
                };
                reader.readAsDataURL(file);
            };

            const deleteCertificate = (type) => {
                if (type === 'trade') {
                    if (confirm('Are you sure you want to delete the Trade License?')) {
                        setTradeLicenseFile(null);
                        localStorage.removeItem('sa_trade_license');
                    }
                } else if (type === 'bin') {
                    if (confirm('Are you sure you want to delete the BIN Certificate?')) {
                        setBinCertificateFile(null);
                        localStorage.removeItem('sa_bin_certificate');
                    }
                } else if (type === 'facebook_qr') {
                    if (confirm('Are you sure you want to delete the Facebook QR Code?')) {
                        setFacebookQR(null);
                        localStorage.removeItem('sa_facebook_qr');
                    }
                } else if (type === 'map_qr') {
                    if (confirm('Are you sure you want to delete the Map QR Code?')) {
                        setMapQR(null);
                        localStorage.removeItem('sa_map_qr');
                    }
                } else if (type === 'wechat_qr') {
                    if (confirm('Are you sure you want to delete the WeChat QR Code?')) {
                        setWechatQR(null);
                        localStorage.removeItem('sa_wechat_qr');
                    }
                }
            };

            // FIXED: submitMushak63 with proper state update to prevent white screen
            const submitMushak63 = async () => {
                if (currentOrderForMushak63 && (mushak63File || binFile)) {
                    // Create a copy of the order to update
                    const orderIndex = orders.findIndex(o => o.id === currentOrderForMushak63.id);
                    if (orderIndex === -1) return;

                    const updatedOrders = [...orders];
                    const orderToUpdate = { ...updatedOrders[orderIndex] };
                    
                    // Update documents
                    orderToUpdate.documents = {
                        ...orderToUpdate.documents,
                        ...(mushak63File && { mushak6_3: mushak63File }),
                        ...(binFile && { bin_certificate: binFile })
                    };
                    
                    orderToUpdate.statusMessage = `${mushak63File ? 'Mushak-6.3' : ''}${mushak63File && binFile ? ' and ' : ''}${binFile ? 'BIN Certificate' : ''} uploaded by admin.`;
                    
                    // Update in Supabase
                    await updateOrderInSupabase(currentOrderForMushak63.id, {
                        documents: orderToUpdate.documents,
                        statusMessage: orderToUpdate.statusMessage
                    });
                    
                    updatedOrders[orderIndex] = orderToUpdate;
                    setOrders(updatedOrders);
                    
                    const order = orders.find(o => o.id === currentOrderForMushak63.id);
                    const uploadedDocs = [];
                    if (mushak63File) uploadedDocs.push('Mushak-6.3');
                    if (binFile) uploadedDocs.push('BIN Certificate');
                    
                    const message = `*Documents Uploaded - ${currentOrderForMushak63.id}*\n\n` +
                        `Dear ${order.customer.name},\n\n` +
                        `${uploadedDocs.join(' and ')} ${uploadedDocs.length > 1 ? 'have' : 'has'} been uploaded for your order. Please check your order details.\n\n` +
                        `For any questions, WhatsApp us at ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                    
                    window.open(getWhatsAppLink(order.customer.phone, message), '_blank');
                    
                    setShowMushak63Modal(false);
                    setMushak63File(null);
                    setBinFile(null);
                    setCurrentOrderForMushak63(null);
                    
                    alert('Documents uploaded successfully!');
                }
            };

            // FIXED: submitDocuments with proper state update and customer BIN file
            const submitDocuments = async () => {
                if (currentOrderForDocs) {
                    try {
                        const orderIndex = orders.findIndex(o => o.id === currentOrderForDocs.id);
                        if (orderIndex === -1) return;

                        const updatedOrders = [...orders];
                        const orderToUpdate = { ...updatedOrders[orderIndex] };
                        
                        const docReferences = {
                            mushak6_6: mushak6_6File ? { ...mushak6_6File } : null,
                            vds: vdsFile ? { ...vdsFile } : null,
                            tds: tdsFile ? { ...tdsFile } : null,
                            customer_bin: customerBinFile ? { ...customerBinFile } : null
                        };
                        
                        orderToUpdate.documents = {
                            ...orderToUpdate.documents,
                            ...docReferences
                        };
                        orderToUpdate.statusMessage = 'Documents submitted successfully.';
                        
                        // Update in Supabase
                        await updateOrderInSupabase(currentOrderForDocs.id, {
                            documents: orderToUpdate.documents,
                            statusMessage: orderToUpdate.statusMessage
                        });
                        
                        updatedOrders[orderIndex] = orderToUpdate;
                        setOrders(updatedOrders);
                        
                        setMushak6_6File(null);
                        setVdsFile(null);
                        setTdsFile(null);
                        setCustomerBinFile(null);
                        setCurrentOrderForDocs(null);
                        setShowDocumentModal(false);
                        
                        alert('Documents submitted successfully!');
                        
                        const message = `*Documents Submitted - ${currentOrderForDocs.id}*\n\n` +
                            `Customer: ${currentOrderForDocs.customer.name}\n` +
                            `Documents: ${mushak6_6File ? 'Mushak-6.6 âœ“ ' : ''}${vdsFile ? 'VDS âœ“ ' : ''}${tdsFile ? 'TDS âœ“ ' : ''}${customerBinFile ? 'BIN (Customer) âœ“ ' : ''}\n\n` +
                            `Please verify the documents in the admin panel.`;
                        
                        window.open(getWhatsAppLink(COMPANY_INFO.whatsapp, message), '_blank');
                        
                    } catch (error) {
                        console.error('Document submission error:', error);
                        alert('There was an error submitting documents. Please try again.');
                    }
                }
            };

            const handlePriceChange = (price) => {
                setQuoteSubtotal(price);
                if (price) {
                    const subtotal = parseFloat(price) || 0;
                    const ait = subtotal * 0.05;
                    const totalWithAit = subtotal + ait;
                    const vat = totalWithAit * 0.10;
                    const grandTotal = totalWithAit + vat;
                    
                    setQuoteAIT(ait.toFixed(2));
                    setQuoteVAT(vat.toFixed(2));
                    setQuoteGrandTotal(grandTotal.toFixed(2));
                } else {
                    setQuoteAIT('');
                    setQuoteVAT('');
                    setQuoteGrandTotal('');
                }
            };

            // NEW: Function to detect mismatches between customer request and admin quote
            const detectQuoteMismatches = (customerOrder, adminQuote) => {
                const mismatches = [];
                
                if (customerOrder.origin && adminQuote.quoteOrigin && customerOrder.origin !== adminQuote.quoteOrigin) {
                    mismatches.push({
                        field: 'Origin',
                        requested: customerOrder.origin,
                        offered: adminQuote.quoteOrigin
                    });
                }
                
                if (customerOrder.leadTime && adminQuote.leadTime && customerOrder.leadTime !== adminQuote.leadTime) {
                    mismatches.push({
                        field: 'Lead Time',
                        requested: customerOrder.leadTime,
                        offered: adminQuote.leadTime
                    });
                }
                
                if (customerOrder.warranty && adminQuote.warranty && customerOrder.warranty !== adminQuote.warranty) {
                    mismatches.push({
                        field: 'Warranty',
                        requested: customerOrder.warranty,
                        offered: adminQuote.warranty
                    });
                }
                
                return mismatches;
            };

            const handleCustomerResponse = (response) => {
                if (selectedOrderForInterest) {
                    // Detect mismatches before processing response
                    const mismatches = detectQuoteMismatches(selectedOrderForInterest, {
                        quoteOrigin: quoteOrigin,
                        leadTime: quoteLeadTime,
                        warranty: quoteWarranty
                    });
                    
                    if (response === 'YES') {
                        // Show warning if there are mismatches
                        if (mismatches.length > 0) {
                            const mismatchMessage = mismatches.map(m => 
                                `â€¢ ${m.field}: Requested "${m.requested}" â†’ Offered "${m.offered}"`
                            ).join('\n');
                            
                            if (!confirm(`âš ï¸ IMPORTANT NOTICE âš ï¸\n\nThe following specifications have been changed by admin:\n\n${mismatchMessage}\n\nDo you still want to accept this quote?`)) {
                                return;
                            }
                        }
                        
                        const filteredOrders = orders.filter(o => o.id !== selectedOrderForInterest.id);
                        
                        const newOrder = {
                            ...selectedOrderForInterest,
                            id: 'ORD-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substr(2, 4).toUpperCase(),
                            type: 'order',
                            status: 'Pending',
                            statusMessage: 'Customer accepted the quote. Admin will send price quote shortly.',
                            quotedPrice: parseFloat(quoteGrandTotal) || 0,
                            payment: { 
                                method: 'N/A',
                                notifications: 'Please wait for admin to send price quote.'
                            },
                            warranty: quoteWarranty,
                            originalQuoteId: selectedOrderForInterest.id,
                            customerResponse: 'YES',
                            items: selectedOrderForInterest.items.map(item => ({
                                ...item,
                                price: null
                            })),
                            // Store mismatch information
                            quoteMismatches: mismatches.length > 0 ? mismatches : null
                        };
                        
                        // Save to Supabase
                        saveOrderToSupabase(newOrder);
                        
                        setOrders([newOrder, ...filteredOrders]);
                        
                        let mismatchMessage = '';
                        if (mismatches.length > 0) {
                            mismatchMessage = '\n\nâš ï¸ SPECIFICATION CHANGES:\n' + 
                                mismatches.map(m => `â€¢ ${m.field}: ${m.requested} â†’ ${m.offered}`).join('\n');
                        }
                        
                        const message = `*Quote Accepted - ${newOrder.id}*\n\n` +
                            `Dear ${selectedOrderForInterest.customer.name},\n\n` +
                            `Thank you for accepting the quote. Your quote has been converted to an order.\n` +
                            `Order ID: ${newOrder.id}\n` +
                            `Quoted Amount: à§³${(parseFloat(quoteGrandTotal) || 0).toLocaleString()}\n` +
                            `Warranty: ${quoteWarranty}${mismatchMessage}\n\n` +
                            `Please wait for admin to send the final price quote.\n\n` +
                            `For assistance, WhatsApp us at ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                        
                        window.open(getWhatsAppLink(selectedOrderForInterest.customer.phone, message), '_blank');
                        
                        setShowInterestModal(false);
                        setSelectedOrderForInterest(null);
                        setQuoteSubtotal('');
                        setQuoteAIT('');
                        setQuoteVAT('');
                        setQuoteGrandTotal('');
                        setQuoteLeadTime('');
                        setQuoteWarranty('');
                        setQuoteOrigin('');
                        setOriginalPrice('');
                        setQuoteMismatches([]);
                    } else {
                        setDeclineOrderId(selectedOrderForInterest.id);
                        setShowDeclineModal(true);
                        setShowInterestModal(false);
                    }
                }
            };

            const handleDeclineSubmit = async () => {
                if (declineOrderId && declineReason) {
                    const updates = {
                        status: 'Cancelled',
                        statusMessage: `Customer declined: ${declineReason}`,
                        customerResponse: 'NO',
                        declineReason: declineReason
                    };
                    
                    await updateOrderInSupabase(declineOrderId, updates);
                    
                    setOrders(orders.map(o => o.id === declineOrderId ? { ...o, ...updates } : o));
                    
                    const order = orders.find(o => o.id === declineOrderId);
                    const message = `*Quote Declined - ${declineOrderId}*\n\n` +
                        `Customer: ${order.customer.name}\n` +
                        `Phone: ${order.customer.phone}\n\n` +
                        `Reason: ${declineReason}\n\n` +
                        `WhatsApp: ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                    
                    window.open(getWhatsAppLink(COMPANY_INFO.whatsapp, message), '_blank');
                    
                    setShowDeclineModal(false);
                    setDeclineReason('');
                    setDeclineOrderId(null);
                    setSelectedOrderForInterest(null);
                }
            };

            const confirmQuote = (quote) => {
                setQuoteToConfirm(quote);
                const originalTotal = quote.items.reduce((sum, item) => sum + (item.price * item.qty), 0);
                setOriginalPrice(originalTotal.toFixed(2));
                setQuoteSubtotal('');
                setQuoteAIT('');
                setQuoteVAT('');
                setQuoteGrandTotal('');
                setQuoteLeadTime('');
                setQuoteWarranty('');
                setQuoteOrigin(quote.origin || ''); // Pre-fill with customer's requested origin
                setShowConfirmModal(true);
            };

            const submitConfirmedQuote = async () => {
                if (!quoteSubtotal || !quoteLeadTime || !quoteWarranty) {
                    alert('Please enter price, lead time and warranty');
                    return;
                }

                const subtotal = parseFloat(quoteSubtotal);
                const ait = parseFloat(quoteAIT);
                const vat = parseFloat(quoteVAT);
                const grandTotal = parseFloat(quoteGrandTotal);

                const updates = {
                    status: 'Hold',
                    statusMessage: `Quoted Price: à§³${grandTotal.toLocaleString()}, Lead Time: ${quoteLeadTime}, Warranty: ${quoteWarranty}${quoteOrigin ? `, Origin: ${quoteOrigin}` : ''}`,
                    quoteDetails: {
                        subtotal: subtotal,
                        ait: ait,
                        vat: vat,
                        price: grandTotal,
                        leadTime: quoteLeadTime,
                        warranty: quoteWarranty,
                        origin: quoteOrigin,
                        originalPrice: originalPrice
                    }
                };
                
                await updateOrderInSupabase(quoteToConfirm.id, updates);
                
                setOrders(orders.map(o => o.id === quoteToConfirm.id ? { ...o, ...updates } : o));
                
                // Detect mismatches for notification
                const mismatches = detectQuoteMismatches(quoteToConfirm, {
                    quoteOrigin: quoteOrigin,
                    leadTime: quoteLeadTime,
                    warranty: quoteWarranty
                });
                
                let mismatchWarning = '';
                if (mismatches.length > 0) {
                    mismatchWarning = '\n\nâš ï¸ *IMPORTANT: Specification Changes* âš ï¸\n' + 
                        mismatches.map(m => `â€¢ ${m.field}: Requested "${m.requested}" â†’ Offered "${m.offered}"`).join('\n') +
                        '\n\nPlease review these changes carefully.';
                }
                
                const message = `*Quote Update - ${quoteToConfirm.id}*\n\n` +
                    `Dear ${quoteToConfirm.customer.name},\n\n` +
                    `We have reviewed your quote request.\n\n` +
                    `*Price Details:*\n` +
                    `Subtotal: à§³${subtotal.toLocaleString()}\n` +
                    `AIT (5%): à§³${ait.toLocaleString()}\n` +
                    `VAT (10%): à§³${vat.toLocaleString()}\n` +
                    `*Quoted Total: à§³${grandTotal.toLocaleString()}*\n` +
                    `*Lead Time: ${quoteLeadTime}*\n` +
                    `*Warranty: ${quoteWarranty}*\n` +
                    (quoteOrigin ? `*Origin: ${quoteOrigin}*\n` : '') +
                    mismatchWarning + '\n\n' +
                    `*Warranty Terms:*\n${WARRANTY_TERMS[quoteWarranty]}\n\n` +
                    `Are you interested in proceeding with this quote?\n` +
                    `Please check your order history to respond.\n\n` +
                    `For any questions, WhatsApp us at ${formatWhatsAppNumber(COMPANY_INFO.whatsapp)}`;
                
                window.open(getWhatsAppLink(quoteToConfirm.customer.phone, message), '_blank');
                
                setShowConfirmModal(false);
                setQuoteSubtotal('');
                setQuoteAIT('');
                setQuoteVAT('');
                setQuoteGrandTotal('');
                setQuoteLeadTime('');
                setQuoteWarranty('');
                setQuoteOrigin('');
                setOriginalPrice('');
                setQuoteToConfirm(null);
                setQuoteMismatches([]);
                
                alert('Quote details sent to customer successfully!');
            };

            const submitReview = async () => {
                if (orderToReview) {
                    const updates = {
                        review: {
                            rating: reviewRating,
                            comment: reviewComment,
                            date: new Date().toLocaleString()
                        }
                    };
                    
                    await updateOrderInSupabase(orderToReview.id, updates);
                    
                    setOrders(orders.map(o => o.id === orderToReview.id ? { ...o, ...updates } : o));
                    
                    setShowReviewModal(false);
                    setReviewRating(5);
                    setReviewComment('');
                    setOrderToReview(null);
                    
                    alert('Thank you for your review!');
                }
            };

            const deleteOrder = async (id) => {
                if (window.confirm('Are you sure you want to delete this order?')) {
                    // Delete from Supabase
                    await supabase
                        .from('orders')
                        .delete()
                        .eq('order_id', id);
                    
                    setOrders(orders.filter(o => o.id !== id));
                }
            };

            // FIXED: Document viewer function with print support
            const openDocumentViewer = (doc, showPrint = true) => {
                if (doc && doc.data) {
                    setDocViewer({
                        open: true,
                        data: doc.data,
                        type: doc.type || 'application/octet-stream',
                        name: doc.name || 'Document',
                        showPrint: showPrint
                    });
                } else if (doc && typeof doc === 'string') {
                    setDocViewer({
                        open: true,
                        data: doc,
                        type: 'image/jpeg',
                        name: 'Document',
                        showPrint: showPrint
                    });
                } else {
                    alert('Document data not available');
                }
            };

            const closeDocumentViewer = () => {
                setDocViewer({ open: false, data: null, type: '', name: '', showPrint: false });
            };

            const printDocument = () => {
                const printWindow = window.open('', '_blank');
                
                if (docViewer.type?.startsWith('image/')) {
                    printWindow.document.write(`
                        <html>
                            <head>
                                <title>Print ${docViewer.name}</title>
                                <style>
                                    body { margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
                                    img { max-width: 100%; max-height: 100vh; object-fit: contain; }
                                </style>
                            </head>
                            <body>
                                <img src="${docViewer.data}" onload="window.print();window.close()" />
                            </body>
                        </html>
                    `);
                } else {
                    printWindow.document.write(`
                        <html>
                            <head>
                                <title>Print ${docViewer.name}</title>
                                <style>
                                    body { padding: 20px; font-family: Arial, sans-serif; text-align: center; }
                                    .btn { 
                                        display: inline-block; 
                                        background: #4CAF50; 
                                        color: white; 
                                        padding: 10px 20px; 
                                        text-decoration: none; 
                                        border-radius: 5px;
                                        margin-top: 20px;
                                    }
                                </style>
                            </head>
                            <body>
                                <h2>Print this file from your PDF viewer</h2>
                                <p>Please download the file and open in Adobe Reader or similar software.</p>
                                <a href="${docViewer.data}" download="${docViewer.name}" class="btn">
                                    Download ${docViewer.name}
                                </a>
                            </body>
                        </html>
                    `);
                }
                printWindow.document.close();
            };

            // WeChat QR state
            const [showWeChatQR, setShowWeChatQR] = useState(false);
            const mapRef = useRef(null);
            const mapInstanceRef = useRef(null);

            // Map initialization - LIVE MAP VIEW
            useEffect(() => {
                if (activeSection === 'contact' && !mapInstanceRef.current && window.L) {
                    setTimeout(() => {
                        if (mapRef.current) {
                            mapInstanceRef.current = L.map(mapRef.current).setView(
                                [COMPANY_INFO.coordinates.lat, COMPANY_INFO.coordinates.lng], 
                                15
                            );
                            
                            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                attribution: 'Â© OpenStreetMap contributors'
                            }).addTo(mapInstanceRef.current);
                            
                            L.marker([COMPANY_INFO.coordinates.lat, COMPANY_INFO.coordinates.lng])
                                .addTo(mapInstanceRef.current)
                                .bindPopup(COMPANY_INFO.address)
                                .openPopup();
                        }
                    }, 500);
                }
                
                return () => {
                    if (mapInstanceRef.current) {
                        mapInstanceRef.current.remove();
                        mapInstanceRef.current = null;
                    }
                };
            }, [activeSection]);

            // --- ORIGIN OPTIONS MANAGEMENT ---
            const [newOrigin, setNewOrigin] = useState('');

            const addOrigin = () => {
                if (newOrigin && !originOptions.includes(newOrigin)) {
                    setOriginOptions([...originOptions, newOrigin]);
                    setNewOrigin('');
                }
            };

            const removeOrigin = (origin) => {
                setOriginOptions(originOptions.filter(o => o !== origin));
            };

            // --- PRODUCT/BRAND MANAGEMENT FORMS ---
            const [productForm, setProductForm] = useState({ 
                name: '', brand: '', category: '', origin: '',
                imageType: 'url', imageUrl: '', imageData: null,
                datasheetType: 'url', datasheetUrl: '', datasheetData: null,
                stockStatus: 'in-stock', price: 0, description: '', leadTime: '' 
            });
            
            const [brandForm, setBrandForm] = useState({ 
                name: '', type: 'url', url: '', data: null 
            });
            
            const [editingBrandId, setEditingBrandId] = useState(null);
            
            const [logoForm, setLogoForm] = useState({ 
                type: 'url', url: logo, data: null 
            });
            
            const [heroForm, setHeroForm] = useState(heroConfig);
            const [editingId, setEditingId] = useState(null);

            const handleFile = (file, callback) => { 
                if (!file) return; 
                const reader = new FileReader(); 
                reader.onloadend = () => callback(reader.result); 
                reader.readAsDataURL(file); 
            };

            const resetProductForm = () => { 
                setProductForm({ 
                    name: '', brand: '', category: '', origin: '',
                    imageType: 'url', imageUrl: '', imageData: null,
                    datasheetType: 'url', datasheetUrl: '', datasheetData: null,
                    stockStatus: 'in-stock', price: 0, description: '', leadTime: '' 
                }); 
                setEditingId(null); 
            };

            const initEditProduct = (p) => { 
                setEditingId(p.id); 
                setProductForm({ 
                    name: p.name, 
                    brand: p.brand, 
                    category: p.category,
                    origin: p.origin || '',
                    imageType: 'url', 
                    imageUrl: p.image, 
                    imageData: null,
                    datasheetType: 'url',
                    datasheetUrl: p.datasheet || '',
                    datasheetData: null,
                    stockStatus: p.stockStatus || 'in-stock', 
                    price: p.price || 0,
                    description: p.description || '',
                    leadTime: p.leadTime || ''
                }); 
                setAdminView('edit'); 
            };

            const saveProduct = async (e) => { 
                e.preventDefault(); 
                const img = productForm.imageType === 'url' ? productForm.imageUrl : productForm.imageData; 
                const finalImg = img || (editingId ? products.find(p => p.id === editingId).image : null); 
                
                const datasheet = productForm.datasheetType === 'url' ? productForm.datasheetUrl : productForm.datasheetData;
                
                if (!productForm.name || !finalImg) {
                    alert('Product name and image are required.');
                    return;
                }

                if (productForm.stockStatus === 'in-stock' && (!productForm.price || productForm.price <= 0)) {
                    alert('Please enter a valid price for in-stock items');
                    return;
                }

                if (editingId) { 
                    // Update existing product
                    await supabase
                        .from('products')
                        .update({ 
                            ...productForm, 
                            image: finalImg,
                            datasheet: datasheet,
                            price: parseFloat(productForm.price) || 0
                        })
                        .eq('id', editingId);
                    
                    setProducts(products.map(p => p.id === editingId ? { 
                        ...p, 
                        ...productForm, 
                        image: finalImg,
                        datasheet: datasheet,
                        price: parseFloat(productForm.price) || 0
                    } : p)); 
                    alert('Product updated successfully'); 
                } else { 
                    const newProduct = { 
                        id: Date.now().toString(), 
                        ...productForm, 
                        image: finalImg,
                        datasheet: datasheet,
                        price: parseFloat(productForm.price) || 0
                    };
                    
                    // Save to Supabase
                    await saveProductToSupabase(newProduct);
                    
                    setProducts([newProduct, ...products]); 
                    alert('Product added successfully'); 
                } 
                resetProductForm(); 
                setAdminView('list'); 
            };

            const deleteProduct = async (id) => { 
                if(confirm('Are you sure you want to delete this product?')) {
                    // Delete from Supabase
                    await supabase
                        .from('products')
                        .delete()
                        .eq('id', id);
                    
                    setProducts(products.filter(p => p.id !== id));
                }
            };

            const initEditBrand = (brand) => {
                setEditingBrandId(brand.id);
                setBrandForm({
                    name: brand.name,
                    type: 'url',
                    url: brand.logo,
                    data: null
                });
                setAdminView('editBrand');
            };

            const saveBrand = (e) => {
                e.preventDefault();
                const logo = brandForm.type === 'url' ? brandForm.url : brandForm.data;
                if (!brandForm.name || !logo) {
                    alert('Brand name and logo are required');
                    return;
                }
                
                if (editingBrandId) {
                    setBrands(brands.map(b => b.id === editingBrandId ? { ...b, name: brandForm.name, logo } : b));
                    alert('Brand updated successfully');
                } else {
                    setBrands([...brands, { id: Date.now().toString(), name: brandForm.name, logo }]);
                    alert('Brand added successfully');
                }
                
                setBrandForm({ name: '', type: 'url', url: '', data: null });
                setEditingBrandId(null);
                setAdminView('list');
            };

            const deleteBrand = (id) => {
                if (confirm('Are you sure you want to delete this brand?')) {
                    setBrands(brands.filter(b => b.id !== id));
                }
            };

            const saveLogo = (e) => {
                e.preventDefault();
                const newLogo = logoForm.type === 'url' ? logoForm.url : logoForm.data;
                if (newLogo) {
                    setLogo(newLogo);
                    alert('Logo updated successfully');
                }
            };

            const saveHeroConfig = (e) => {
                e.preventDefault();
                setHeroConfig(heroForm);
                alert('Hero configuration saved');
            };

            // Save QR Codes
            const saveQRCode = (type) => {
                const qrData = qrForm[type];
                const newQR = qrData.type === 'url' 
                    ? { name: `${type} QR Code`, data: generateQRCodeData(type, qrData.url), type: 'image/png', size: 'Auto' }
                    : qrData.data;
                
                if (type === 'facebook') setFacebookQR(newQR);
                else if (type === 'map') setMapQR(newQR);
                else if (type === 'wechat') setWechatQR(newQR);
                
                alert(`${type.charAt(0).toUpperCase() + type.slice(1)} QR Code saved successfully!`);
            };

            // Order Bank Data
            const orderBankData = useMemo(() => {
                return orders.map(order => ({
                    ...order,
                    displayStatus: order.status,
                    displayDate: new Date(order.date).toLocaleDateString('en-BD'),
                    totalAmount: order.totals?.grandTotal || order.quotedPrice || 0
                }));
            }, [orders]);

            // Social media click handlers
            const handleSocialClick = (type, url) => {
                if (type === 'wechat') {
                    if (wechatQR) {
                        openDocumentViewer(wechatQR);
                    } else {
                        setShowWeChatQR(true);
                    }
                } else {
                    window.open(url, '_blank');
                }
            };

            // FIXED: Checkout button handler
            const handleCheckoutClick = () => {
                if (!currentUser) {
                    alert('Please Log In or Register to checkout.');
                    setShowAuthModal(true);
                    return;
                }
                if (cart.length === 0) {
                    alert('Your cart is empty!');
                    return;
                }
                setSelectedProductForQuote(null);
                setCustomerForm({
                    ...customerForm,
                    name: currentUser.name,
                    phone: currentUser.phone,
                    road: currentUser.address?.road || '',
                    thana: currentUser.address?.thana || '',
                    city: currentUser.address?.city || '',
                    origin: '',
                    condition: '',
                    leadTime: '',
                    warranty: '',
                    prNumber: '',
                    productSerialNumbers: '',
                    prFile: null,
                    productPictures: []
                });
                setTrxId('');
                setPaymentMethod('cod');
                setIsOrderModalOpen(true);
                setIsCartOpen(false);
            };

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-16 w-16 border-t-4 border-brandBlue border-solid mx-auto mb-4"></div>
                            <p className="text-brandDark font-bold">Loading your data...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex flex-col font-sans text-brandDark bg-slate-50">
                    
                    {/* WeChat QR Modal */}
                    {showWeChatQR && (
                        <div className="wechat-qr-modal" onClick={() => setShowWeChatQR(false)}>
                            <div className="wechat-qr-content" onClick={e => e.stopPropagation()}>
                                <button 
                                    onClick={() => setShowWeChatQR(false)}
                                    className="absolute top-4 right-4 w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-red-50 hover:text-red-500"
                                >
                                    <i className="fas fa-times"></i>
                                </button>
                                <i className="fab fa-weixin text-6xl text-wechat mb-4"></i>
                                <h3 className="text-xl font-black text-brandDark mb-2">Scan WeChat QR Code</h3>
                                <p className="text-sm text-slate-400 mb-6">Add us on WeChat for direct support</p>
                                <div className="bg-slate-100 p-4 rounded-xl mb-4">
                                    {wechatQR ? (
                                        <img 
                                            src={wechatQR.data || wechatQR} 
                                            alt="WeChat QR" 
                                            className="w-48 h-48 mx-auto object-contain cursor-pointer"
                                            onClick={() => openDocumentViewer(wechatQR)}
                                        />
                                    ) : (
                                        <div className="w-48 h-48 mx-auto bg-gradient-to-br from-wechat to-green-400 rounded-lg flex items-center justify-center">
                                            <i className="fab fa-weixin text-8xl text-white opacity-50"></i>
                                        </div>
                                    )}
                                </div>
                                <p className="text-xs text-slate-500">WeChat ID: {COMPANY_INFO.wechat}</p>
                                <button
                                    onClick={() => {
                                        navigator.clipboard.writeText(COMPANY_INFO.wechat);
                                        alert('WeChat ID copied to clipboard!');
                                    }}
                                    className="mt-4 text-wechat text-xs font-bold hover:underline"
                                >
                                    Copy WeChat ID
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Document Viewer Modal */}
                    {docViewer.open && (
                        <div className="doc-viewer-modal" onClick={closeDocumentViewer}>
                            <div className="doc-viewer-content" onClick={e => e.stopPropagation()}>
                                <div className="doc-viewer-close" onClick={closeDocumentViewer}>
                                    <i className="fas fa-times"></i>
                                </div>
                                <h3 className="text-lg font-bold mb-4">{docViewer.name}</h3>
                                {docViewer.type?.startsWith('image/') ? (
                                    <img 
                                        src={docViewer.data} 
                                        alt={docViewer.name}
                                        className="max-w-full max-h-[70vh] object-contain"
                                    />
                                ) : (
                                    <iframe
                                        src={docViewer.data}
                                        title={docViewer.name}
                                        className="w-full h-[70vh]"
                                    />
                                )}
                                <div className="mt-4 flex justify-end gap-2">
                                    {docViewer.showPrint && (
                                        <button
                                            onClick={printDocument}
                                            className="bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-indigo-600 flex items-center gap-2"
                                        >
                                            <i className="fas fa-print"></i>
                                            Print
                                        </button>
                                    )}
                                    <a 
                                        href={docViewer.data} 
                                        download={docViewer.name}
                                        className="bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-green-600 flex items-center gap-2"
                                    >
                                        <i className="fas fa-download"></i>
                                        Download
                                    </a>
                                    <button
                                        onClick={closeDocumentViewer}
                                        className="bg-slate-100 text-slate-600 px-4 py-2 rounded-lg text-sm font-bold hover:bg-slate-200"
                                    >
                                        Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* ADMIN BAR */}
                    {isAdmin && (
                        <div className="bg-brandDark text-white px-4 py-2 flex justify-between items-center text-[10px] font-black uppercase tracking-widest z-[60]">
                            <div className="flex items-center gap-4">
                                <span className="text-brandOrange animate-pulse">âš¡ ADMIN ACCESS</span>
                                <button 
                                    onClick={() => { 
                                        setIsAdminMode(!isAdminMode); 
                                        setAdminView('list'); 
                                    }} 
                                    className="bg-brandBlue px-4 py-2 rounded-lg hover:bg-blue-600 transition-all text-xs font-bold"
                                >
                                    {isAdminMode ? 'ðŸ‘ï¸ View Store' : 'âš™ï¸ Management Portal'}
                                </button>
                            </div>
                            <button 
                                onClick={() => setIsAdmin(false)} 
                                className="text-slate-400 hover:text-white transition-colors"
                            >
                                <i className="fas fa-sign-out-alt mr-2"></i>Sign Out
                            </button>
                        </div>
                    )}

                    {/* PUBLIC HEADER */}
                    {!isAdminMode && (
                        <header className="sticky top-0 z-50 glass">
                            <div className="max-w-7xl mx-auto px-4 h-24 flex items-center justify-between gap-4 md:gap-8 relative">
                                <div className="flex items-center gap-4 cursor-pointer group" onClick={() => {
                                    setActiveSection('home');
                                    setSelectedBrand(null);
                                }}>
                                    <div className="p-1 rounded-lg">
                                        <img 
                                            src={logo} 
                                            alt="Shafa Abid Logo" 
                                            className="h-10 md:h-12 w-auto object-contain transition-all group-hover:scale-105" 
                                            onError={(e) => {
                                                e.target.onerror = null;
                                                e.target.src = DEFAULT_LOGO;
                                            }}
                                        />
                                    </div>
                                    <div className="hidden sm:block border-l-2 pl-4 border-gray-200">
                                        <h1 className="text-lg md:text-xl font-black text-brandDark leading-none tracking-tight">SHAFA ABID</h1>
                                        <p className="text-[9px] font-bold text-brandOrange uppercase tracking-[0.3em] mt-1">AUTOMATION BD</p>
                                    </div>
                                </div>
                                
                                <nav className="hidden lg:flex gap-8 text-sm font-black uppercase tracking-widest text-slate-500">
                                    {['home', 'products', 'services', 'contact'].map(item => (
                                        <button 
                                            key={item} 
                                            onClick={() => {
                                                setActiveSection(item);
                                                if (item !== 'products') setSelectedBrand(null);
                                            }} 
                                            className={`hover:text-brandBlue transition-all relative ${
                                                activeSection === item ? 'text-brandBlue after:absolute after:bottom-[-24px] after:left-0 after:right-0 after:h-0.5 after:bg-brandBlue' : ''
                                            }`}
                                        >
                                            {item}
                                        </button>
                                    ))}
                                </nav>
                                
                                <div className="flex items-center gap-4 md:gap-6">
                                    {currentUser ? (
                                        <div className="relative">
                                            <div 
                                                className="flex items-center gap-3 bg-slate-100 px-4 py-2 rounded-full cursor-pointer hover:bg-slate-200 transition-colors"
                                                onClick={() => setShowProfileDropdown(!showProfileDropdown)}
                                            >
                                                <img 
                                                    src={currentUser.profilePic || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=2196F3&color=fff&size=40`} 
                                                    alt={currentUser.name}
                                                    className="profile-pic"
                                                />
                                                <span className="text-xs font-bold text-brandDark hidden md:block">{currentUser.name}</span>
                                                <i className="fas fa-chevron-down text-xs text-slate-400"></i>
                                            </div>
                                            
                                            {showProfileDropdown && (
                                                <div className="absolute right-0 mt-2 w-72 bg-white rounded-2xl shadow-xl border border-slate-100 z-50 overflow-hidden">
                                                    <div className="profile-header">
                                                        <div className="flex items-center gap-4">
                                                            <img 
                                                                src={currentUser.profilePic || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=2196F3&color=fff&size=100`} 
                                                                alt={currentUser.name}
                                                                className="profile-pic-large"
                                                            />
                                                            <div>
                                                                <p className="font-black text-xl">{currentUser.name}</p>
                                                                <p className="text-sm opacity-90">{formatPhoneNumber(currentUser.phone)}</p>
                                                                <p className="text-xs opacity-75 mt-1">Member since {currentUser.createdAt ? new Date(currentUser.createdAt).toLocaleDateString() : 'N/A'}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div className="p-4">
                                                        <button
                                                            onClick={() => {
                                                                setCustomerForm({
                                                                    name: currentUser.name,
                                                                    phone: currentUser.phone,
                                                                    road: currentUser.address?.road || '',
                                                                    thana: currentUser.address?.thana || '',
                                                                    city: currentUser.address?.city || '',
                                                                    qty: 1,
                                                                    deliveryTime: '',
                                                                    origin: '',
                                                                    condition: '',
                                                                    leadTime: '',
                                                                    warranty: '',
                                                                    profilePic: currentUser.profilePic,
                                                                    prNumber: '',
                                                                    productSerialNumbers: '',
                                                                    prFile: null,
                                                                    productPictures: []
                                                                });
                                                                setShowEditProfileModal(true);
                                                                setShowProfileDropdown(false);
                                                            }}
                                                            className="w-full text-left px-4 py-3 rounded-xl hover:bg-slate-50 transition-colors flex items-center gap-3"
                                                        >
                                                            <i className="fas fa-user-edit text-brandBlue w-5"></i>
                                                            <span className="text-sm font-bold">Edit Profile</span>
                                                        </button>
                                                        <button
                                                            onClick={() => {
                                                                setActiveSection('dashboard');
                                                                setShowProfileDropdown(false);
                                                            }}
                                                            className="w-full text-left px-4 py-3 rounded-xl hover:bg-slate-50 transition-colors flex items-center gap-3"
                                                        >
                                                            <i className="fas fa-shopping-bag text-brandOrange w-5"></i>
                                                            <span className="text-sm font-bold">My Orders</span>
                                                        </button>
                                                        <button
                                                            onClick={logout}
                                                            className="w-full text-left px-4 py-3 rounded-xl hover:bg-red-50 transition-colors flex items-center gap-3 text-red-500"
                                                        >
                                                            <i className="fas fa-sign-out-alt w-5"></i>
                                                            <span className="text-sm font-bold">Logout</span>
                                                        </button>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <div className="flex items-center gap-3">
                                            <button 
                                                onClick={() => { 
                                                    setAuthMode('login'); 
                                                    setShowAuthModal(true); 
                                                }} 
                                                className="text-xs font-bold text-brandDark hover:text-brandBlue transition-colors"
                                            >
                                                Sign In
                                            </button>
                                            <span className="text-slate-300">|</span>
                                            <button 
                                                onClick={() => { 
                                                    setAuthMode('register'); 
                                                    setShowAuthModal(true); 
                                                }} 
                                                className="text-xs font-bold text-brandOrange hover:text-orange-600 transition-colors"
                                            >
                                                Join
                                            </button>
                                        </div>
                                    )}

                                    <button 
                                        onClick={() => setShowAdminLogin(true)} 
                                        className="text-slate-400 hover:text-brandBlue transition-colors" 
                                        title="Admin Login"
                                    >
                                        <i className="fas fa-user-shield text-lg"></i>
                                    </button>
                                    
                                    <button 
                                        onClick={() => setIsCartOpen(true)} 
                                        className="relative text-slate-700 hover:text-brandBlue transition-colors"
                                    >
                                        <i className="fas fa-shopping-cart text-xl"></i>
                                        {cart.length > 0 && (
                                            <span className="absolute -top-2 -right-2 bg-brandOrange text-white text-[9px] font-black w-5 h-5 rounded-full flex items-center justify-center animate-pulse-slow">
                                                {cart.reduce((sum, item) => sum + item.qty, 0)}
                                            </span>
                                        )}
                                    </button>
                                    
                                    <button 
                                        className="lg:hidden text-brandDark text-2xl p-2 hover:text-brandBlue transition-colors" 
                                        onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
                                    >
                                        <i className={`fas ${isMobileMenuOpen ? 'fa-times' : 'fa-bars'}`}></i>
                                    </button>
                                </div>
                            </div>

                            {/* Mobile Menu */}
                            {isMobileMenuOpen && (
                                <div className="lg:hidden absolute top-24 left-0 right-0 bg-white border-t border-slate-100 shadow-xl animate-fade-in">
                                    <nav className="flex flex-col p-6 space-y-4">
                                        {['home', 'products', 'services', 'contact'].map(item => (
                                            <button 
                                                key={item} 
                                                onClick={() => {
                                                    setActiveSection(item);
                                                    setIsMobileMenuOpen(false);
                                                    if (item !== 'products') setSelectedBrand(null);
                                                }} 
                                                className={`text-left py-3 text-sm font-black uppercase tracking-widest ${
                                                    activeSection === item ? 'text-brandBlue' : 'text-slate-500'
                                                }`}
                                            >
                                                {item}
                                            </button>
                                        ))}
                                    </nav>
                                </div>
                            )}
                        </header>
                    )}

                    {/* EDIT PROFILE MODAL */}
                    {showEditProfileModal && currentUser && (
                        <div className="fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8 max-h-[90vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-xl font-black text-brandDark uppercase">Edit Profile</h3>
                                    <button 
                                        onClick={() => setShowEditProfileModal(false)} 
                                        className="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-red-50 hover:text-red-500"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <form onSubmit={handleEditProfile} className="space-y-6">
                                    <div className="text-center">
                                        <div className="relative inline-block">
                                            <img 
                                                src={customerForm.profilePic || currentUser.profilePic || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=2196F3&color=fff&size=128`} 
                                                alt="Profile"
                                                className="w-24 h-24 rounded-full object-cover border-4 border-brandBlue mx-auto"
                                            />
                                            <div className="mt-4 flex gap-2 justify-center">
                                                <label className="cursor-pointer bg-brandBlue text-white px-3 py-1 rounded-lg text-xs font-bold hover:bg-blue-600">
                                                    <i className="fas fa-upload mr-1"></i>Upload
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        className="hidden"
                                                        onChange={(e) => {
                                                            const file = e.target.files[0];
                                                            if (file) {
                                                                const reader = new FileReader();
                                                                reader.onloadend = () => {
                                                                    setCustomerForm({...customerForm, profilePic: reader.result});
                                                                };
                                                                reader.readAsDataURL(file);
                                                            }
                                                        }}
                                                    />
                                                </label>
                                                <button
                                                    type="button"
                                                    onClick={handleDeleteProfilePic}
                                                    className="bg-red-500 text-white px-3 py-1 rounded-lg text-xs font-bold hover:bg-red-600"
                                                >
                                                    <i className="fas fa-trash mr-1"></i>Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Full Name</label>
                                        <input
                                            type="text"
                                            required
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={customerForm.name}
                                            onChange={e => setCustomerForm({...customerForm, name: e.target.value})}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Phone Number (Cannot Edit)</label>
                                        <input
                                            type="tel"
                                            readOnly
                                            className="w-full bg-slate-100 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none cursor-not-allowed text-slate-500"
                                            value={customerForm.phone}
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Road / Village</label>
                                        <input
                                            type="text"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={customerForm.road}
                                            onChange={e => setCustomerForm({...customerForm, road: e.target.value})}
                                        />
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Thana</label>
                                            <input
                                                type="text"
                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                value={customerForm.thana}
                                                onChange={e => setCustomerForm({...customerForm, thana: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">City</label>
                                            <input
                                                type="text"
                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                value={customerForm.city}
                                                onChange={e => setCustomerForm({...customerForm, city: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    
                                    <div className="flex gap-4 pt-4">
                                        <button
                                            type="submit"
                                            className="flex-1 bg-brandBlue text-white py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                        >
                                            Save Changes
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setShowEditProfileModal(false)}
                                            className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* PRODUCT DETAILS MODAL - Professional Layout */}
                    {isProductModalOpen && selectedProduct && (
                        <div className="product-modal-overlay" onClick={closeProductModal}>
                            <div className="product-modal" onClick={e => e.stopPropagation()}>
                                <div className="close-modal" onClick={closeProductModal}>
                                    <i className="fas fa-times"></i>
                                </div>
                                
                                <div className="grid md:grid-cols-2 gap-6 p-6">
                                    {/* Left Side - Product Image */}
                                    <div className="bg-slate-50 rounded-2xl p-8 flex items-center justify-center">
                                        <img 
                                            src={selectedProduct.image} 
                                            alt={selectedProduct.name}
                                            className="max-h-80 max-w-full object-contain"
                                            onError={(e) => {
                                                e.target.onerror = null;
                                                e.target.src = 'https://via.placeholder.com/400?text=Product';
                                            }}
                                        />
                                    </div>
                                    
                                    {/* Right Side - Product Details */}
                                    <div className="space-y-4">
                                        <div>
                                            <div className="flex items-center gap-2 text-xs font-bold text-brandBlue mb-2">
                                                <span>{selectedProduct.brand}</span>
                                                {selectedProduct.origin && (
                                                    <>
                                                        <span className="w-1 h-1 bg-slate-300 rounded-full"></span>
                                                        <span>{selectedProduct.origin}</span>
                                                    </>
                                                )}
                                            </div>
                                            <h3 className="text-2xl font-black text-brandDark mb-2">{selectedProduct.name}</h3>
                                            <span className="inline-block px-3 py-1 bg-slate-100 text-slate-500 rounded-full text-xs font-bold">
                                                {selectedProduct.category}
                                            </span>
                                        </div>
                                        
                                        {selectedProduct.description && (
                                            <div className="bg-slate-50 p-4 rounded-xl">
                                                <p className="text-sm text-slate-600">{selectedProduct.description}</p>
                                            </div>
                                        )}
                                        
                                        <div className="flex items-center gap-4">
                                            {STOCK_STATUS_OPTIONS.map(option => {
                                                if (option.value === selectedProduct.stockStatus) {
                                                    return (
                                                        <span key={option.value} className={`stock-badge ${option.color} text-white`}>
                                                            {option.label}
                                                        </span>
                                                    );
                                                }
                                                return null;
                                            })}
                                        </div>
                                        
                                        {/* Price Section */}
                                        {selectedProduct.stockStatus === 'in-stock' ? (
                                            <div className="bg-blue-50 p-4 rounded-xl">
                                                <p className="text-sm text-slate-500 mb-1">Price</p>
                                                <p className="text-3xl font-black text-brandBlue">à§³{selectedProduct.price.toLocaleString()}</p>
                                                <p className="text-xs text-slate-400 mt-1">+ 5% AIT applicable</p>
                                            </div>
                                        ) : (
                                            <div className="bg-orange-50 p-4 rounded-xl">
                                                <p className="text-sm text-slate-500 mb-1">Price</p>
                                                <p className="text-lg font-bold text-orange-500">Price on Request</p>
                                            </div>
                                        )}
                                        
                                        {/* Datasheet Link */}
                                        {selectedProduct.datasheet && (
                                            <div>
                                                <a 
                                                    href={selectedProduct.datasheet} 
                                                    target="_blank" 
                                                    rel="noopener noreferrer"
                                                    className="inline-flex items-center gap-2 bg-slate-100 text-brandBlue px-4 py-2 rounded-lg text-xs font-bold hover:bg-slate-200 transition-colors"
                                                >
                                                    <i className="fas fa-file-pdf"></i>
                                                    Download Technical Datasheet
                                                </a>
                                            </div>
                                        )}
                                        
                                        {/* Quantity and Add to Cart */}
                                        <div className="space-y-4 pt-4 border-t">
                                            <div className="flex items-center gap-4">
                                                <span className="text-sm font-bold">Quantity:</span>
                                                <div className="flex items-center gap-2 bg-slate-100 rounded-lg p-1">
                                                    <button 
                                                        onClick={() => setProductQty(prev => Math.max(1, prev - 1))}
                                                        className="w-8 h-8 flex items-center justify-center text-slate-500 hover:bg-white rounded-lg transition-colors"
                                                    >
                                                        <i className="fas fa-minus text-xs"></i>
                                                    </button>
                                                    <span className="text-sm font-bold w-8 text-center">{productQty}</span>
                                                    <button 
                                                        onClick={() => setProductQty(prev => prev + 1)}
                                                        className="w-8 h-8 flex items-center justify-center text-slate-500 hover:bg-white rounded-lg transition-colors"
                                                    >
                                                        <i className="fas fa-plus text-xs"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div className="flex gap-3">
                                                {selectedProduct.stockStatus === 'in-stock' ? (
                                                    <button 
                                                        onClick={addToCartFromModal}
                                                        className="flex-1 bg-brandDark text-white py-3 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-brandBlue transition-all shadow-lg"
                                                    >
                                                        <i className="fas fa-shopping-cart mr-2"></i>
                                                        Add to Cart
                                                    </button>
                                                ) : (
                                                    <button 
                                                        onClick={() => {
                                                            closeProductModal();
                                                            openQuoteModal(selectedProduct);
                                                        }}
                                                        className="flex-1 bg-brandOrange text-white py-3 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-orange-600 transition-all shadow-lg"
                                                    >
                                                        <i className="fas fa-file-invoice mr-2"></i>
                                                        Request Quote
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* CART DRAWER */}
                    {isCartOpen && (
                        <div className="fixed inset-0 z-[80] bg-black/50 backdrop-blur-sm flex justify-end">
                            <div className="bg-white w-full max-w-md h-full shadow-2xl animate-slide-in flex flex-col">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                    <div>
                                        <h3 className="text-xl font-black uppercase text-brandDark">Your Cart</h3>
                                        <p className="text-xs text-slate-400 mt-1">{cart.length} items</p>
                                    </div>
                                    <button 
                                        onClick={() => setIsCartOpen(false)} 
                                        className="w-10 h-10 rounded-full bg-white flex items-center justify-center text-slate-400 hover:text-red-500 hover:bg-red-50 transition-colors"
                                    >
                                        <i className="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                                
                                <div className="flex-grow overflow-y-auto p-6 space-y-4">
                                    {cart.length === 0 ? (
                                        <div className="text-center py-20">
                                            <i className="fas fa-shopping-cart text-6xl text-slate-200 mb-4"></i>
                                            <p className="text-slate-400 font-bold uppercase tracking-widest">Cart is Empty</p>
                                            <button 
                                                onClick={() => {
                                                    setIsCartOpen(false);
                                                    setActiveSection('products');
                                                }}
                                                className="mt-4 text-brandBlue text-sm font-bold hover:underline"
                                            >
                                                Browse Products â†’
                                            </button>
                                        </div>
                                    ) : (
                                        cart.map(item => (
                                            <div key={item.id} className="flex gap-4 items-center bg-white border border-slate-100 p-4 rounded-xl hover:shadow-md transition-shadow">
                                                <img 
                                                    src={item.image} 
                                                    className="w-16 h-16 object-contain mix-blend-multiply" 
                                                    alt={item.name}
                                                    onError={(e) => {
                                                        e.target.onerror = null;
                                                        e.target.src = 'https://via.placeholder.com/64?text=Product';
                                                    }}
                                                />
                                                <div className="flex-grow">
                                                    <h4 className="font-bold text-sm text-brandDark line-clamp-2">{item.name}</h4>
                                                    <p className="text-xs text-brandBlue font-bold mt-1">à§³{item.price.toLocaleString()}</p>
                                                    {item.origin && (
                                                        <p className="text-[8px] text-slate-400">Origin: {item.origin}</p>
                                                    )}
                                                </div>
                                                <div className="flex flex-col items-center gap-2">
                                                    <div className="flex items-center gap-2 bg-slate-100 rounded-lg p-1">
                                                        <button 
                                                            onClick={() => updateCartQty(item.id, -1)} 
                                                            className="w-7 h-7 flex items-center justify-center text-slate-500 hover:bg-white rounded-lg transition-colors"
                                                            disabled={item.qty <= 1}
                                                        >
                                                            <i className="fas fa-minus text-xs"></i>
                                                        </button>
                                                        <span className="text-xs font-bold w-6 text-center">{item.qty}</span>
                                                        <button 
                                                            onClick={() => updateCartQty(item.id, 1)} 
                                                            className="w-7 h-7 flex items-center justify-center text-slate-500 hover:bg-white rounded-lg transition-colors"
                                                        >
                                                            <i className="fas fa-plus text-xs"></i>
                                                        </button>
                                                    </div>
                                                    <button 
                                                        onClick={() => removeFromCart(item.id)} 
                                                        className="text-[10px] text-red-400 hover:text-red-600 hover:underline transition-colors"
                                                    >
                                                        Remove
                                                    </button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                                
                                {cart.length > 0 && (
                                    <div className="p-6 border-t border-slate-100 bg-slate-50">
                                        <div className="space-y-2 mb-4">
                                            <div className="flex justify-between text-sm">
                                                <span className="text-slate-500">Subtotal:</span>
                                                <span className="font-bold">à§³{cartTotals.subtotal.toLocaleString()}</span>
                                            </div>
                                            {paymentMethod !== 'cod' && (
                                                <>
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-slate-500">AIT (5%):</span>
                                                        <span className="font-bold">+ à§³{cartTotals.ait.toLocaleString()}</span>
                                                    </div>
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-slate-500">VAT (10%):</span>
                                                        <span className="font-bold">+ à§³{cartTotals.vat.toLocaleString()}</span>
                                                    </div>
                                                </>
                                            )}
                                            <div className="flex justify-between text-lg font-black text-brandDark pt-2 border-t border-slate-200 mt-2">
                                                <span>{paymentMethod === 'cod' ? 'Net Price' : 'Grand Total'}:</span>
                                                <span className="text-brandOrange">à§³{paymentMethod === 'cod' ? cartTotals.subtotal.toLocaleString() : cartTotals.grandTotal.toLocaleString()}</span>
                                            </div>
                                        </div>
                                        <button 
                                            onClick={handleCheckoutClick} 
                                            className="w-full bg-brandDark text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-brandBlue transition-all shadow-lg hover:-translate-y-0.5"
                                        >
                                            Proceed to Checkout
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* CUSTOMER DASHBOARD - Only show orders that are not hidden from customer */}
                    {currentUser && activeSection === 'dashboard' && (
                        <div className="fixed inset-0 z-[70] bg-black/50 backdrop-blur-sm flex justify-end">
                            <div className="bg-white w-full max-w-2xl h-full shadow-2xl animate-slide-in flex flex-col overflow-y-auto">
                                <div className="sticky top-0 bg-white p-6 border-b border-slate-100 flex justify-between items-center z-10">
                                    <div className="flex items-center gap-4">
                                        <img 
                                            src={currentUser.profilePic || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=2196F3&color=fff&size=100`} 
                                            alt={currentUser.name}
                                            className="profile-pic-large"
                                        />
                                        <div>
                                            <h3 className="text-2xl font-black uppercase text-brandDark">{currentUser.name}</h3>
                                            <p className="text-sm text-slate-400">{formatPhoneNumber(currentUser.phone)}</p>
                                            <p className="text-xs text-slate-400 mt-1">Member since {currentUser.createdAt ? new Date(currentUser.createdAt).toLocaleDateString() : 'N/A'}</p>
                                        </div>
                                    </div>
                                    <button 
                                        onClick={() => setActiveSection('home')} 
                                        className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-red-50 hover:text-red-500 transition-colors"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>

                                <div className="p-6 space-y-8">
                                    {/* Profile Section */}
                                    <div className="bg-slate-50 rounded-2xl p-6">
                                        <h4 className="font-black text-sm uppercase text-brandDark mb-4 flex items-center gap-2">
                                            <i className="fas fa-user-circle text-brandBlue"></i> Profile Information
                                        </h4>
                                        <div className="space-y-4">
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-1">Name</label>
                                                    <p className="font-bold text-brandDark">{currentUser.name}</p>
                                                </div>
                                                <div>
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-1">Phone</label>
                                                    <p className="font-bold text-brandDark">{formatPhoneNumber(currentUser.phone)}</p>
                                                </div>
                                            </div>
                                            <div>
                                                <label className="block text-[10px] font-black uppercase text-slate-400 mb-1">Address</label>
                                                <p className="text-sm text-brandDark">
                                                    {currentUser.address ? `${currentUser.address.road}, ${currentUser.address.thana}, ${currentUser.address.city}` : 'Not provided'}
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Order History - Filter out hidden orders */}
                                    <div className="bg-slate-50 rounded-2xl p-6">
                                        <h4 className="font-black text-sm uppercase text-brandDark mb-4 flex items-center gap-2">
                                            <i className="fas fa-history text-brandBlue"></i> Order History
                                        </h4>
                                        
                                        {orders.filter(o => o.customerId === currentUser.id && !o.hideFromCustomer).length === 0 ? (
                                            <div className="text-center py-8">
                                                <i className="fas fa-box-open text-4xl text-slate-300 mb-2"></i>
                                                <p className="text-sm text-slate-400">No orders yet</p>
                                                <button
                                                    onClick={() => {
                                                        setActiveSection('products');
                                                    }}
                                                    className="mt-4 text-brandBlue text-xs font-bold hover:underline"
                                                >
                                                    Start Shopping â†’
                                                </button>
                                            </div>
                                        ) : (
                                            <div className="space-y-4">
                                                {orders
                                                    .filter(o => o.customerId === currentUser.id && !o.hideFromCustomer)
                                                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                                                    .map(order => {
                                                        // Show documents for all statuses
                                                        const showDocuments = order.documents && 
                                                                            (order.documents.mushak6_3 || order.documents.bin_certificate || order.documents.mushak6_6 || order.documents.vds || order.documents.tds || order.documents.customer_bin || order.prFile || (order.productPictures && order.productPictures.length > 0));
                                                        
                                                        // Check if there are mismatches to display
                                                        const hasMismatches = order.quoteMismatches && order.quoteMismatches.length > 0;
                                                        
                                                        return (
                                                            <div key={order.id} className="bg-white rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                                                <div className="flex justify-between items-start mb-3">
                                                                    <div>
                                                                        <span className="font-bold text-sm text-brandBlue">{order.id}</span>
                                                                        <p className="text-[10px] text-slate-400">{order.date}</p>
                                                                        {(order.status === 'Approved' || order.status === 'Shipped') && order.estimatedDelivery && (
                                                                            <p className="text-[9px] text-green-600 mt-1">
                                                                                <i className="fas fa-truck mr-1"></i>
                                                                                Est. Delivery: {order.estimatedDelivery}
                                                                            </p>
                                                                        )}
                                                                    </div>
                                                                    <div className="flex items-center gap-2">
                                                                        {order.statusMessage && (
                                                                            <div className="relative group">
                                                                                <i className="fas fa-info-circle text-slate-400 hover:text-brandBlue cursor-help"></i>
                                                                                <div className="absolute right-0 top-6 hidden group-hover:block bg-brandDark text-white text-[10px] p-2 rounded-lg whitespace-normal max-w-xs z-10">
                                                                                    {order.statusMessage}
                                                                                </div>
                                                                            </div>
                                                                        )}
                                                                        <span className={`px-2 py-1 rounded text-[9px] font-black uppercase ${
                                                                            order.status === 'Approved' ? 'bg-green-100 text-green-600' :
                                                                            order.status === 'Processing' ? 'bg-blue-100 text-blue-600' :
                                                                            order.status === 'Pending' ? 'bg-yellow-100 text-yellow-600' :
                                                                            order.status === 'Hold' ? 'bg-orange-100 text-orange-600' :
                                                                            order.status === 'Shipped' ? 'bg-indigo-100 text-indigo-600' :
                                                                            order.status === 'Delivered' ? 'bg-purple-100 text-purple-600' :
                                                                            order.status === 'Done' ? 'bg-gray-100 text-gray-600' :
                                                                            order.status === 'Cancelled' ? 'bg-red-100 text-red-600' :
                                                                            'bg-orange-100 text-orange-600'
                                                                        }`}>
                                                                            {order.status}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                
                                                                {/* Mismatch Warning Display */}
                                                                {hasMismatches && (
                                                                    <div className="mismatch-warning mb-3">
                                                                        <div className="flex items-center gap-2 mb-2">
                                                                            <i className="fas fa-exclamation-triangle text-orange-600"></i>
                                                                            <span className="font-black text-orange-800 text-xs">SPECIFICATION CHANGES</span>
                                                                        </div>
                                                                        {order.quoteMismatches.map((mismatch, idx) => (
                                                                            <div key={idx} className="mismatch-item">
                                                                                <i className="fas fa-arrow-right mismatch-icon"></i>
                                                                                <span className="text-xs">
                                                                                    <span className="font-bold">{mismatch.field}:</span> Requested "{mismatch.requested}" â†’ Offered "{mismatch.offered}"
                                                                                </span>
                                                                            </div>
                                                                        ))}
                                                                    </div>
                                                                )}
                                                                
                                                                <div className="space-y-2 mb-3">
                                                                    {order.items.map((item, idx) => (
                                                                        <div key={idx} className="flex justify-between text-xs">
                                                                            <div>
                                                                                <span className="text-slate-600">{item.name}</span>
                                                                                {item.origin && (
                                                                                    <span className="text-[8px] text-slate-400 ml-1">({item.origin})</span>
                                                                                )}
                                                                                <span className="text-slate-600 ml-1">x{item.qty}</span>
                                                                            </div>
                                                                            {order.type === 'order' && order.quotedPrice && (
                                                                                <span className="font-bold">Quoted: à§³{order.quotedPrice.toLocaleString()}</span>
                                                                            )}
                                                                            {order.type === 'order' && !order.quotedPrice && item.price && (
                                                                                <span className="font-bold">à§³{(item.price * item.qty).toLocaleString()}</span>
                                                                            )}
                                                                        </div>
                                                                    ))}
                                                                </div>

                                                                {/* PR File and Product Pictures - Show in quote details */}
                                                                {order.type === 'quote' && (order.prFile || (order.productPictures && order.productPictures.length > 0)) && order.status === 'Hold' && (
                                                                    <div className="quote-highlight mb-3">
                                                                        <div className="flex items-center gap-2 mb-2">
                                                                            <i className="fas fa-exclamation-triangle quote-highlight-icon"></i>
                                                                            <p className="quote-highlight-text">ðŸ“Ž ADDITIONAL FILES</p>
                                                                        </div>
                                                                        <div className="space-y-2">
                                                                            {order.prNumber && <p className="quote-highlight-text"><i className="fas fa-hashtag mr-2"></i>PR Number: {order.prNumber}</p>}
                                                                            {order.productSerialNumbers && <p className="quote-highlight-text"><i className="fas fa-barcode mr-2"></i>Product Serial Numbers: {order.productSerialNumbers}</p>}
                                                                            {order.prFile && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.prFile)}>
                                                                                    <i className="fas fa-file-pdf text-purple-500"></i>
                                                                                    <span className="text-[8px]">PR File: {order.prFile.name}</span>
                                                                                </div>
                                                                            )}
                                                                            {order.productPictures && order.productPictures.map((pic, idx) => (
                                                                                <div key={idx} className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(pic)}>
                                                                                    <i className="fas fa-image text-green-500"></i>
                                                                                    <span className="text-[8px]">Product Picture {idx+1}: {pic.name}</span>
                                                                                </div>
                                                                            ))}
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {/* Document Display Section - All documents shown */}
                                                                {showDocuments && (
                                                                    <div className="mt-3 p-3 bg-purple-50 rounded-lg">
                                                                        <p className="text-[9px] font-bold text-purple-600 mb-2">Order Documents:</p>
                                                                        <div className="space-y-2">
                                                                            {order.documents.mushak6_3 && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.mushak6_3)}>
                                                                                    <i className="fas fa-file-pdf text-purple-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">Mushak-6.3 (Admin)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.mushak6_3.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-purple-500"></i>
                                                                                </div>
                                                                            )}
                                                                            {order.documents.bin_certificate && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.bin_certificate)}>
                                                                                    <i className="fas fa-file-pdf text-blue-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">BIN (Admin)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.bin_certificate.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-blue-500"></i>
                                                                                </div>
                                                                            )}
                                                                            {order.documents.mushak6_6 && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.mushak6_6)}>
                                                                                    <i className="fas fa-file-pdf text-red-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">Mushak-6.6 (Customer)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.mushak6_6.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-red-500"></i>
                                                                                </div>
                                                                            )}
                                                                            {order.documents.customer_bin && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.customer_bin)}>
                                                                                    <i className="fas fa-file-pdf text-orange-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">BIN (Customer)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.customer_bin.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-orange-500"></i>
                                                                                </div>
                                                                            )}
                                                                            {order.documents.vds && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.vds)}>
                                                                                    <i className="fas fa-file-pdf text-blue-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">VDS (Customer)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.vds.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-blue-500"></i>
                                                                                </div>
                                                                            )}
                                                                            {order.documents.tds && (
                                                                                <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(order.documents.tds)}>
                                                                                    <i className="fas fa-file-pdf text-green-500"></i>
                                                                                    <div className="flex-grow">
                                                                                        <span className="file-name font-bold">TDS (Customer)</span>
                                                                                        <span className="file-size ml-2 text-[8px]">({order.documents.tds.size})</span>
                                                                                    </div>
                                                                                    <i className="fas fa-eye text-green-500"></i>
                                                                                </div>
                                                                            )}
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {/* Quote Details Highlight - HOLD mode */}
                                                                {order.type === 'quote' && order.quoteDetails && order.status === 'Hold' && (
                                                                    <div className="quote-highlight mb-3">
                                                                        <div className="flex items-center gap-2 mb-2">
                                                                            <i className="fas fa-exclamation-triangle quote-highlight-icon"></i>
                                                                            <p className="quote-highlight-text">â­ QUOTE DETAILS â­</p>
                                                                        </div>
                                                                        <div className="space-y-2">
                                                                            {order.origin && <p className="quote-highlight-text"><i className="fas fa-globe-asia mr-2"></i>Origin: {order.origin}</p>}
                                                                            {order.condition && <p className="quote-highlight-text"><i className="fas fa-box mr-2"></i>Condition: {order.condition}</p>}
                                                                            {order.leadTime && <p className="quote-highlight-text"><i className="fas fa-clock mr-2"></i>Requested Lead Time: {order.leadTime}</p>}
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {/* Warranty Badge */}
                                                                {order.warranty && (
                                                                    <div className="warranty-badge mb-2">
                                                                        <i className="fas fa-shield-alt mr-1"></i>
                                                                        Warranty: {order.warranty}
                                                                    </div>
                                                                )}

                                                                {/* Payment Method Notification with Transaction ID Status */}
                                                                {order.payment && order.payment.notifications && (
                                                                    <div className="mt-2 p-2 bg-blue-50 rounded-lg text-[10px] text-blue-700">
                                                                        <i className="fas fa-info-circle mr-1"></i>
                                                                        {order.payment.notifications}
                                                                        
                                                                        {/* Transaction ID Display with Color Coding */}
                                                                        {order.payment.trxId && (
                                                                            <div className="mt-2">
                                                                                <span className={order.payment.trxApproved ? 'transaction-id-green' : 'transaction-id-yellow'}>
                                                                                    <i className={`fas ${order.payment.trxApproved ? 'fa-check-circle' : 'fa-clock'} mr-1`}></i>
                                                                                    TXN: {order.payment.trxId}
                                                                                    {order.payment.trxApproved ? ' (Verified)' : ' (Pending Verification)'}
                                                                                </span>
                                                                            </div>
                                                                        )}
                                                                        
                                                                        <div className="mt-1 text-xs">
                                                                            <i className="fab fa-whatsapp text-green-600 mr-1"></i>
                                                                            WhatsApp: {formatWhatsAppNumber(COMPANY_INFO.whatsapp)}
                                                                        </div>
                                                                        
                                                                        {/* Blinking Submit Transaction Button - Only in Processing mode and no trxId */}
                                                                        {order.payment.method !== 'cod' && !order.payment.trxId && order.status === 'Processing' && (
                                                                            <button
                                                                                onClick={() => handleProcessingOrder(order)}
                                                                                className="blink-soft-button mt-2 w-full py-3 rounded-lg text-xs font-black uppercase tracking-widest flex items-center justify-center gap-2"
                                                                            >
                                                                                <i className="fas fa-exclamation-triangle animate-pulse"></i>
                                                                                âš¡ SUBMIT TRANSACTION ID NOW âš¡
                                                                            </button>
                                                                        )}
                                                                    </div>
                                                                )}

                                                                {/* Document Upload for Delivered Orders - Only Customer */}
                                                                {order.status === 'Delivered' && (!order.documents?.mushak6_6 || !order.documents?.vds || !order.documents?.tds) && (
                                                                    <div className="mt-2 p-2 bg-purple-50 rounded-lg">
                                                                        <p className="text-[9px] font-bold text-purple-600 mb-2">Required Documents:</p>
                                                                        <button
                                                                            onClick={() => {
                                                                                setCurrentOrderForDocs(order);
                                                                                setShowDocumentModal(true);
                                                                            }}
                                                                            className="w-full bg-purple-500 text-white py-2 rounded text-[9px] font-bold hover:bg-purple-600"
                                                                        >
                                                                            Upload Documents (Mushak-6.6, VDS, TDS, BIN)
                                                                        </button>
                                                                    </div>
                                                                )}

                                                                {/* Quote Details Section */}
                                                                {order.type === 'quote' && order.quoteDetails && (
                                                                    <div className="mt-2 p-3 bg-blue-50 rounded-lg">
                                                                        <p className="text-xs font-bold text-blue-600 mb-2">Quote Details:</p>
                                                                        <div className="space-y-1 text-xs">
                                                                            <p>Subtotal: à§³{order.quoteDetails.subtotal.toLocaleString()}</p>
                                                                            <p>AIT (5%): à§³{order.quoteDetails.ait.toLocaleString()}</p>
                                                                            <p>VAT (10%): à§³{order.quoteDetails.vat.toLocaleString()}</p>
                                                                            <p className="font-bold">Quoted Total: à§³{order.quoteDetails.price.toLocaleString()}</p>
                                                                            <p className="text-orange-600">Lead Time: {order.quoteDetails.leadTime}</p>
                                                                            {order.quoteDetails.warranty && (
                                                                                <p className="text-green-600">Warranty: {order.quoteDetails.warranty}</p>
                                                                            )}
                                                                            {order.quoteDetails.origin && (
                                                                                <p className="text-purple-600">Origin: {order.quoteDetails.origin}</p>
                                                                            )}
                                                                            {order.quoteDetails.originalPrice && (
                                                                                <p className="text-xs text-slate-400">Original Price: à§³{parseFloat(order.quoteDetails.originalPrice).toLocaleString()}</p>
                                                                            )}
                                                                        </div>
                                                                        
                                                                        {order.status === 'Hold' && !order.customerResponse && (
                                                                            <div className="mt-3 flex gap-2">
                                                                                <button
                                                                                    onClick={() => {
                                                                                        setSelectedOrderForInterest(order);
                                                                                        setQuoteSubtotal(order.quoteDetails.subtotal.toString());
                                                                                        setQuoteAIT(order.quoteDetails.ait.toString());
                                                                                        setQuoteVAT(order.quoteDetails.vat.toString());
                                                                                        setQuoteGrandTotal(order.quoteDetails.price.toString());
                                                                                        setQuoteLeadTime(order.quoteDetails.leadTime);
                                                                                        setQuoteWarranty(order.quoteDetails.warranty);
                                                                                        setQuoteOrigin(order.quoteDetails.origin || '');
                                                                                        setShowInterestModal(true);
                                                                                    }}
                                                                                    className="flex-1 bg-green-500 text-white py-2 rounded-lg text-[9px] font-bold hover:bg-green-600"
                                                                                >
                                                                                    Accept Quote
                                                                                </button>
                                                                                <button
                                                                                    onClick={() => {
                                                                                        setDeclineOrderId(order.id);
                                                                                        setShowDeclineModal(true);
                                                                                    }}
                                                                                    className="flex-1 bg-red-500 text-white py-2 rounded-lg text-[9px] font-bold hover:bg-red-600"
                                                                                >
                                                                                    Decline
                                                                                </button>
                                                                            </div>
                                                                        )}
                                                                    </div>
                                                                )}

                                                                {/* Origin and Condition for Quotes - Highlighted */}
                                                                {order.type === 'quote' && (order.origin || order.condition || order.leadTime) && order.status === 'Hold' && (
                                                                    <div className="quote-highlight mt-2">
                                                                        {order.origin && <p className="quote-highlight-text"><i className="fas fa-globe-asia mr-2"></i>ðŸŒ Origin: {order.origin}</p>}
                                                                        {order.condition && <p className="quote-highlight-text"><i className="fas fa-box mr-2"></i>ðŸ“¦ Condition: {order.condition}</p>}
                                                                        {order.leadTime && <p className="quote-highlight-text"><i className="fas fa-clock mr-2"></i>â±ï¸ Requested Lead Time: {order.leadTime}</p>}
                                                                    </div>
                                                                )}
                                                                
                                                                {order.type === 'order' && order.totals && (
                                                                    <div className="border-t border-slate-100 pt-2 mt-2 space-y-1">
                                                                        <div className="flex justify-between text-[10px]">
                                                                            <span className="text-slate-500">Subtotal:</span>
                                                                            <span className="font-bold">à§³{order.totals.subtotal.toLocaleString()}</span>
                                                                        </div>
                                                                        {order.payment?.method !== 'cod' && (
                                                                            <>
                                                                                <div className="flex justify-between text-[10px]">
                                                                                    <span className="text-slate-500">AIT (5%):</span>
                                                                                    <span className="font-bold">+ à§³{order.totals.ait.toLocaleString()}</span>
                                                                                </div>
                                                                                <div className="flex justify-between text-[10px] font-black text-brandDark">
                                                                                    <span>Total after AIT:</span>
                                                                                    <span>à§³{order.totals.totalWithAit.toLocaleString()}</span>
                                                                                </div>
                                                                                <div className="flex justify-between text-[10px]">
                                                                                    <span className="text-slate-500">VAT (10%):</span>
                                                                                    <span className="font-bold">+ à§³{order.totals.vat.toLocaleString()}</span>
                                                                                </div>
                                                                            </>
                                                                        )}
                                                                        <div className="flex justify-between text-xs font-black pt-1 border-t border-slate-200 mt-1">
                                                                            <span>{order.payment?.method === 'cod' ? 'Net Price' : 'GRAND TOTAL'}:</span>
                                                                            <span className="text-brandOrange">à§³{order.payment?.method === 'cod' ? order.totals.subtotal.toLocaleString() : order.totals.grandTotal.toLocaleString()}</span>
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {order.type === 'order' && order.quotedPrice && (
                                                                    <div className="border-t border-slate-100 pt-2 mt-2">
                                                                        <div className="flex justify-between text-sm font-black">
                                                                            <span>Quoted Amount:</span>
                                                                            <span className="text-brandBlue">à§³{order.quotedPrice.toLocaleString()}</span>
                                                                        </div>
                                                                    </div>
                                                                )}
                                                                
                                                                {order.type === 'quote' && !order.quoteDetails && (
                                                                    <div className="border-t border-slate-100 pt-2 mt-2">
                                                                        <p className="text-[9px] text-orange-500 font-bold uppercase">
                                                                            Awaiting Price Quote
                                                                        </p>
                                                                    </div>
                                                                )}

                                                                {order.status === 'Shipped' && order.trackingNumber && (
                                                                    <div className="mt-2 p-2 bg-indigo-50 rounded-lg">
                                                                        <p className="text-[9px] font-bold text-indigo-600">
                                                                            {order.trackingPlatform && COURIER_PLATFORMS.find(p => p.id === order.trackingPlatform)?.name}: {order.trackingNumber}
                                                                        </p>
                                                                        {order.estimatedDelivery && (
                                                                            <p className="text-[8px] text-indigo-500 mt-1">Est. Delivery: {order.estimatedDelivery}</p>
                                                                        )}
                                                                    </div>
                                                                )}

                                                                {order.review && (
                                                                    <div className="mt-3 p-3 bg-yellow-50 rounded-lg">
                                                                        <div className="flex items-center gap-1 mb-2 star-rating">
                                                                            {[1,2,3,4,5].map(star => (
                                                                                <i key={star} className={`fas fa-star ${star <= order.review.rating ? 'text-yellow-400' : 'text-gray-300'}`}></i>
                                                                            ))}
                                                                        </div>
                                                                        <p className="text-xs text-slate-600">{order.review.comment}</p>
                                                                        <p className="text-[8px] text-slate-400 mt-1">{order.review.date}</p>
                                                                    </div>
                                                                )}
                                                                
                                                                <div className="mt-3 flex gap-2">
                                                                    {order.type === 'order' && (
                                                                        <button
                                                                            onClick={() => generateInvoicePDF(order, logo, order.documents)}
                                                                            className="flex-1 bg-blue-500 text-white py-2 rounded-lg text-[9px] font-black uppercase tracking-widest hover:bg-blue-600 transition-colors flex items-center justify-center gap-1"
                                                                        >
                                                                            <i className="fas fa-file-pdf"></i> Invoice
                                                                        </button>
                                                                    )}
                                                                    
                                                                    {order.status === 'Shipped' && order.trackingUrl && (
                                                                        <button
                                                                            onClick={() => window.open(order.trackingUrl, '_blank')}
                                                                            className="flex-1 tracking-btn py-2 rounded-lg text-[9px] font-black uppercase tracking-widest flex items-center justify-center gap-1"
                                                                        >
                                                                            <i className="fas fa-truck"></i> Track
                                                                        </button>
                                                                    )}
                                                                    
                                                                    {order.status !== 'Shipped' && order.status !== 'Delivered' && order.status !== 'Done' && (
                                                                        <div className="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg text-[9px] font-black uppercase tracking-widest text-center">
                                                                            {order.status}
                                                                        </div>
                                                                    )}
                                                                    
                                                                    {/* For Delivered orders, only show Review and Reorder buttons */}
                                                                    {order.status === 'Delivered' && (
                                                                        <>
                                                                            {!order.review && (
                                                                                <button
                                                                                    onClick={() => {
                                                                                        setOrderToReview(order);
                                                                                        setShowReviewModal(true);
                                                                                    }}
                                                                                    className="flex-1 bg-purple-500 text-white py-2 rounded-lg text-[9px] font-black uppercase tracking-widest hover:bg-purple-600 transition-colors flex items-center justify-center gap-1"
                                                                                >
                                                                                    <i className="fas fa-star"></i> Review
                                                                                </button>
                                                                            )}
                                                                            <button
                                                                                onClick={() => {
                                                                                    const reorderItems = order.items.map(item => {
                                                                                        const product = products.find(p => p.id === item.id);
                                                                                        return product ? { ...product, qty: item.qty } : null;
                                                                                    }).filter(Boolean);
                                                                                    setCart(reorderItems);
                                                                                    setActiveSection('products');
                                                                                    setIsCartOpen(true);
                                                                                }}
                                                                                className="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg text-[9px] font-black uppercase tracking-widest hover:bg-slate-200 transition-colors"
                                                                            >
                                                                                Reorder
                                                                            </button>
                                                                        </>
                                                                    )}
                                                                    
                                                                    {/* For Done orders, only show Order Number - no buttons */}
                                                                    {order.status === 'Done' && (
                                                                        <div className="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg text-[9px] font-black uppercase tracking-widest text-center">
                                                                            Order Completed
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Address Edit Modal */}
                    {showAddressModal && (
                        <div className="fixed inset-0 z-[110] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-6">Edit Shipping Address</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    setUsers(users.map(u => 
                                        u.id === currentUser.id 
                                            ? { ...u, address: { road: customerForm.road, thana: customerForm.thana, city: customerForm.city } }
                                            : u
                                    ));
                                    setCurrentUser({ ...currentUser, address: { road: customerForm.road, thana: customerForm.thana, city: customerForm.city } });
                                    setShowAddressModal(false);
                                    alert('Address updated successfully!');
                                }} className="space-y-4">
                                    <input
                                        required
                                        type="text"
                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                        value={customerForm.road}
                                        onChange={e => setCustomerForm({...customerForm, road: e.target.value})}
                                        placeholder="Road No / Village"
                                    />
                                    <div className="grid grid-cols-2 gap-4">
                                        <input
                                            required
                                            type="text"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={customerForm.thana}
                                            onChange={e => setCustomerForm({...customerForm, thana: e.target.value})}
                                            placeholder="Thana"
                                        />
                                        <input
                                            required
                                            type="text"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={customerForm.city}
                                            onChange={e => setCustomerForm({...customerForm, city: e.target.value})}
                                            placeholder="City"
                                        />
                                    </div>
                                    <div className="flex gap-4 pt-4">
                                        <button type="submit" className="flex-1 bg-brandBlue text-white py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-colors">
                                            Save Address
                                        </button>
                                        <button type="button" onClick={() => setShowAddressModal(false)} className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Order Details Modal */}
                    {selectedOrderForDetails && (
                        <div className="fixed inset-0 z-[120] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                                <div className="sticky top-0 bg-white p-6 border-b border-slate-100 flex justify-between items-center">
                                    <div>
                                        <h3 className="text-xl font-black text-brandDark uppercase">Order Details</h3>
                                        <p className="text-xs text-slate-400">{selectedOrderForDetails.id}</p>
                                    </div>
                                    <button 
                                        onClick={() => setSelectedOrderForDetails(null)} 
                                        className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-red-50 hover:text-red-500"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div className="p-6 space-y-6">
                                    {/* Customer Info */}
                                    <div className="bg-slate-50 rounded-xl p-4">
                                        <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Customer Information</h4>
                                        <div className="grid grid-cols-2 gap-4 text-sm">
                                            <div>
                                                <p className="text-slate-500 text-[10px]">Name</p>
                                                <p className="font-bold">{selectedOrderForDetails.customer.name}</p>
                                            </div>
                                            <div>
                                                <p className="text-slate-500 text-[10px]">Phone</p>
                                                <p className="font-bold">{formatPhoneNumber(selectedOrderForDetails.customer.phone)}</p>
                                            </div>
                                            <div className="col-span-2">
                                                <p className="text-slate-500 text-[10px]">Address</p>
                                                <p className="font-bold">{selectedOrderForDetails.customer.road}, {selectedOrderForDetails.customer.thana}, {selectedOrderForDetails.customer.city}</p>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Order Items */}
                                    <div className="bg-slate-50 rounded-xl p-4">
                                        <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Ordered Products</h4>
                                        <div className="space-y-4">
                                            {selectedOrderForDetails.items.map((item, idx) => {
                                                const product = products.find(p => p.id === item.id);
                                                return (
                                                    <div key={idx} className="flex gap-4 bg-white p-3 rounded-lg">
                                                        {product && (
                                                            <img 
                                                                src={product.image} 
                                                                alt={item.name}
                                                                className="w-16 h-16 object-contain bg-slate-50 rounded-lg"
                                                                onError={(e) => {
                                                                    e.target.onerror = null;
                                                                    e.target.src = 'https://via.placeholder.com/64?text=Product';
                                                                }}
                                                            />
                                                        )}
                                                        <div className="flex-grow">
                                                            <p className="font-bold text-sm">{item.name}</p>
                                                            <div className="flex gap-4 mt-2 text-xs">
                                                                <span className="text-slate-500">Brand: {item.brand}</span>
                                                                {item.origin && <span className="text-slate-500">Origin: {item.origin}</span>}
                                                                <span className="text-slate-500">Qty: {item.qty}</span>
                                                            </div>
                                                            {item.stockStatus && (
                                                                <span className={`inline-block mt-2 text-[8px] font-black uppercase px-2 py-1 rounded ${
                                                                    item.stockStatus === 'in-stock' ? 'bg-green-100 text-green-600' :
                                                                    item.stockStatus === 'pre-order' ? 'bg-orange-100 text-orange-600' :
                                                                    item.stockStatus === '7-15-days' ? 'bg-orange-100 text-orange-600' :
                                                                    item.stockStatus === '15-30-days' ? 'bg-orange-100 text-orange-600' :
                                                                    item.stockStatus === '30-45-days' ? 'bg-orange-100 text-orange-600' :
                                                                    'bg-red-100 text-red-600'
                                                                }`}>
                                                                    {item.stockStatus === 'in-stock' ? 'IN STOCK' :
                                                                     item.stockStatus === '7-15-days' ? '7-15 DAYS' :
                                                                     item.stockStatus === '15-30-days' ? '15-30 DAYS' :
                                                                     item.stockStatus === '30-45-days' ? '30-45 DAYS' :
                                                                     item.stockStatus === 'pre-order' ? 'PRE-ORDER' :
                                                                     'OUT OF STOCK'}
                                                                </span>
                                                            )}
                                                            {/* Product Datasheet Link */}
                                                            {product && product.datasheet && (
                                                                <a 
                                                                    href={product.datasheet} 
                                                                    target="_blank" 
                                                                    rel="noopener noreferrer"
                                                                    className="inline-flex items-center gap-1 mt-2 text-[8px] text-brandBlue hover:underline"
                                                                >
                                                                    <i className="fas fa-file-pdf"></i>
                                                                    Datasheet
                                                                </a>
                                                            )}
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                        
                                        {/* Document Display Section - Shows all documents */}
                                        {selectedOrderForDetails.documents && (selectedOrderForDetails.documents.mushak6_3 || selectedOrderForDetails.documents.bin_certificate || selectedOrderForDetails.documents.mushak6_6 || selectedOrderForDetails.documents.vds || selectedOrderForDetails.documents.tds || selectedOrderForDetails.documents.customer_bin) && (
                                            <div className="mt-4 p-3 bg-purple-50 rounded-lg">
                                                <p className="text-[9px] font-bold text-purple-600 mb-2">All Order Documents:</p>
                                                <div className="space-y-2">
                                                    {selectedOrderForDetails.documents.mushak6_3 && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.mushak6_3)}>
                                                            <i className="fas fa-file-pdf text-purple-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">Mushak-6.3 (Admin)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.mushak6_3.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-purple-500"></i>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.documents.bin_certificate && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.bin_certificate)}>
                                                            <i className="fas fa-file-pdf text-blue-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">BIN (Admin)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.bin_certificate.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-blue-500"></i>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.documents.mushak6_6 && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.mushak6_6)}>
                                                            <i className="fas fa-file-pdf text-red-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">Mushak-6.6 (Customer)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.mushak6_6.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-red-500"></i>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.documents.customer_bin && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.customer_bin)}>
                                                            <i className="fas fa-file-pdf text-orange-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">BIN (Customer)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.customer_bin.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-orange-500"></i>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.documents.vds && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.vds)}>
                                                            <i className="fas fa-file-pdf text-blue-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">VDS (Customer)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.vds.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-blue-500"></i>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.documents.tds && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.documents.tds)}>
                                                            <i className="fas fa-file-pdf text-green-500"></i>
                                                            <div className="flex-grow">
                                                                <span className="file-name font-bold">TDS (Customer)</span>
                                                                <span className="file-size ml-2">({selectedOrderForDetails.documents.tds.size})</span>
                                                            </div>
                                                            <i className="fas fa-eye text-green-500"></i>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        )}

                                        {/* PR File and Product Pictures - Show in quote details */}
                                        {selectedOrderForDetails.type === 'quote' && (selectedOrderForDetails.prFile || (selectedOrderForDetails.productPictures && selectedOrderForDetails.productPictures.length > 0)) && (
                                            <div className="quote-highlight mt-4">
                                                <p className="quote-highlight-text mb-2">ðŸ“Ž ADDITIONAL FILES</p>
                                                <div className="space-y-2">
                                                    {selectedOrderForDetails.prNumber && <p className="quote-highlight-text"><i className="fas fa-hashtag mr-2"></i>PR Number: {selectedOrderForDetails.prNumber}</p>}
                                                    {selectedOrderForDetails.productSerialNumbers && <p className="quote-highlight-text"><i className="fas fa-barcode mr-2"></i>Product Serial Numbers: {selectedOrderForDetails.productSerialNumbers}</p>}
                                                    {selectedOrderForDetails.prFile && (
                                                        <div className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(selectedOrderForDetails.prFile)}>
                                                            <i className="fas fa-file-pdf text-purple-500"></i>
                                                            <span className="text-[8px]">PR File: {selectedOrderForDetails.prFile.name}</span>
                                                        </div>
                                                    )}
                                                    {selectedOrderForDetails.productPictures && selectedOrderForDetails.productPictures.map((pic, idx) => (
                                                        <div key={idx} className="document-file cursor-pointer hover:bg-purple-100" onClick={() => openDocumentViewer(pic)}>
                                                            <i className="fas fa-image text-green-500"></i>
                                                            <span className="text-[8px]">Product Picture {idx+1}: {pic.name}</span>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {/* Quote Details Highlight */}
                                        {selectedOrderForDetails.type === 'quote' && (selectedOrderForDetails.origin || selectedOrderForDetails.condition || selectedOrderForDetails.leadTime) && selectedOrderForDetails.status === 'Hold' && (
                                            <div className="quote-highlight mt-4">
                                                <p className="quote-highlight-text mb-2">â­ QUOTE REQUIREMENTS â­</p>
                                                {selectedOrderForDetails.origin && <p className="quote-highlight-text"><i className="fas fa-globe-asia mr-2"></i>ðŸŒ Origin: {selectedOrderForDetails.origin}</p>}
                                                {selectedOrderForDetails.condition && <p className="quote-highlight-text"><i className="fas fa-box mr-2"></i>ðŸ“¦ Condition: {selectedOrderForDetails.condition}</p>}
                                                {selectedOrderForDetails.leadTime && <p className="quote-highlight-text"><i className="fas fa-clock mr-2"></i>â±ï¸ Requested Lead Time: {selectedOrderForDetails.leadTime}</p>}
                                            </div>
                                        )}
                                        
                                        {/* Warranty Badge */}
                                        {selectedOrderForDetails.warranty && (
                                            <div className="mt-2 warranty-badge">
                                                <i className="fas fa-shield-alt mr-1"></i>
                                                Warranty: {selectedOrderForDetails.warranty}
                                            </div>
                                        )}
                                        
                                        {/* Quote Details */}
                                        {selectedOrderForDetails.quoteDetails && (
                                            <div className="mt-4 p-3 bg-blue-50 rounded-lg">
                                                <h5 className="font-bold text-xs text-blue-600 mb-2">Price Quote</h5>
                                                <div className="space-y-1 text-xs">
                                                    <p>Subtotal: à§³{selectedOrderForDetails.quoteDetails.subtotal.toLocaleString()}</p>
                                                    <p>AIT (5%): à§³{selectedOrderForDetails.quoteDetails.ait.toLocaleString()}</p>
                                                    <p>VAT (10%): à§³{selectedOrderForDetails.quoteDetails.vat.toLocaleString()}</p>
                                                    <p className="font-bold">Quoted Total: à§³{selectedOrderForDetails.quoteDetails.price.toLocaleString()}</p>
                                                    <p className="text-orange-600">Lead Time: {selectedOrderForDetails.quoteDetails.leadTime}</p>
                                                    {selectedOrderForDetails.quoteDetails.warranty && (
                                                        <p className="text-green-600">Warranty: {selectedOrderForDetails.quoteDetails.warranty}</p>
                                                    )}
                                                    {selectedOrderForDetails.quoteDetails.origin && (
                                                        <p className="text-purple-600">Origin: {selectedOrderForDetails.quoteDetails.origin}</p>
                                                    )}
                                                    {selectedOrderForDetails.quoteDetails.originalPrice && (
                                                        <p className="text-xs text-slate-400">Original Price: à§³{parseFloat(selectedOrderForDetails.quoteDetails.originalPrice).toLocaleString()}</p>
                                                    )}
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    {/* Payment Info */}
                                    {selectedOrderForDetails.payment && (
                                        <div className="bg-slate-50 rounded-xl p-4">
                                            <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Payment Details</h4>
                                            <div className="space-y-2">
                                                <div className="flex justify-between text-sm">
                                                    <span className="text-slate-500">Payment Method:</span>
                                                    <span className="font-bold uppercase">{selectedOrderForDetails.payment.method}</span>
                                                </div>
                                                {selectedOrderForDetails.payment.method === 'bank' && (
                                                    <div className="mt-2 p-2 bg-yellow-50 rounded-lg text-xs">
                                                        <p className="font-bold">Pay to:</p>
                                                        <p>{COMPANY_INFO.bankDetails.accountName}</p>
                                                        <p>A/C: {COMPANY_INFO.bankDetails.accountNumber}</p>
                                                        <p>Bank: {COMPANY_INFO.bankDetails.bankName}</p>
                                                        <p>Branch: {COMPANY_INFO.bankDetails.branch}</p>
                                                        <p className="mt-1 text-orange-600">{BANK_TRANSFER_TERMS}</p>
                                                    </div>
                                                )}
                                                {selectedOrderForDetails.payment.trxId && selectedOrderForDetails.payment.trxId !== 'N/A' && (
                                                    <div className="flex justify-between text-sm items-center">
                                                        <span className="text-slate-500">Transaction ID:</span>
                                                        <span className={selectedOrderForDetails.payment.trxApproved ? 'transaction-id-green' : 'transaction-id-yellow'}>
                                                            {selectedOrderForDetails.payment.trxId}
                                                            {selectedOrderForDetails.payment.trxApproved ? ' âœ“' : ' â³'}
                                                        </span>
                                                    </div>
                                                )}
                                                {selectedOrderForDetails.payment.notifications && (
                                                    <div className="mt-2 p-2 bg-blue-50 rounded-lg text-xs text-blue-700">
                                                        <i className="fas fa-info-circle mr-1"></i>
                                                        {selectedOrderForDetails.payment.notifications}
                                                    </div>
                                                )}
                                                <div className="mt-2 p-2 bg-green-50 rounded-lg text-xs">
                                                    <i className="fab fa-whatsapp text-green-600 mr-1"></i>
                                                    <span className="font-bold">WhatsApp:</span> {formatWhatsAppNumber(COMPANY_INFO.whatsapp)}
                                                </div>
                                                {selectedOrderForDetails.type === 'order' && selectedOrderForDetails.totals && (
                                                    <div className="border-t border-slate-200 pt-2 mt-2 space-y-1">
                                                        <div className="flex justify-between text-[10px]">
                                                            <span className="text-slate-500">Subtotal:</span>
                                                            <span className="font-bold">à§³{selectedOrderForDetails.totals.subtotal.toLocaleString()}</span>
                                                        </div>
                                                        {selectedOrderForDetails.payment.method !== 'cod' && (
                                                            <>
                                                                <div className="flex justify-between text-[10px]">
                                                                    <span className="text-slate-500">AIT (5%):</span>
                                                                    <span className="font-bold">+ à§³{selectedOrderForDetails.totals.ait.toLocaleString()}</span>
                                                                </div>
                                                                <div className="flex justify-between text-[10px] font-black text-brandDark">
                                                                    <span>Total after AIT:</span>
                                                                    <span>à§³{selectedOrderForDetails.totals.totalWithAit.toLocaleString()}</span>
                                                                </div>
                                                                <div className="flex justify-between text-[10px]">
                                                                    <span className="text-slate-500">VAT (10%):</span>
                                                                    <span className="font-bold">+ à§³{selectedOrderForDetails.totals.vat.toLocaleString()}</span>
                                                                </div>
                                                            </>
                                                        )}
                                                        <div className="flex justify-between text-sm font-black pt-1 border-t border-slate-200 mt-1">
                                                            <span>{selectedOrderForDetails.payment.method === 'cod' ? 'Net Price' : 'GRAND TOTAL'}:</span>
                                                            <span className="text-brandOrange">à§³{selectedOrderForDetails.payment.method === 'cod' ? selectedOrderForDetails.totals.subtotal.toLocaleString() : selectedOrderForDetails.totals.grandTotal.toLocaleString()}</span>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Tracking Information */}
                                    {selectedOrderForDetails.status === 'Shipped' && selectedOrderForDetails.trackingNumber && (
                                        <div className="bg-slate-50 rounded-xl p-4">
                                            <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Tracking Information</h4>
                                            <div className="space-y-2">
                                                <p className="text-sm">
                                                    <span className="font-bold">
                                                        {selectedOrderForDetails.trackingPlatform && COURIER_PLATFORMS.find(p => p.id === selectedOrderForDetails.trackingPlatform)?.name}:
                                                    </span> {selectedOrderForDetails.trackingNumber}
                                                </p>
                                                {selectedOrderForDetails.trackingUrl && (
                                                    <a 
                                                        href={selectedOrderForDetails.trackingUrl} 
                                                        target="_blank" 
                                                        rel="noopener noreferrer"
                                                        className="inline-block bg-indigo-500 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-indigo-600 transition-colors"
                                                    >
                                                        Track Your Order
                                                    </a>
                                                )}
                                                {selectedOrderForDetails.estimatedDelivery && (
                                                    <p className="text-xs text-green-600">Estimated Delivery: {selectedOrderForDetails.estimatedDelivery}</p>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Refund Policy */}
                                    <div className="bg-slate-50 rounded-xl p-4">
                                        <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Refund Policy</h4>
                                        <p className="text-xs text-slate-600">{REFUND_POLICY}</p>
                                    </div>

                                    {/* WhatsApp Contact */}
                                    <div className="bg-slate-50 rounded-xl p-4">
                                        <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Need Help?</h4>
                                        <a 
                                            href={getWhatsAppLink(COMPANY_INFO.whatsapp, 'Hello, I need help with my order ' + selectedOrderForDetails.id)}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            className="inline-flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-green-600 transition-colors"
                                        >
                                            <i className="fab fa-whatsapp"></i>
                                            WhatsApp Us
                                        </a>
                                    </div>

                                    {/* Status History */}
                                    {selectedOrderForDetails.statusMessage && (
                                        <div className="bg-slate-50 rounded-xl p-4">
                                            <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Status Message</h4>
                                            <p className="text-sm bg-white p-3 rounded-lg border-l-4 border-brandOrange">
                                                {selectedOrderForDetails.statusMessage}
                                            </p>
                                        </div>
                                    )}
                                    
                                    {/* Customer Response */}
                                    {selectedOrderForDetails.customerResponse && (
                                        <div className="bg-slate-50 rounded-xl p-4">
                                            <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Customer Response</h4>
                                            <p className="text-sm bg-white p-3 rounded-lg border-l-4 border-green-500">
                                                Customer responded: <span className="font-bold">{selectedOrderForDetails.customerResponse}</span>
                                                {selectedOrderForDetails.declineReason && (
                                                    <span className="block mt-2 text-red-500">Reason: {selectedOrderForDetails.declineReason}</span>
                                                )}
                                            </p>
                                        </div>
                                    )}

                                    {/* Review */}
                                    {selectedOrderForDetails.review && (
                                        <div className="bg-slate-50 rounded-xl p-4">
                                            <h4 className="font-black text-xs uppercase text-brandBlue mb-3">Customer Review</h4>
                                            <div className="bg-white p-3 rounded-lg">
                                                <div className="flex items-center gap-1 mb-2 star-rating">
                                                    {[1,2,3,4,5].map(star => (
                                                        <i key={star} className={`fas fa-star ${star <= selectedOrderForDetails.review.rating ? 'text-yellow-400' : 'text-gray-300'}`}></i>
                                                    ))}
                                                </div>
                                                <p className="text-sm text-slate-600">{selectedOrderForDetails.review.comment}</p>
                                                <p className="text-[10px] text-slate-400 mt-2">{selectedOrderForDetails.review.date}</p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Status Message Modal */}
                    {showStatusModal && (
                        <div className="fixed inset-0 z-[130] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Status Update</h3>
                                <p className="text-xs text-slate-400 mb-6">Please provide a reason for marking this order as {currentStatus}</p>
                                <textarea
                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-4 text-sm font-bold outline-none focus:border-brandBlue min-h-[120px]"
                                    placeholder="Enter your message here..."
                                    value={statusMessage}
                                    onChange={e => setStatusMessage(e.target.value)}
                                ></textarea>
                                <div className="flex gap-4 mt-6">
                                    <button
                                        onClick={handleStatusUpdate}
                                        disabled={!statusMessage}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            statusMessage 
                                                ? 'bg-brandBlue text-white hover:bg-blue-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Send Update
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowStatusModal(false);
                                            setStatusMessage('');
                                            setCurrentOrderId(null);
                                            setCurrentStatus('');
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Tracking Modal with Document Uploads */}
                    {showTrackingModal && currentOrderForTracking && (
                        <div className="fixed inset-0 z-[135] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Add Tracking Information</h3>
                                <p className="text-xs text-slate-400 mb-6">For order {currentOrderForTracking.id}</p>
                                
                                <div className="shipping-info-box">
                                    <div className="space-y-4">
                                        <div>
                                            <label className="upload-label">COURIER PLATFORM</label>
                                            <select
                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                value={trackingPlatform}
                                                onChange={e => setTrackingPlatform(e.target.value)}
                                            >
                                                <option value="">Select Platform</option>
                                                {COURIER_PLATFORMS.map(platform => (
                                                    <option key={platform.id} value={platform.id}>{platform.name}</option>
                                                ))}
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label className="upload-label">TRACKING NUMBER</label>
                                            <input
                                                type="text"
                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                value={trackingNumber}
                                                onChange={e => setTrackingNumber(e.target.value)}
                                                placeholder="Enter tracking number"
                                            />
                                        </div>

                                        {/* Document Upload Section */}
                                        <div className="document-upload-row">
                                            <div>
                                                <label className="upload-label">MUSHAK-6.3</label>
                                                <div className="document-upload">
                                                    <input
                                                        type="file"
                                                        accept=".jpg,.jpeg,.png,.pdf"
                                                        onChange={(e) => handleFileUpload(e, 'tracking_mushak63')}
                                                        className="hidden"
                                                        id="tracking-mushak63-upload"
                                                    />
                                                    <label htmlFor="tracking-mushak63-upload" className="cursor-pointer">
                                                        <i className="fas fa-cloud-upload-alt text-xl text-brandBlue mb-1"></i>
                                                        <p className="text-[10px]">Upload 6.3</p>
                                                    </label>
                                                </div>
                                                {trackingMushak63 && (
                                                    <div className="document-file mt-2">
                                                        <i className="fas fa-file-pdf text-purple-500"></i>
                                                        <span className="text-[8px]">{trackingMushak63.name}</span>
                                                    </div>
                                                )}
                                            </div>

                                            <div>
                                                <label className="upload-label">BIN CERTIFICATE</label>
                                                <div className="document-upload">
                                                    <input
                                                        type="file"
                                                        accept=".jpg,.jpeg,.png,.pdf"
                                                        onChange={(e) => handleFileUpload(e, 'tracking_bin')}
                                                        className="hidden"
                                                        id="tracking-bin-upload"
                                                    />
                                                    <label htmlFor="tracking-bin-upload" className="cursor-pointer">
                                                        <i className="fas fa-cloud-upload-alt text-xl text-brandBlue mb-1"></i>
                                                        <p className="text-[10px]">Upload BIN</p>
                                                    </label>
                                                </div>
                                                {trackingBin && (
                                                    <div className="document-file mt-2">
                                                        <i className="fas fa-file-pdf text-blue-500"></i>
                                                        <span className="text-[8px]">{trackingBin.name}</span>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button
                                        onClick={handleTrackingSubmit}
                                        disabled={!trackingPlatform || !trackingNumber}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            trackingPlatform && trackingNumber
                                                ? 'bg-brandBlue text-white hover:bg-blue-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Save Tracking Info
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowTrackingModal(false);
                                            setTrackingPlatform('');
                                            setTrackingNumber('');
                                            setTrackingMushak63(null);
                                            setTrackingBin(null);
                                            setCurrentOrderForTracking(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Mushak-6.3 and BIN Upload Modal (Admin) - FIXED */}
                    {showMushak63Modal && currentOrderForMushak63 && (
                        <div className="fixed inset-0 z-[136] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Upload Documents</h3>
                                <p className="text-xs text-slate-400 mb-6">For order {currentOrderForMushak63.id}</p>
                                
                                <div className="space-y-6">
                                    {/* Mushak-6.3 */}
                                    <div>
                                        <label className="upload-label">MUSHAK-6.3</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'mushak6_3')}
                                                className="hidden"
                                                id="mushak63-upload"
                                            />
                                            <label htmlFor="mushak63-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload Mushak-6.3</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {mushak63File && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-purple-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{mushak63File.name}</span>
                                                    <span className="file-size ml-2">({mushak63File.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>

                                    {/* BIN Certificate */}
                                    <div>
                                        <label className="upload-label">BIN CERTIFICATE</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'bin')}
                                                className="hidden"
                                                id="bin-upload"
                                            />
                                            <label htmlFor="bin-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload BIN Certificate</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {binFile && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-blue-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{binFile.name}</span>
                                                    <span className="file-size ml-2">({binFile.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button
                                        onClick={submitMushak63}
                                        disabled={!mushak63File && !binFile}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            mushak63File || binFile
                                                ? 'bg-brandBlue text-white hover:bg-blue-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Upload Documents
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowMushak63Modal(false);
                                            setMushak63File(null);
                                            setBinFile(null);
                                            setCurrentOrderForMushak63(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Quote Confirmation Modal - UPDATED with Origin Dropdown */}
                    {showConfirmModal && quoteToConfirm && (
                        <div className="fixed inset-0 z-[140] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Send Price Quote</h3>
                                <p className="text-xs text-slate-400 mb-6">Enter price details for {quoteToConfirm.items[0].name}</p>
                                
                                <div className="space-y-4">
                                    {originalPrice && (
                                        <div className="bg-slate-100 p-3 rounded-lg">
                                            <p className="text-xs text-slate-600">Original Price: à§³{parseFloat(originalPrice).toLocaleString()}</p>
                                        </div>
                                    )}
                                    
                                    {/* NEW: Origin Dropdown */}
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Origin</label>
                                        <select
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteOrigin}
                                            onChange={e => setQuoteOrigin(e.target.value)}
                                        >
                                            <option value="">Select Origin</option>
                                            {originOptions.map(origin => (
                                                <option key={origin} value={origin}>{origin}</option>
                                            ))}
                                        </select>
                                        {quoteToConfirm.origin && quoteOrigin && quoteToConfirm.origin !== quoteOrigin && (
                                            <p className="text-[9px] text-orange-500 mt-1">
                                                âš ï¸ Customer requested: {quoteToConfirm.origin}
                                            </p>
                                        )}
                                    </div>
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Subtotal (à§³)</label>
                                        <input
                                            type="number"
                                            min="0"
                                            step="0.01"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteSubtotal}
                                            onChange={e => handlePriceChange(e.target.value)}
                                            placeholder="Enter subtotal"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">AIT (5%) (à§³)</label>
                                        <input
                                            type="number"
                                            min="0"
                                            step="0.01"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteAIT}
                                            readOnly
                                            placeholder="Auto-calculated"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">VAT (10%) (à§³)</label>
                                        <input
                                            type="number"
                                            min="0"
                                            step="0.01"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteVAT}
                                            readOnly
                                            placeholder="Auto-calculated"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Grand Total (à§³)</label>
                                        <input
                                            type="number"
                                            min="0"
                                            step="0.01"
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteGrandTotal}
                                            readOnly
                                            placeholder="Auto-calculated"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Lead Time</label>
                                        <select
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteLeadTime}
                                            onChange={e => setQuoteLeadTime(e.target.value)}
                                        >
                                            <option value="">Select Lead Time</option>
                                            {LEAD_TIME_OPTIONS.map(time => (
                                                <option key={time} value={time}>{time}</option>
                                            ))}
                                        </select>
                                        {quoteToConfirm.leadTime && quoteLeadTime && quoteToConfirm.leadTime !== quoteLeadTime && (
                                            <p className="text-[9px] text-orange-500 mt-1">
                                                âš ï¸ Customer requested: {quoteToConfirm.leadTime}
                                            </p>
                                        )}
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Warranty</label>
                                        <select
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                            value={quoteWarranty}
                                            onChange={e => setQuoteWarranty(e.target.value)}
                                        >
                                            <option value="">Select Warranty</option>
                                            {WARRANTY_OPTIONS.map(warranty => (
                                                <option key={warranty} value={warranty}>{warranty}</option>
                                            ))}
                                        </select>
                                        {quoteToConfirm.warranty && quoteWarranty && quoteToConfirm.warranty !== quoteWarranty && (
                                            <p className="text-[9px] text-orange-500 mt-1">
                                                âš ï¸ Customer requested: {quoteToConfirm.warranty}
                                            </p>
                                        )}
                                        {quoteWarranty && (
                                            <div className="mt-2 p-2 bg-green-50 rounded-lg text-xs text-green-700">
                                                <i className="fas fa-shield-alt mr-1"></i>
                                                {WARRANTY_TERMS[quoteWarranty]}
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button
                                        onClick={submitConfirmedQuote}
                                        className="flex-1 bg-brandBlue text-white py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                    >
                                        Send Quote to Customer
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowConfirmModal(false);
                                            setQuoteSubtotal('');
                                            setQuoteAIT('');
                                            setQuoteVAT('');
                                            setQuoteGrandTotal('');
                                            setQuoteLeadTime('');
                                            setQuoteWarranty('');
                                            setQuoteOrigin('');
                                            setOriginalPrice('');
                                            setQuoteToConfirm(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Interest Confirmation Modal - UPDATED with Mismatch Warnings */}
                    {showInterestModal && selectedOrderForInterest && (
                        <div className="fixed inset-0 z-[150] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Quote Review</h3>
                                <p className="text-xs text-slate-400 mb-4">Dear {selectedOrderForInterest.customer.name},</p>
                                
                                {/* Mismatch Warning */}
                                {(() => {
                                    const mismatches = detectQuoteMismatches(selectedOrderForInterest, {
                                        quoteOrigin: quoteOrigin,
                                        leadTime: quoteLeadTime,
                                        warranty: quoteWarranty
                                    });
                                    
                                    if (mismatches.length > 0) {
                                        return (
                                            <div className="mismatch-warning mb-4">
                                                <div className="flex items-center gap-2 mb-2">
                                                    <i className="fas fa-exclamation-triangle text-orange-600"></i>
                                                    <span className="font-black text-orange-800 text-xs">âš ï¸ SPECIFICATION CHANGES DETECTED</span>
                                                </div>
                                                <p className="text-[10px] text-orange-700 mb-2">
                                                    The admin has modified some specifications from your original request:
                                                </p>
                                                {mismatches.map((mismatch, idx) => (
                                                    <div key={idx} className="mismatch-item">
                                                        <i className="fas fa-arrow-right mismatch-icon"></i>
                                                        <span className="text-xs">
                                                            <span className="font-bold">{mismatch.field}:</span> You requested "{mismatch.requested}" â†’ Admin offered "{mismatch.offered}"
                                                        </span>
                                                    </div>
                                                ))}
                                            </div>
                                        );
                                    }
                                    return null;
                                })()}
                                
                                <div className="bg-slate-50 rounded-xl p-4 mb-6">
                                    <h4 className="font-bold text-sm text-brandDark mb-3">Quote Details:</h4>
                                    <div className="space-y-2 text-sm">
                                        <p>Subtotal: à§³{(parseFloat(quoteSubtotal) || 0).toLocaleString()}</p>
                                        <p>AIT (5%): à§³{(parseFloat(quoteAIT) || 0).toLocaleString()}</p>
                                        <p>VAT (10%): à§³{(parseFloat(quoteVAT) || 0).toLocaleString()}</p>
                                        <p className="font-bold text-brandBlue">Quoted Total: à§³{(parseFloat(quoteGrandTotal) || 0).toLocaleString()}</p>
                                        <p className="text-orange-600 font-bold">Lead Time: {quoteLeadTime}</p>
                                        {quoteWarranty && (
                                            <p className="text-green-600 font-bold">Warranty: {quoteWarranty}</p>
                                        )}
                                        {quoteOrigin && (
                                            <p className="text-purple-600 font-bold">Origin: {quoteOrigin}</p>
                                        )}
                                        {quoteWarranty && (
                                            <div className="mt-2 p-2 bg-green-50 rounded-lg">
                                                <p className="text-xs text-green-600 mt-1">{WARRANTY_TERMS[quoteWarranty]}</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <p className="text-sm text-center mb-6">
                                    Are you interested in proceeding with this quoted price, lead time and warranty?
                                </p>
                                
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => handleCustomerResponse('YES')}
                                        className="flex-1 bg-green-500 text-white py-3 rounded-xl font-bold text-sm hover:bg-green-600 transition-all"
                                    >
                                        YES, I Accept
                                    </button>
                                    <button
                                        onClick={() => handleCustomerResponse('NO')}
                                        className="flex-1 bg-red-500 text-white py-3 rounded-xl font-bold text-sm hover:bg-red-600 transition-all"
                                    >
                                        NO, Thanks
                                    </button>
                                </div>
                                <button
                                    onClick={() => {
                                        setShowInterestModal(false);
                                        setSelectedOrderForInterest(null);
                                        setQuoteSubtotal('');
                                        setQuoteAIT('');
                                        setQuoteVAT('');
                                        setQuoteGrandTotal('');
                                        setQuoteLeadTime('');
                                        setQuoteWarranty('');
                                        setQuoteOrigin('');
                                    }}
                                    className="w-full mt-3 text-slate-400 text-xs font-bold hover:text-slate-600 transition-colors"
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Decline Reason Modal */}
                    {showDeclineModal && (
                        <div className="fixed inset-0 z-[160] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Decline Reason</h3>
                                <p className="text-xs text-slate-400 mb-6">Please tell us why you're declining this quote</p>
                                
                                <textarea
                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-4 text-sm font-bold outline-none focus:border-brandBlue min-h-[120px]"
                                    placeholder="Enter your reason here..."
                                    value={declineReason}
                                    onChange={e => setDeclineReason(e.target.value)}
                                ></textarea>
                                
                                <div className="flex gap-4 mt-6">
                                    <button
                                        onClick={handleDeclineSubmit}
                                        disabled={!declineReason}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            declineReason 
                                                ? 'bg-red-500 text-white hover:bg-red-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Submit
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowDeclineModal(false);
                                            setDeclineReason('');
                                            setDeclineOrderId(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Transaction ID Modal */}
                    {showTrxModal && currentOrderForTrx && (
                        <div className="fixed inset-0 z-[170] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Submit Transaction ID</h3>
                                <p className="text-xs text-slate-400 mb-6">Please enter your payment transaction ID for order {currentOrderForTrx.id}</p>
                                
                                <div className="mb-4 p-3 bg-blue-50 rounded-lg text-xs">
                                    <p className="font-bold mb-1">Pay to:</p>
                                    <p>{COMPANY_INFO.bankDetails.accountName}</p>
                                    <p>A/C: {COMPANY_INFO.bankDetails.accountNumber}</p>
                                    <p>Bank: {COMPANY_INFO.bankDetails.bankName}</p>
                                    <p>Branch: {COMPANY_INFO.bankDetails.branch}</p>
                                    {currentOrderForTrx.payment?.method !== 'bank' && (
                                        <p className="mt-2">Mobile Banking: {COMPANY_INFO.bankDetails.mobileBanking}</p>
                                    )}
                                </div>
                                
                                <input
                                    type="text"
                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                    value={trxInput}
                                    onChange={e => setTrxInput(e.target.value)}
                                    placeholder="Enter transaction ID"
                                />
                                
                                <div className="flex gap-4 mt-6">
                                    <button
                                        onClick={submitTransactionId}
                                        disabled={!trxInput}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            trxInput 
                                                ? 'bg-brandBlue text-white hover:bg-blue-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Submit
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowTrxModal(false);
                                            setTrxInput('');
                                            setCurrentOrderForTrx(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Document Upload Modal (Customer) - UPDATED with Customer BIN */}
                    {showDocumentModal && currentOrderForDocs && (
                        <div className="fixed inset-0 z-[180] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8 max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Upload Documents</h3>
                                <p className="text-xs text-slate-400 mb-6">For order {currentOrderForDocs.id}</p>
                                
                                <div className="space-y-6">
                                    {/* Mushak-6.6 */}
                                    <div>
                                        <label className="upload-label">MUSHAK-6.6 *</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'mushak6_6')}
                                                className="hidden"
                                                id="mushak-upload"
                                            />
                                            <label htmlFor="mushak-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload or drag and drop</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {mushak6_6File && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-red-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{mushak6_6File.name}</span>
                                                    <span className="file-size ml-2">({mushak6_6File.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>

                                    {/* VDS */}
                                    <div>
                                        <label className="upload-label">VDS CHALLAN *</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'vds')}
                                                className="hidden"
                                                id="vds-upload"
                                            />
                                            <label htmlFor="vds-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload or drag and drop</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {vdsFile && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-blue-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{vdsFile.name}</span>
                                                    <span className="file-size ml-2">({vdsFile.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>

                                    {/* TDS */}
                                    <div>
                                        <label className="upload-label">TDS CHALLAN *</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'tds')}
                                                className="hidden"
                                                id="tds-upload"
                                            />
                                            <label htmlFor="tds-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload or drag and drop</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {tdsFile && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-green-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{tdsFile.name}</span>
                                                    <span className="file-size ml-2">({tdsFile.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>

                                    {/* Customer BIN */}
                                    <div>
                                        <label className="upload-label">BIN CERTIFICATE (Customer)</label>
                                        <div className="document-upload">
                                            <input
                                                type="file"
                                                accept=".jpg,.jpeg,.png,.pdf"
                                                onChange={(e) => handleFileUpload(e, 'customer_bin')}
                                                className="hidden"
                                                id="customer-bin-upload"
                                            />
                                            <label htmlFor="customer-bin-upload" className="cursor-pointer">
                                                <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                <p className="text-xs">Click to upload BIN</p>
                                                <p className="text-[8px] text-slate-400 mt-1">JPG, PNG, PDF (Max 5MB)</p>
                                            </label>
                                        </div>
                                        {customerBinFile && (
                                            <div className="document-file mt-2">
                                                <i className="fas fa-file-pdf text-orange-500"></i>
                                                <div className="flex-grow">
                                                    <span className="file-name">{customerBinFile.name}</span>
                                                    <span className="file-size ml-2">({customerBinFile.size})</span>
                                                </div>
                                                <i className="fas fa-check-circle text-green-500"></i>
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button
                                        onClick={submitDocuments}
                                        disabled={!mushak6_6File || !vdsFile || !tdsFile}
                                        className={`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${
                                            mushak6_6File && vdsFile && tdsFile
                                                ? 'bg-brandBlue text-white hover:bg-blue-600' 
                                                : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                        }`}
                                    >
                                        Submit Documents
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowDocumentModal(false);
                                            setMushak6_6File(null);
                                            setVdsFile(null);
                                            setTdsFile(null);
                                            setCustomerBinFile(null);
                                            setCurrentOrderForDocs(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Review Modal */}
                    {showReviewModal && orderToReview && (
                        <div className="fixed inset-0 z-[190] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8">
                                <h3 className="text-xl font-black text-brandDark uppercase mb-2">Write a Review</h3>
                                <p className="text-xs text-slate-400 mb-6">Share your experience with this product</p>
                                
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Rating</label>
                                        <div className="flex gap-2 text-2xl">
                                            {[1,2,3,4,5].map(star => (
                                                <button
                                                    key={star}
                                                    type="button"
                                                    onClick={() => setReviewRating(star)}
                                                    className={`focus:outline-none transition-colors ${
                                                        star <= reviewRating ? 'text-yellow-400' : 'text-gray-300'
                                                    }`}
                                                >
                                                    â˜…
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Your Review</label>
                                        <textarea
                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue min-h-[100px]"
                                            placeholder="Write your review here..."
                                            value={reviewComment}
                                            onChange={e => setReviewComment(e.target.value)}
                                        ></textarea>
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button
                                        onClick={submitReview}
                                        className="flex-1 bg-brandBlue text-white py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                    >
                                        Submit Review
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowReviewModal(false);
                                            setReviewRating(5);
                                            setReviewComment('');
                                            setOrderToReview(null);
                                        }}
                                        className="flex-1 bg-slate-100 text-slate-600 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* MAIN CONTENT */}
                    <main className="flex-grow relative">
                        {/* ORDER/QUOTE MODAL */}
                        {isOrderModalOpen && (
                            <div className="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                                <div className="bg-white rounded-[2rem] max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl relative">
                                    <div className="sticky top-0 bg-white p-6 border-b border-slate-100 flex justify-between items-center z-10">
                                        <div>
                                            <h3 className="text-xl font-black text-brandDark uppercase">
                                                {selectedProductForQuote ? 'Request Quote' : 'Checkout'}
                                            </h3>
                                            {selectedProductForQuote && (
                                                <p className="text-xs text-slate-400 mt-1 line-clamp-1">
                                                    {selectedProductForQuote.name}
                                                </p>
                                            )}
                                        </div>
                                        <button 
                                            onClick={() => setIsOrderModalOpen(false)} 
                                            className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-red-50 hover:text-red-500 transition-colors"
                                        >
                                            <i className="fas fa-times"></i>
                                        </button>
                                    </div>
                                    
                                    <div className="p-8">
                                        <form onSubmit={submitOrder} className="space-y-6">
                                            {/* Customer Info */}
                                            <div className="space-y-4">
                                                <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Full Name *</label>
                                                        <input 
                                                            required 
                                                            type="text" 
                                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue focus:ring-1 focus:ring-brandBlue transition-all" 
                                                            value={customerForm.name} 
                                                            onChange={e => setCustomerForm({...customerForm, name: e.target.value})} 
                                                            placeholder="Your full name"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Phone *</label>
                                                        <input 
                                                            required 
                                                            type="tel" 
                                                            className={`w-full bg-slate-50 border ${
                                                                customerForm.phone && !validatePhoneNumber(customerForm.phone) 
                                                                    ? 'border-red-300 focus:border-red-500' 
                                                                    : 'border-slate-200 focus:border-brandBlue'
                                                            } rounded-xl p-3 text-sm font-bold outline-none transition-all`}
                                                            value={customerForm.phone} 
                                                            onChange={e => {
                                                                const value = e.target.value.replace(/\D/g, '').slice(0, 11);
                                                                setCustomerForm({...customerForm, phone: value});
                                                            }} 
                                                            placeholder="01XXXXXXXXX"
                                                        />
                                                        {customerForm.phone && !validatePhoneNumber(customerForm.phone) && (
                                                            <p className="text-red-500 text-[9px] font-bold mt-1">Enter valid 11-digit number starting with 0</p>
                                                        )}
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Road / Village *</label>
                                                    <input 
                                                        required 
                                                        type="text" 
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue focus:ring-1 focus:ring-brandBlue transition-all" 
                                                        value={customerForm.road} 
                                                        onChange={e => setCustomerForm({...customerForm, road: e.target.value})} 
                                                        placeholder="Road No, Village, House No"
                                                    />
                                                </div>
                                                
                                                <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Thana *</label>
                                                        <input 
                                                            required 
                                                            type="text" 
                                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue focus:ring-1 focus:ring-brandBlue transition-all" 
                                                            value={customerForm.thana} 
                                                            onChange={e => setCustomerForm({...customerForm, thana: e.target.value})} 
                                                            placeholder="Thana"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">City *</label>
                                                        <input 
                                                            required 
                                                            type="text" 
                                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue focus:ring-1 focus:ring-brandBlue transition-all" 
                                                            value={customerForm.city} 
                                                            onChange={e => setCustomerForm({...customerForm, city: e.target.value})} 
                                                            placeholder="City"
                                                        />
                                                    </div>
                                                </div>

                                                {/* Payment Method Section */}
                                                <div className="space-y-3">
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Payment Method *</label>
                                                    <div className="grid grid-cols-2 gap-2">
                                                        {['cod', 'bkash', 'nagad', 'rocket', 'bank'].map(method => (
                                                            <button
                                                                key={method}
                                                                type="button"
                                                                onClick={() => setPaymentMethod(method)}
                                                                className={`p-2 rounded-lg text-[10px] font-black uppercase border-2 transition-all ${
                                                                    paymentMethod === method
                                                                        ? 'border-brandBlue bg-blue-50 text-brandBlue'
                                                                        : 'border-transparent bg-white text-slate-500 hover:border-slate-200'
                                                                }`}
                                                            >
                                                                {method.toUpperCase()}
                                                            </button>
                                                        ))}
                                                    </div>
                                                    
                                                    <div className="payment-notification">
                                                        <i className="fas fa-info-circle mr-1"></i>
                                                        {PAYMENT_NOTIFICATIONS[paymentMethod]}
                                                        {paymentMethod === 'bank' && (
                                                            <div className="mt-2 text-xs">
                                                                <p className="font-bold">Pay to:</p>
                                                                <p>{COMPANY_INFO.bankDetails.accountName}</p>
                                                                <p>A/C: {COMPANY_INFO.bankDetails.accountNumber}</p>
                                                                <p>Bank: {COMPANY_INFO.bankDetails.bankName}</p>
                                                                <p>Branch: {COMPANY_INFO.bankDetails.branch}</p>
                                                            </div>
                                                        )}
                                                        {paymentMethod !== 'cod' && paymentMethod !== 'bank' && (
                                                            <div className="mt-2 text-xs">
                                                                <p>Pay to: {COMPANY_INFO.bankDetails.mobileBanking} ({paymentMethod.toUpperCase()})</p>
                                                            </div>
                                                        )}
                                                    </div>

                                                    {paymentMethod !== 'cod' && (
                                                        <div className="mt-3">
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Transaction ID (Optional)</label>
                                                            <input
                                                                type="text"
                                                                className="w-full bg-white border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={trxId}
                                                                onChange={e => setTrxId(e.target.value)}
                                                                placeholder="Enter transaction ID if already paid"
                                                            />
                                                            <p className="text-[9px] text-slate-400 mt-1">You can submit transaction ID now or later during processing</p>
                                                        </div>
                                                    )}
                                                </div>

                                                {/* Origin, Condition, Lead Time and Warranty for Quotes */}
                                                {selectedProductForQuote && (
                                                    <div className="space-y-4">
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Required Origin</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={customerForm.origin}
                                                                onChange={e => setCustomerForm({...customerForm, origin: e.target.value})}
                                                            >
                                                                <option value="">Select Origin</option>
                                                                {originOptions.map(origin => (
                                                                    <option key={origin} value={origin}>{origin}</option>
                                                                ))}
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Product Condition</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={customerForm.condition}
                                                                onChange={e => setCustomerForm({...customerForm, condition: e.target.value})}
                                                            >
                                                                <option value="">Select Condition</option>
                                                                {CONDITION_OPTIONS.map(condition => (
                                                                    <option key={condition} value={condition}>{condition}</option>
                                                                ))}
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Preferred Lead Time</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={customerForm.leadTime}
                                                                onChange={e => setCustomerForm({...customerForm, leadTime: e.target.value})}
                                                            >
                                                                <option value="">Select Lead Time</option>
                                                                {LEAD_TIME_OPTIONS.map(time => (
                                                                    <option key={time} value={time}>{time}</option>
                                                                ))}
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Warranty</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={customerForm.warranty}
                                                                onChange={e => setCustomerForm({...customerForm, warranty: e.target.value})}
                                                            >
                                                                <option value="">Select Warranty</option>
                                                                {WARRANTY_OPTIONS.map(warranty => (
                                                                    <option key={warranty} value={warranty}>{warranty}</option>
                                                                ))}
                                                            </select>
                                                            {customerForm.warranty && (
                                                                <div className="mt-2 p-2 bg-green-50 rounded-lg text-xs text-green-700">
                                                                    <i className="fas fa-shield-alt mr-1"></i>
                                                                    {WARRANTY_TERMS[customerForm.warranty]}
                                                                </div>
                                                            )}
                                                        </div>
                                                        
                                                        {/* NEW: Additional Quote Fields */}
                                                        <div className="quote-extra-field">
                                                            <h4 className="text-xs font-black text-brandOrange mb-3">Additional Information</h4>
                                                            
                                                            <div className="space-y-3">
                                                                <div>
                                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">PR Number (Optional)</label>
                                                                    <input
                                                                        type="text"
                                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                        value={customerForm.prNumber || ''}
                                                                        onChange={e => setCustomerForm({...customerForm, prNumber: e.target.value})}
                                                                        placeholder="e.g., PR-2025-001"
                                                                    />
                                                                </div>
                                                                
                                                                <div>
                                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Product Serial Numbers (Optional)</label>
                                                                    <textarea
                                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                        rows="2"
                                                                        value={customerForm.productSerialNumbers || ''}
                                                                        onChange={e => setCustomerForm({...customerForm, productSerialNumbers: e.target.value})}
                                                                        placeholder="Enter serial numbers separated by commas"
                                                                    />
                                                                </div>
                                                                
                                                                <div>
                                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Upload PR File</label>
                                                                    <div className="document-upload">
                                                                        <input
                                                                            type="file"
                                                                            accept=".pdf,.jpg,.jpeg,.png"
                                                                            onChange={handlePrFileUpload}
                                                                            className="hidden"
                                                                            id="pr-file-upload"
                                                                        />
                                                                        <label htmlFor="pr-file-upload" className="cursor-pointer block">
                                                                            <i className="fas fa-cloud-upload-alt text-2xl text-brandBlue mb-2"></i>
                                                                            <p className="text-xs">Click to upload PR file</p>
                                                                        </label>
                                                                    </div>
                                                                    {customerForm.prFile && (
                                                                        <div className="document-file mt-2">
                                                                            <i className="fas fa-file-pdf text-purple-500"></i>
                                                                            <span className="text-xs truncate">{customerForm.prFile.name}</span>
                                                                        </div>
                                                                    )}
                                                                </div>
                                                                
                                                                <div>
                                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Upload Product Pictures (Max 3)</label>
                                                                    <div className="flex flex-wrap">
                                                                        <div className="product-image-upload">
                                                                            <input
                                                                                type="file"
                                                                                accept="image/*"
                                                                                multiple
                                                                                onChange={handleProductPictureUpload}
                                                                                className="hidden"
                                                                                id="product-pictures-upload"
                                                                            />
                                                                            <label htmlFor="product-pictures-upload" className="cursor-pointer">
                                                                                <i className="fas fa-plus text-2xl text-slate-400"></i>
                                                                            </label>
                                                                        </div>
                                                                        {customerForm.productPictures.map((pic, idx) => (
                                                                            <div key={idx} className="product-image-upload relative">
                                                                                <img src={pic.data} alt={`Product ${idx+1}`} className="w-full h-full object-cover" />
                                                                                <button
                                                                                    type="button"
                                                                                    onClick={() => removeProductPicture(idx)}
                                                                                    className="absolute top-0 right-0 w-4 h-4 bg-red-500 text-white rounded-full text-xs"
                                                                                >
                                                                                    Ã—
                                                                                </button>
                                                                            </div>
                                                                        ))}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Required Delivery Time</label>
                                                            <input
                                                                type="text"
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={customerForm.deliveryTime}
                                                                onChange={e => setCustomerForm({...customerForm, deliveryTime: e.target.value})}
                                                                placeholder="e.g., Urgent, Within 2 weeks"
                                                            />
                                                        </div>
                                                    </div>
                                                )}

                                                {/* Price Breakdown for Orders */}
                                                {!selectedProductForQuote && (
                                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                                        <h5 className="text-xs font-black uppercase text-slate-400 mb-3">Price Breakdown</h5>
                                                        <div className="space-y-2">
                                                            <div className="flex justify-between text-sm">
                                                                <span className="text-slate-500">Subtotal:</span>
                                                                <span className="font-bold">à§³{cartTotals.subtotal.toLocaleString()}</span>
                                                            </div>
                                                            {paymentMethod !== 'cod' && (
                                                                <>
                                                                    <div className="flex justify-between text-sm">
                                                                        <span className="text-slate-500">AIT (5%):</span>
                                                                        <span className="font-bold text-brandBlue">+ à§³{cartTotals.ait.toLocaleString()}</span>
                                                                    </div>
                                                                    <div className="flex justify-between text-sm font-black text-brandDark pt-1">
                                                                        <span>TOTAL after AIT:</span>
                                                                        <span>à§³{cartTotals.totalWithAit.toLocaleString()}</span>
                                                                    </div>
                                                                    <div className="flex justify-between text-sm">
                                                                        <span className="text-slate-500">VAT (10% on Total):</span>
                                                                        <span className="font-bold text-orange-500">+ à§³{cartTotals.vat.toLocaleString()}</span>
                                                                    </div>
                                                                </>
                                                            )}
                                                            <div className="flex justify-between text-lg font-black text-brandDark pt-2 border-t border-slate-200 mt-2">
                                                                <span>{paymentMethod === 'cod' ? 'Net Price' : 'GRAND TOTAL'}:</span>
                                                                <span className="text-brandOrange">à§³{paymentMethod === 'cod' ? cartTotals.subtotal.toLocaleString() : cartTotals.grandTotal.toLocaleString()}</span>
                                                            </div>
                                                            {paymentMethod === 'cod' && (
                                                                <p className="text-[9px] text-green-600 mt-1">âœ“ No AIT/VAT applicable for Cash on Delivery</p>
                                                            )}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                            
                                            <button 
                                                type="submit" 
                                                className={`w-full py-4 rounded-xl font-black text-sm uppercase tracking-widest text-white shadow-xl transition-all hover:-translate-y-1 ${
                                                    !selectedProductForQuote 
                                                        ? 'bg-brandDark hover:bg-brandBlue' 
                                                        : 'bg-brandOrange hover:bg-orange-600'
                                                }`}
                                            >
                                                {!selectedProductForQuote ? 'Confirm Order' : 'Request Quote'}
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        )}

                        {isAdminMode ? (
                            <div className="p-8 max-w-7xl mx-auto animate-fadeIn">
                                {/* ADMIN TABS */}
                                <div className="flex gap-2 mb-8 border-b border-slate-200 pb-1 overflow-x-auto">
                                    {['orders', 'products', 'brands', 'origins', 'certificates', 'qrcodes', 'settings'].map(tab => (
                                        <button 
                                            key={tab} 
                                            onClick={() => { 
                                                setAdminTab(tab); 
                                                setAdminView('list'); 
                                            }} 
                                            className={`px-6 py-3 font-bold uppercase text-xs tracking-widest border-b-2 transition-all whitespace-nowrap ${
                                                adminTab === tab 
                                                    ? tab === 'orders' ? 'border-brandBlue text-brandBlue' :
                                                      tab === 'products' ? 'border-brandBlue text-brandBlue' :
                                                      tab === 'brands' ? 'border-brandOrange text-brandOrange' :
                                                      tab === 'origins' ? 'border-green-500 text-green-600' :
                                                      tab === 'certificates' ? 'border-purple-500 text-purple-600' :
                                                      tab === 'qrcodes' ? 'border-wechat text-wechat' :
                                                      'border-brandDark text-brandDark'
                                                    : 'border-transparent text-slate-400 hover:text-slate-600'
                                            }`}
                                        >
                                            {tab === 'orders' && <><i className="fas fa-shopping-bag mr-2"></i>Order Bank</>}
                                            {tab === 'products' && <><i className="fas fa-box mr-2"></i>Products</>}
                                            {tab === 'brands' && <><i className="fas fa-trademark mr-2"></i>Brands</>}
                                            {tab === 'origins' && <><i className="fas fa-globe mr-2"></i>Origins</>}
                                            {tab === 'certificates' && <><i className="fas fa-certificate mr-2"></i>Certificates</>}
                                            {tab === 'qrcodes' && <><i className="fas fa-qrcode mr-2"></i>QR Codes</>}
                                            {tab === 'settings' && <><i className="fas fa-cog mr-2"></i>Settings</>}
                                        </button>
                                    ))}
                                </div>

                                {/* ORDER MANAGEMENT - UPDATED with Done status */}
                                {adminTab === 'orders' && (
                                    <div className="space-y-6">
                                        <div className="flex justify-between items-center">
                                            <h2 className="text-3xl font-black text-brandDark uppercase">Order Bank</h2>
                                            <div className="bg-slate-100 px-4 py-2 rounded-full text-sm font-bold">
                                                Total: {orders.length}
                                            </div>
                                        </div>
                                        
                                        <div className="bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden">
                                            {orders.length === 0 ? (
                                                <div className="p-16 text-center">
                                                    <i className="fas fa-box-open text-6xl text-slate-200 mb-4"></i>
                                                    <p className="text-slate-400 font-bold uppercase tracking-widest">No Orders Yet</p>
                                                </div>
                                            ) : (
                                                <div className="overflow-x-auto">
                                                    <table className="w-full text-left">
                                                        <thead className="bg-slate-50 text-[10px] font-black text-slate-400 uppercase tracking-widest border-b">
                                                            <tr>
                                                                <th className="p-6">Order Info</th>
                                                                <th className="p-6">Customer</th>
                                                                <th className="p-6">Items</th>
                                                                <th className="p-6">Payment</th>
                                                                <th className="p-6">Total</th>
                                                                <th className="p-6">Status</th>
                                                                <th className="p-6">Documents</th>
                                                                <th className="p-6">Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody className="divide-y">
                                                            {orders.map(order => {
                                                                const canApprove = order.payment?.trxId;
                                                                const hasDocuments = order.documents && (order.documents.mushak6_3 || order.documents.bin_certificate || order.documents.mushak6_6 || order.documents.vds || order.documents.tds || order.documents.customer_bin);
                                                                
                                                                return (
                                                                    <tr key={order.id} className="hover:bg-slate-50 transition-colors">
                                                                        <td className="p-6 align-top">
                                                                            <span className="block font-bold text-sm text-brandBlue">{order.id}</span>
                                                                            <span className="text-xs text-slate-400">{order.date}</span>
                                                                            <span className={`mt-2 block px-2 py-1 rounded text-[9px] font-black uppercase w-fit ${
                                                                                order.type === 'order' 
                                                                                    ? 'bg-green-100 text-green-600' 
                                                                                    : 'bg-orange-100 text-orange-600'
                                                                            }`}>
                                                                                {order.type}
                                                                            </span>
                                                                            {order.hideFromCustomer && (
                                                                                <span className="mt-1 block px-1 py-0.5 bg-purple-100 text-purple-600 rounded text-[8px] font-bold">
                                                                                    Hidden from Customer
                                                                                </span>
                                                                            )}
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            <div className="text-sm font-bold text-slate-800">{order.customer.name}</div>
                                                                            <div className="text-xs text-slate-500">{formatPhoneNumber(order.customer.phone)}</div>
                                                                            <div className="text-xs text-slate-400 mt-1 line-clamp-2">
                                                                                {order.customer.road}, {order.customer.thana}, {order.customer.city}
                                                                            </div>
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            <button
                                                                                onClick={() => setSelectedOrderForDetails(order)}
                                                                                className="text-brandBlue hover:underline text-xs font-bold flex items-center gap-1"
                                                                            >
                                                                                <i className="fas fa-eye"></i> View Products ({order.items.length})
                                                                            </button>
                                                                            {order.warranty && (
                                                                                <div className="mt-1 text-[8px] text-green-600">
                                                                                    Warranty: {order.warranty}
                                                                                </div>
                                                                            )}
                                                                            {order.type === 'quote' && (order.origin || order.condition || order.leadTime) && (
                                                                                <div className="mt-1 text-[8px] text-slate-400">
                                                                                    {order.origin && <div>Origin: {order.origin}</div>}
                                                                                    {order.condition && <div>Condition: {order.condition}</div>}
                                                                                    {order.leadTime && <div>Req. Lead Time: {order.leadTime}</div>}
                                                                                </div>
                                                                            )}
                                                                            {order.prNumber && (
                                                                                <div className="mt-1 text-[8px] text-blue-600">PR: {order.prNumber}</div>
                                                                            )}
                                                                            {order.quoteDetails && (
                                                                                <div className="mt-1 text-[8px] text-green-600">
                                                                                    Quoted: à§³{order.quoteDetails.price.toLocaleString()}
                                                                                </div>
                                                                            )}
                                                                            {order.quoteMismatches && order.quoteMismatches.length > 0 && (
                                                                                <div className="mt-1 text-[8px] text-orange-500 font-bold">
                                                                                    âš ï¸ {order.quoteMismatches.length} Mismatch(es)
                                                                                </div>
                                                                            )}
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            <div className="text-xs font-bold uppercase">{order.payment?.method || 'N/A'}</div>
                                                                            {order.payment?.trxId && order.payment.trxId !== 'N/A' && (
                                                                                <div className="mt-1">
                                                                                    <span className={order.payment.trxApproved ? 'transaction-id-green' : 'transaction-id-yellow'}>
                                                                                        TXN: {order.payment.trxId}
                                                                                        {order.payment.trxApproved ? ' âœ“' : ''}
                                                                                    </span>
                                                                                </div>
                                                                            )}
                                                                        </td>
                                                                        <td className="p-6 align-top font-bold text-sm">
                                                                            {order.type === 'order' && order.totals 
                                                                                ? (order.payment?.method === 'cod' 
                                                                                    ? `à§³${order.totals.subtotal.toLocaleString()}` 
                                                                                    : `à§³${order.totals.grandTotal.toLocaleString()}`)
                                                                                : order.quoteDetails 
                                                                                    ? `à§³${order.quoteDetails.price.toLocaleString()}`
                                                                                    : order.quotedPrice
                                                                                        ? `à§³${order.quotedPrice.toLocaleString()}`
                                                                                        : '-'
                                                                            }
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            <div className="space-y-2">
                                                                                <select 
                                                                                    value={order.status} 
                                                                                    onChange={(e) => updateOrderStatus(order.id, e.target.value)}
                                                                                    className={`text-xs font-bold uppercase p-2 rounded-lg border-2 outline-none transition-all w-full ${
                                                                                        order.status === 'Approved' ? 'border-green-200 text-green-600 bg-green-50' :
                                                                                        order.status === 'Processing' ? 'border-blue-200 text-blue-600 bg-blue-50' :
                                                                                        order.status === 'Shipped' ? 'border-indigo-200 text-indigo-600 bg-indigo-50' :
                                                                                        order.status === 'Delivered' ? 'border-purple-200 text-purple-600 bg-purple-50' :
                                                                                        order.status === 'Done' ? 'border-gray-400 text-gray-600 bg-gray-50' :
                                                                                        order.status === 'Cancelled' ? 'border-red-200 text-red-600 bg-red-50' :
                                                                                        order.status === 'Hold' ? 'border-orange-200 text-orange-600 bg-orange-50' :
                                                                                        'border-slate-200 text-slate-600 bg-white'
                                                                                    }`}
                                                                                >
                                                                                    <option value="Pending">Pending</option>
                                                                                    <option value="Processing">Processing</option>
                                                                                    <option value="Hold">Hold</option>
                                                                                    <option value="Approved" disabled={order.type === 'order' && !canApprove}>Approved {!canApprove && '(Requires Trx ID)'}</option>
                                                                                    <option value="Shipped" disabled={order.type === 'order' && !canApprove}>Shipped {!canApprove && '(Requires Trx ID)'}</option>
                                                                                    <option value="Delivered" disabled={order.type === 'order' && !canApprove}>Delivered {!canApprove && '(Requires Trx ID)'}</option>
                                                                                    <option value="Done" disabled={order.status !== 'Delivered'}>Done (Complete/Close)</option>
                                                                                    <option value="Cancelled">Cancelled</option>
                                                                                </select>
                                                                                {order.statusMessage && (
                                                                                    <div className="relative group">
                                                                                        <i className="fas fa-info-circle text-slate-400 cursor-help"></i>
                                                                                        <div className="absolute left-0 bottom-6 hidden group-hover:block bg-brandDark text-white text-[10px] p-2 rounded-lg whitespace-normal max-w-xs z-10">
                                                                                            {order.statusMessage}
                                                                                        </div>
                                                                                    </div>
                                                                                )}
                                                                            </div>
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            {hasDocuments ? (
                                                                                <div className="space-y-1">
                                                                                    {order.documents.mushak6_3 && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.mushak6_3)}>
                                                                                            <i className="fas fa-file-pdf text-purple-500"></i>
                                                                                            Mushak-6.3 (Admin)
                                                                                        </div>
                                                                                    )}
                                                                                    {order.documents.bin_certificate && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.bin_certificate)}>
                                                                                            <i className="fas fa-file-pdf text-blue-500"></i>
                                                                                            BIN (Admin)
                                                                                        </div>
                                                                                    )}
                                                                                    {order.documents.mushak6_6 && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.mushak6_6)}>
                                                                                            <i className="fas fa-file-pdf text-red-500"></i>
                                                                                            Mushak-6.6 (Customer)
                                                                                        </div>
                                                                                    )}
                                                                                    {order.documents.customer_bin && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.customer_bin)}>
                                                                                            <i className="fas fa-file-pdf text-orange-500"></i>
                                                                                            BIN (Customer)
                                                                                        </div>
                                                                                    )}
                                                                                    {order.documents.vds && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.vds)}>
                                                                                            <i className="fas fa-file-pdf text-blue-500"></i>
                                                                                            VDS (Customer)
                                                                                        </div>
                                                                                    )}
                                                                                    {order.documents.tds && (
                                                                                        <div className="document-badge cursor-pointer" onClick={() => openDocumentViewer(order.documents.tds)}>
                                                                                            <i className="fas fa-file-pdf text-green-500"></i>
                                                                                            TDS (Customer)
                                                                                        </div>
                                                                                    )}
                                                                                </div>
                                                                            ) : (
                                                                                <span className="text-[8px] text-slate-400">No Documents</span>
                                                                            )}
                                                                        </td>
                                                                        <td className="p-6 align-top">
                                                                            <div className="flex gap-2">
                                                                                {order.type === 'quote' && order.status === 'Pending' && (
                                                                                    <button
                                                                                        onClick={() => confirmQuote(order)}
                                                                                        className="text-green-500 hover:text-green-600 transition-colors"
                                                                                        title="Send Quote"
                                                                                    >
                                                                                        <i className="fas fa-file-invoice-dollar"></i>
                                                                                    </button>
                                                                                )}
                                                                                {order.type === 'order' && order.status === 'Shipped' && (!order.documents?.mushak6_3 || !order.documents?.bin_certificate) && (
                                                                                    <button
                                                                                        onClick={() => {
                                                                                            setCurrentOrderForMushak63(order);
                                                                                            setShowMushak63Modal(true);
                                                                                        }}
                                                                                        className="text-purple-500 hover:text-purple-600 transition-colors"
                                                                                        title="Upload Mushak-6.3 / BIN"
                                                                                    >
                                                                                        <i className="fas fa-file-upload"></i>
                                                                                    </button>
                                                                                )}
                                                                                {order.payment?.trxId && !order.payment?.trxApproved && (
                                                                                    <button
                                                                                        onClick={() => approveTransaction(order.id)}
                                                                                        className="text-green-500 hover:text-green-600 transition-colors"
                                                                                        title="Approve Transaction"
                                                                                    >
                                                                                        <i className="fas fa-check-circle"></i>
                                                                                    </button>
                                                                                )}
                                                                                <button
                                                                                    onClick={() => setSelectedOrderForDetails(order)}
                                                                                    className="text-brandBlue hover:text-blue-600 transition-colors"
                                                                                    title="View Details"
                                                                                >
                                                                                    <i className="fas fa-eye"></i>
                                                                                </button>
                                                                                <button
                                                                                    onClick={() => deleteOrder(order.id)}
                                                                                    className="text-red-400 hover:text-red-600 transition-colors"
                                                                                    title="Delete Order"
                                                                                >
                                                                                    <i className="fas fa-trash"></i>
                                                                                </button>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                );
                                                            })}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}

                                {/* PRODUCT MANAGEMENT - MODIFIED with Brand Dropdown */}
                                {adminTab === 'products' && (
                                    <div className="space-y-6">
                                        <div className="flex justify-between items-center">
                                            <h2 className="text-3xl font-black text-brandDark uppercase">Products</h2>
                                            <button
                                                onClick={() => {
                                                    resetProductForm();
                                                    setAdminView('edit');
                                                }}
                                                className="bg-brandBlue text-white px-6 py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all shadow-lg flex items-center gap-2"
                                            >
                                                <i className="fas fa-plus"></i> Add Product
                                            </button>
                                        </div>

                                        {adminView === 'list' ? (
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                {products.map(product => (
                                                    <div key={product.id} className="bg-white rounded-2xl p-6 border border-slate-100 hover:shadow-xl transition-all">
                                                        <div className="aspect-square bg-slate-50 rounded-xl mb-4 p-4 flex items-center justify-center">
                                                            <img 
                                                                src={product.image} 
                                                                alt={product.name}
                                                                className="max-h-32 w-auto object-contain"
                                                                onError={(e) => {
                                                                    e.target.onerror = null;
                                                                    e.target.src = 'https://via.placeholder.com/128?text=Product';
                                                                }}
                                                            />
                                                        </div>
                                                        <h3 className="font-bold text-sm mb-2 line-clamp-2">{product.name}</h3>
                                                        <div className="flex justify-between items-center mb-3">
                                                            <span className="text-xs bg-slate-100 px-2 py-1 rounded font-bold">{product.brand}</span>
                                                            {product.origin && (
                                                                <span className="text-xs text-slate-400">{product.origin}</span>
                                                            )}
                                                        </div>
                                                        <div className="flex justify-between items-center mb-4">
                                                            {product.stockStatus === 'in-stock' ? (
                                                                <span className="text-lg font-black text-brandBlue">à§³{product.price.toLocaleString()}</span>
                                                            ) : (
                                                                <span className="text-xs font-bold text-orange-500">Price on Request</span>
                                                            )}
                                                            <div>
                                                                {STOCK_STATUS_OPTIONS.map(option => {
                                                                    if (option.value === product.stockStatus) {
                                                                        return (
                                                                            <span key={option.value} className={`text-[10px] font-black uppercase px-2 py-1 rounded ${option.color} text-white`}>
                                                                                {option.label}
                                                                            </span>
                                                                        );
                                                                    }
                                                                    return null;
                                                                })}
                                                                {product.leadTime && (
                                                                    <span className="block text-[8px] text-slate-400 mt-1">{product.leadTime}</span>
                                                                )}
                                                            </div>
                                                        </div>
                                                        
                                                        {/* Datasheet Link */}
                                                        {product.datasheet && (
                                                            <div className="mb-3">
                                                                <a 
                                                                    href={product.datasheet} 
                                                                    target="_blank" 
                                                                    rel="noopener noreferrer"
                                                                    className="text-[8px] text-brandBlue hover:underline flex items-center gap-1"
                                                                >
                                                                    <i className="fas fa-file-pdf"></i>
                                                                    View Datasheet
                                                                </a>
                                                            </div>
                                                        )}
                                                        
                                                        <div className="flex gap-2">
                                                            <button
                                                                onClick={() => initEditProduct(product)}
                                                                className="flex-1 bg-slate-100 text-slate-600 py-2 rounded-lg font-bold text-xs hover:bg-slate-200 transition-colors"
                                                            >
                                                                Edit
                                                            </button>
                                                            <button
                                                                onClick={() => deleteProduct(product.id)}
                                                                className="flex-1 bg-red-50 text-red-500 py-2 rounded-lg font-bold text-xs hover:bg-red-100 transition-colors"
                                                            >
                                                                Delete
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : (
                                            <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                                <h3 className="text-xl font-black text-brandDark mb-6">
                                                    {editingId ? 'Edit Product' : 'Add New Product'}
                                                </h3>
                                                <form onSubmit={saveProduct} className="space-y-6">
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Product Name *</label>
                                                            <input
                                                                type="text"
                                                                required
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.name}
                                                                onChange={e => setProductForm({...productForm, name: e.target.value})}
                                                            />
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Brand *</label>
                                                            <select
                                                                required
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.brand}
                                                                onChange={e => setProductForm({...productForm, brand: e.target.value})}
                                                            >
                                                                <option value="">Select Brand</option>
                                                                {brands.map(brand => (
                                                                    <option key={brand.id} value={brand.name}>{brand.name}</option>
                                                                ))}
                                                                <option value="Other">Other (Type below)</option>
                                                            </select>
                                                            {productForm.brand === 'Other' && (
                                                                <input
                                                                    type="text"
                                                                    placeholder="Enter brand name"
                                                                    className="w-full mt-2 bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    value={productForm.customBrand || ''}
                                                                    onChange={e => setProductForm({...productForm, customBrand: e.target.value, brand: e.target.value})}
                                                                />
                                                            )}
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Origin</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.origin}
                                                                onChange={e => setProductForm({...productForm, origin: e.target.value})}
                                                            >
                                                                <option value="">Select Origin</option>
                                                                {originOptions.map(origin => (
                                                                    <option key={origin} value={origin}>{origin}</option>
                                                                ))}
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Category *</label>
                                                            <input
                                                                type="text"
                                                                required
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.category}
                                                                onChange={e => setProductForm({...productForm, category: e.target.value})}
                                                            />
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Price (à§³) {productForm.stockStatus === 'in-stock' ? '*' : ''}</label>
                                                            <input
                                                                type="number"
                                                                min="0"
                                                                step="0.01"
                                                                required={productForm.stockStatus === 'in-stock'}
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.price}
                                                                onChange={e => setProductForm({...productForm, price: parseFloat(e.target.value) || 0})}
                                                            />
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Stock Status *</label>
                                                            <select
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                value={productForm.stockStatus}
                                                                onChange={e => setProductForm({...productForm, stockStatus: e.target.value})}
                                                            >
                                                                {STOCK_STATUS_OPTIONS.map(option => (
                                                                    <option key={option.value} value={option.value}>{option.label}</option>
                                                                ))}
                                                            </select>
                                                        </div>
                                                        {(productForm.stockStatus === '7-15-days' || productForm.stockStatus === '15-30-days' || productForm.stockStatus === '30-45-days' || productForm.stockStatus === 'pre-order') && (
                                                            <div>
                                                                <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Lead Time *</label>
                                                                <select
                                                                    required
                                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    value={productForm.leadTime}
                                                                    onChange={e => setProductForm({...productForm, leadTime: e.target.value})}
                                                                >
                                                                    <option value="">Select Lead Time</option>
                                                                    {LEAD_TIME_OPTIONS.map(time => (
                                                                        <option key={time} value={time}>{time}</option>
                                                                    ))}
                                                                </select>
                                                            </div>
                                                        )}
                                                        <div className="md:col-span-2">
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Description</label>
                                                            <textarea
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                rows="3"
                                                                value={productForm.description}
                                                                onChange={e => setProductForm({...productForm, description: e.target.value})}
                                                            ></textarea>
                                                        </div>
                                                        <div className="md:col-span-2">
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Product Image *</label>
                                                            <div className="flex gap-4 mb-4">
                                                                <label className="flex items-center gap-2">
                                                                    <input
                                                                        type="radio"
                                                                        name="imageType"
                                                                        checked={productForm.imageType === 'url'}
                                                                        onChange={() => setProductForm({...productForm, imageType: 'url'})}
                                                                    />
                                                                    <span className="text-sm">URL</span>
                                                                </label>
                                                                <label className="flex items-center gap-2">
                                                                    <input
                                                                        type="radio"
                                                                        name="imageType"
                                                                        checked={productForm.imageType === 'file'}
                                                                        onChange={() => setProductForm({...productForm, imageType: 'file'})}
                                                                    />
                                                                    <span className="text-sm">Upload File</span>
                                                                </label>
                                                            </div>
                                                            {productForm.imageType === 'url' ? (
                                                                <input
                                                                    type="url"
                                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    value={productForm.imageUrl}
                                                                    onChange={e => setProductForm({...productForm, imageUrl: e.target.value})}
                                                                    placeholder="https://example.com/image.jpg"
                                                                />
                                                            ) : (
                                                                <input
                                                                    type="file"
                                                                    accept="image/*"
                                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    onChange={e => handleFile(e.target.files[0], (data) => setProductForm({...productForm, imageData: data}))}
                                                                />
                                                            )}
                                                        </div>
                                                        <div className="md:col-span-2">
                                                            <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Datasheet PDF (Optional)</label>
                                                            <div className="flex gap-4 mb-4">
                                                                <label className="flex items-center gap-2">
                                                                    <input
                                                                        type="radio"
                                                                        name="datasheetType"
                                                                        checked={productForm.datasheetType === 'url'}
                                                                        onChange={() => setProductForm({...productForm, datasheetType: 'url'})}
                                                                    />
                                                                    <span className="text-sm">URL</span>
                                                                </label>
                                                                <label className="flex items-center gap-2">
                                                                    <input
                                                                        type="radio"
                                                                        name="datasheetType"
                                                                        checked={productForm.datasheetType === 'file'}
                                                                        onChange={() => setProductForm({...productForm, datasheetType: 'file'})}
                                                                    />
                                                                    <span className="text-sm">Upload File</span>
                                                                </label>
                                                            </div>
                                                            {productForm.datasheetType === 'url' ? (
                                                                <input
                                                                    type="url"
                                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    value={productForm.datasheetUrl}
                                                                    onChange={e => setProductForm({...productForm, datasheetUrl: e.target.value})}
                                                                    placeholder="https://example.com/datasheet.pdf"
                                                                />
                                                            ) : (
                                                                <input
                                                                    type="file"
                                                                    accept=".pdf"
                                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    onChange={e => handleFile(e.target.files[0], (data) => setProductForm({...productForm, datasheetData: data}))}
                                                                />
                                                            )}
                                                        </div>
                                                    </div>
                                                    <div className="flex gap-4">
                                                        <button
                                                            type="submit"
                                                            className="bg-brandBlue text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                                        >
                                                            {editingId ? 'Update Product' : 'Add Product'}
                                                        </button>
                                                        <button
                                                            type="button"
                                                            onClick={() => {
                                                                resetProductForm();
                                                                setAdminView('list');
                                                            }}
                                                            className="bg-slate-100 text-slate-600 px-8 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-all"
                                                        >
                                                            Cancel
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>
                                        )}
                                    </div>
                                )}

                                {/* BRANDS MANAGEMENT */}
                                {adminTab === 'brands' && (
                                    <div className="space-y-6">
                                        <div className="flex justify-between items-center">
                                            <h2 className="text-3xl font-black text-brandDark uppercase">Brands</h2>
                                            <button
                                                onClick={() => {
                                                    setBrandForm({ name: '', type: 'url', url: '', data: null });
                                                    setEditingBrandId(null);
                                                    setAdminView('editBrand');
                                                }}
                                                className="bg-brandOrange text-white px-6 py-3 rounded-xl font-bold text-sm hover:bg-orange-600 transition-all shadow-lg flex items-center gap-2"
                                            >
                                                <i className="fas fa-plus"></i> Add Brand
                                            </button>
                                        </div>

                                        {adminView === 'list' ? (
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
                                                {brands.map(brand => (
                                                    <div key={brand.id} className="bg-white rounded-2xl p-6 border border-slate-100 hover:shadow-xl transition-all text-center group">
                                                        <div className="h-20 flex items-center justify-center mb-4">
                                                            <img 
                                                                src={brand.logo} 
                                                                alt={brand.name}
                                                                className="max-h-full max-w-full object-contain"
                                                                onError={(e) => {
                                                                    e.target.onerror = null;
                                                                    e.target.src = 'https://via.placeholder.com/80?text=Logo';
                                                                }}
                                                            />
                                                        </div>
                                                        <h3 className="font-bold text-sm mb-4">{brand.name}</h3>
                                                        <div className="flex gap-2 justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                                            <button
                                                                onClick={() => initEditBrand(brand)}
                                                                className="text-brandBlue hover:text-blue-600 text-xs font-bold"
                                                            >
                                                                Edit
                                                            </button>
                                                            <span className="text-slate-300">|</span>
                                                            <button
                                                                onClick={() => deleteBrand(brand.id)}
                                                                className="text-red-400 hover:text-red-600 text-xs font-bold"
                                                            >
                                                                Delete
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : (
                                            <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                                <h3 className="text-xl font-black text-brandDark mb-6">
                                                    {editingBrandId ? 'Edit Brand' : 'Add New Brand'}
                                                </h3>
                                                <form onSubmit={saveBrand} className="space-y-6">
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Brand Name *</label>
                                                        <input
                                                            type="text"
                                                            required
                                                            className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                            value={brandForm.name}
                                                            onChange={e => setBrandForm({...brandForm, name: e.target.value})}
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Logo *</label>
                                                        <div className="flex gap-4 mb-4">
                                                            <label className="flex items-center gap-2">
                                                                <input
                                                                    type="radio"
                                                                    name="brandImageType"
                                                                    checked={brandForm.type === 'url'}
                                                                    onChange={() => setBrandForm({...brandForm, type: 'url'})}
                                                                />
                                                                <span className="text-sm">URL</span>
                                                            </label>
                                                            <label className="flex items-center gap-2">
                                                                <input
                                                                    type="radio"
                                                                    name="brandImageType"
                                                                    checked={brandForm.type === 'file'}
                                                                    onChange={() => setBrandForm({...brandForm, type: 'file'})}
                                                                />
                                                                <span className="text-sm">Upload File</span>
                                                            </label>
                                                        </div>
                                                        {brandForm.type === 'url' ? (
                                                            <input
                                                                type="url"
                                                                required
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                value={brandForm.url}
                                                                onChange={e => setBrandForm({...brandForm, url: e.target.value})}
                                                                placeholder="https://example.com/logo.svg"
                                                            />
                                                        ) : (
                                                            <input
                                                                type="file"
                                                                required
                                                                accept="image/*"
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandOrange"
                                                                onChange={e => handleFile(e.target.files[0], (data) => setBrandForm({...brandForm, data: data}))}
                                                            />
                                                        )}
                                                    </div>
                                                    <div className="flex gap-4">
                                                        <button
                                                            type="submit"
                                                            className="bg-brandOrange text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-orange-600 transition-all"
                                                        >
                                                            {editingBrandId ? 'Update Brand' : 'Add Brand'}
                                                        </button>
                                                        <button
                                                            type="button"
                                                            onClick={() => {
                                                                setBrandForm({ name: '', type: 'url', url: '', data: null });
                                                                setEditingBrandId(null);
                                                                setAdminView('list');
                                                            }}
                                                            className="bg-slate-100 text-slate-600 px-8 py-3 rounded-xl font-bold text-sm hover:bg-slate-200 transition-all"
                                                        >
                                                            Cancel
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>
                                        )}
                                    </div>
                                )}

                                {/* ORIGINS MANAGEMENT */}
                                {adminTab === 'origins' && (
                                    <div className="space-y-8">
                                        <h2 className="text-3xl font-black text-brandDark uppercase">Origin Options</h2>
                                        
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6">Manage Origin Countries</h3>
                                            
                                            <div className="flex gap-4 mb-6">
                                                <input
                                                    type="text"
                                                    className="flex-grow bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-green-500"
                                                    placeholder="Enter new origin (e.g., Vietnam, Thailand)"
                                                    value={newOrigin}
                                                    onChange={e => setNewOrigin(e.target.value)}
                                                />
                                                <button
                                                    onClick={addOrigin}
                                                    className="bg-green-500 text-white px-6 py-3 rounded-xl font-bold text-sm hover:bg-green-600 transition-all"
                                                >
                                                    Add Origin
                                                </button>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                {originOptions.map(origin => (
                                                    <div key={origin} className="bg-slate-50 rounded-xl p-4 flex items-center justify-between group">
                                                        <span className="text-sm font-bold">{origin}</span>
                                                        <button
                                                            onClick={() => removeOrigin(origin)}
                                                            className="text-red-400 opacity-0 group-hover:opacity-100 transition-opacity hover:text-red-600"
                                                        >
                                                            <i className="fas fa-times"></i>
                                                        </button>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* CERTIFICATES MANAGEMENT */}
                                {adminTab === 'certificates' && (
                                    <div className="space-y-8">
                                        <h2 className="text-3xl font-black text-brandDark uppercase">Certificates</h2>
                                        
                                        {/* Trade License */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6">Trade License</h3>
                                            <div className="space-y-4">
                                                {tradeLicenseFile ? (
                                                    <div className="space-y-4">
                                                        {tradeLicenseFile.type?.startsWith('image/') ? (
                                                            <img 
                                                                src={tradeLicenseFile.data} 
                                                                alt="Trade License"
                                                                className="certificate-preview cursor-pointer"
                                                                onClick={() => openDocumentViewer(tradeLicenseFile)}
                                                            />
                                                        ) : (
                                                            <div className="document-file max-w-xs cursor-pointer hover:bg-purple-50" onClick={() => openDocumentViewer(tradeLicenseFile)}>
                                                                <i className="fas fa-file-pdf text-purple-500 text-2xl"></i>
                                                                <div className="flex-grow">
                                                                    <div className="file-name">{tradeLicenseFile.name}</div>
                                                                    <div className="file-size">Size: {tradeLicenseFile.size}</div>
                                                                </div>
                                                                <i className="fas fa-eye text-purple-500"></i>
                                                            </div>
                                                        )}
                                                        <div className="flex gap-2">
                                                            <a 
                                                                href={tradeLicenseFile.data} 
                                                                download={tradeLicenseFile.name}
                                                                className="bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-green-600"
                                                            >
                                                                Download
                                                            </a>
                                                            <button
                                                                onClick={() => {
                                                                    const input = document.createElement('input');
                                                                    input.type = 'file';
                                                                    input.accept = '.jpg,.jpeg,.png,.pdf';
                                                                    input.onchange = (e) => handleFileUpload(e, 'trade');
                                                                    input.click();
                                                                }}
                                                                className="bg-brandBlue text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-blue-600"
                                                            >
                                                                Replace
                                                            </button>
                                                            <button
                                                                onClick={() => deleteCertificate('trade')}
                                                                className="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-red-600"
                                                            >
                                                                Delete
                                                            </button>
                                                        </div>
                                                    </div>
                                                ) : (
                                                    <div className="border-2 border-dashed border-slate-200 rounded-lg p-8 text-center">
                                                        <input
                                                            type="file"
                                                            accept=".jpg,.jpeg,.png,.pdf"
                                                            onChange={(e) => handleFileUpload(e, 'trade')}
                                                            className="hidden"
                                                            id="trade-license-upload"
                                                        />
                                                        <label htmlFor="trade-license-upload" className="cursor-pointer">
                                                            <i className="fas fa-cloud-upload-alt text-4xl text-brandBlue mb-2"></i>
                                                            <p className="text-sm font-bold">Click to upload Trade License</p>
                                                            <p className="text-xs text-slate-400 mt-1">PDF, JPEG, PNG (Max 5MB)</p>
                                                        </label>
                                                    </div>
                                                )}
                                            </div>
                                        </div>

                                        {/* BIN Certificate */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6">BIN Certificate</h3>
                                            <div className="space-y-4">
                                                {binCertificateFile ? (
                                                    <div className="space-y-4">
                                                        {binCertificateFile.type?.startsWith('image/') ? (
                                                            <img 
                                                                src={binCertificateFile.data} 
                                                                alt="BIN Certificate"
                                                                className="certificate-preview cursor-pointer"
                                                                onClick={() => openDocumentViewer(binCertificateFile)}
                                                            />
                                                        ) : (
                                                            <div className="document-file max-w-xs cursor-pointer hover:bg-purple-50" onClick={() => openDocumentViewer(binCertificateFile)}>
                                                                <i className="fas fa-file-pdf text-blue-500 text-2xl"></i>
                                                                <div className="flex-grow">
                                                                    <div className="file-name">{binCertificateFile.name}</div>
                                                                    <div className="file-size">Size: {binCertificateFile.size}</div>
                                                                </div>
                                                                <i className="fas fa-eye text-blue-500"></i>
                                                            </div>
                                                        )}
                                                        <div className="flex gap-2">
                                                            <a 
                                                                href={binCertificateFile.data} 
                                                                download={binCertificateFile.name}
                                                                className="bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-green-600"
                                                            >
                                                                Download
                                                            </a>
                                                            <button
                                                                onClick={() => {
                                                                    const input = document.createElement('input');
                                                                    input.type = 'file';
                                                                    input.accept = '.jpg,.jpeg,.png,.pdf';
                                                                    input.onchange = (e) => handleFileUpload(e, 'bin_certificate');
                                                                    input.click();
                                                                }}
                                                                className="bg-brandBlue text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-blue-600"
                                                            >
                                                                Replace
                                                            </button>
                                                            <button
                                                                onClick={() => deleteCertificate('bin')}
                                                                className="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-red-600"
                                                            >
                                                                Delete
                                                            </button>
                                                        </div>
                                                    </div>
                                                ) : (
                                                    <div className="border-2 border-dashed border-slate-200 rounded-lg p-8 text-center">
                                                        <input
                                                            type="file"
                                                            accept=".jpg,.jpeg,.png,.pdf"
                                                            onChange={(e) => handleFileUpload(e, 'bin_certificate')}
                                                            className="hidden"
                                                            id="bin-certificate-upload"
                                                        />
                                                        <label htmlFor="bin-certificate-upload" className="cursor-pointer">
                                                            <i className="fas fa-cloud-upload-alt text-4xl text-brandBlue mb-2"></i>
                                                            <p className="text-sm font-bold">Click to upload BIN Certificate</p>
                                                            <p className="text-xs text-slate-400 mt-1">PDF, JPEG, PNG (Max 5MB)</p>
                                                        </label>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* QR CODES MANAGEMENT */}
                                {adminTab === 'qrcodes' && (
                                    <div className="space-y-8">
                                        <h2 className="text-3xl font-black text-brandDark uppercase">QR Code Management</h2>
                                        
                                        {/* Facebook QR */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6 flex items-center gap-2">
                                                <i className="fab fa-facebook text-facebook"></i> Facebook QR Code
                                            </h3>
                                            <div className="space-y-4">
                                                <div className="flex items-center gap-8 mb-6">
                                                    {facebookQR && (
                                                        <div className="w-32 h-32 bg-slate-50 rounded-xl p-4 border border-slate-200 flex items-center justify-center">
                                                            <img 
                                                                src={facebookQR.data || facebookQR} 
                                                                alt="Facebook QR"
                                                                className="max-w-full max-h-full object-contain cursor-pointer"
                                                                onClick={() => openDocumentViewer(facebookQR)}
                                                            />
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                <div className="flex gap-4 mb-4">
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="fbQRType"
                                                            checked={qrForm.facebook.type === 'url'}
                                                            onChange={() => setQrForm({...qrForm, facebook: {...qrForm.facebook, type: 'url'}})}
                                                        />
                                                        <span className="text-sm">Generate from URL</span>
                                                    </label>
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="fbQRType"
                                                            checked={qrForm.facebook.type === 'file'}
                                                            onChange={() => setQrForm({...qrForm, facebook: {...qrForm.facebook, type: 'file'}})}
                                                        />
                                                        <span className="text-sm">Upload QR Image</span>
                                                    </label>
                                                </div>
                                                
                                                {qrForm.facebook.type === 'url' ? (
                                                    <input
                                                        type="url"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-facebook"
                                                        value={qrForm.facebook.url}
                                                        onChange={e => setQrForm({...qrForm, facebook: {...qrForm.facebook, url: e.target.value}})}
                                                        placeholder="Facebook Page URL"
                                                    />
                                                ) : (
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-facebook"
                                                        onChange={e => handleFile(e.target.files[0], (data) => setQrForm({...qrForm, facebook: {...qrForm.facebook, data: {name: e.target.files[0].name, data: data, type: 'image/png'}}}))}
                                                    />
                                                )}
                                                
                                                <div className="flex gap-4">
                                                    <button
                                                        onClick={() => saveQRCode('facebook')}
                                                        className="bg-facebook text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-blue-700 transition-all"
                                                    >
                                                        Save Facebook QR
                                                    </button>
                                                    {facebookQR && (
                                                        <button
                                                            onClick={() => deleteCertificate('facebook_qr')}
                                                            className="bg-red-500 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-red-600 transition-all"
                                                        >
                                                            Delete QR
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        </div>

                                        {/* Map QR */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6 flex items-center gap-2">
                                                <i className="fas fa-map-marker-alt text-green-600"></i> Map QR Code
                                            </h3>
                                            <div className="space-y-4">
                                                <div className="flex items-center gap-8 mb-6">
                                                    {mapQR && (
                                                        <div className="w-32 h-32 bg-slate-50 rounded-xl p-4 border border-slate-200 flex items-center justify-center">
                                                            <img 
                                                                src={mapQR.data || mapQR} 
                                                                alt="Map QR"
                                                                className="max-w-full max-h-full object-contain cursor-pointer"
                                                                onClick={() => openDocumentViewer(mapQR)}
                                                            />
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                <div className="flex gap-4 mb-4">
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="mapQRType"
                                                            checked={qrForm.map.type === 'url'}
                                                            onChange={() => setQrForm({...qrForm, map: {...qrForm.map, type: 'url'}})}
                                                        />
                                                        <span className="text-sm">Generate from URL</span>
                                                    </label>
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="mapQRType"
                                                            checked={qrForm.map.type === 'file'}
                                                            onChange={() => setQrForm({...qrForm, map: {...qrForm.map, type: 'file'}})}
                                                        />
                                                        <span className="text-sm">Upload QR Image</span>
                                                    </label>
                                                </div>
                                                
                                                {qrForm.map.type === 'url' ? (
                                                    <input
                                                        type="url"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-green-500"
                                                        value={qrForm.map.url}
                                                        onChange={e => setQrForm({...qrForm, map: {...qrForm.map, url: e.target.value}})}
                                                        placeholder="Google Maps Location URL"
                                                    />
                                                ) : (
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-green-500"
                                                        onChange={e => handleFile(e.target.files[0], (data) => setQrForm({...qrForm, map: {...qrForm.map, data: {name: e.target.files[0].name, data: data, type: 'image/png'}}}))}
                                                    />
                                                )}
                                                
                                                <div className="flex gap-4">
                                                    <button
                                                        onClick={() => saveQRCode('map')}
                                                        className="bg-green-600 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-green-700 transition-all"
                                                    >
                                                        Save Map QR
                                                    </button>
                                                    {mapQR && (
                                                        <button
                                                            onClick={() => deleteCertificate('map_qr')}
                                                            className="bg-red-500 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-red-600 transition-all"
                                                        >
                                                            Delete QR
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        </div>

                                        {/* WeChat QR */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6 flex items-center gap-2">
                                                <i className="fab fa-weixin text-wechat"></i> WeChat QR Code
                                            </h3>
                                            <div className="space-y-4">
                                                <div className="flex items-center gap-8 mb-6">
                                                    {wechatQR && (
                                                        <div className="w-32 h-32 bg-slate-50 rounded-xl p-4 border border-slate-200 flex items-center justify-center">
                                                            <img 
                                                                src={wechatQR.data || wechatQR} 
                                                                alt="WeChat QR"
                                                                className="max-w-full max-h-full object-contain cursor-pointer"
                                                                onClick={() => openDocumentViewer(wechatQR)}
                                                            />
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                <div className="flex gap-4 mb-4">
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="wechatQRType"
                                                            checked={qrForm.wechat.type === 'url'}
                                                            onChange={() => setQrForm({...qrForm, wechat: {...qrForm.wechat, type: 'url'}})}
                                                        />
                                                        <span className="text-sm">Generate from WeChat ID</span>
                                                    </label>
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="wechatQRType"
                                                            checked={qrForm.wechat.type === 'file'}
                                                            onChange={() => setQrForm({...qrForm, wechat: {...qrForm.wechat, type: 'file'}})}
                                                        />
                                                        <span className="text-sm">Upload QR Image</span>
                                                    </label>
                                                </div>
                                                
                                                {qrForm.wechat.type === 'url' ? (
                                                    <input
                                                        type="text"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-wechat"
                                                        value={qrForm.wechat.url}
                                                        onChange={e => setQrForm({...qrForm, wechat: {...qrForm.wechat, url: e.target.value}})}
                                                        placeholder="WeChat ID"
                                                    />
                                                ) : (
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-wechat"
                                                        onChange={e => handleFile(e.target.files[0], (data) => setQrForm({...qrForm, wechat: {...qrForm.wechat, data: {name: e.target.files[0].name, data: data, type: 'image/png'}}}))}
                                                    />
                                                )}
                                                
                                                <div className="flex gap-4">
                                                    <button
                                                        onClick={() => saveQRCode('wechat')}
                                                        className="bg-wechat text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-green-600 transition-all"
                                                    >
                                                        Save WeChat QR
                                                    </button>
                                                    {wechatQR && (
                                                        <button
                                                            onClick={() => deleteCertificate('wechat_qr')}
                                                            className="bg-red-500 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-red-600 transition-all"
                                                        >
                                                            Delete QR
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* SETTINGS */}
                                {adminTab === 'settings' && (
                                    <div className="space-y-8">
                                        <h2 className="text-3xl font-black text-brandDark uppercase">Settings</h2>
                                        
                                        {/* Logo Settings */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6">Company Logo</h3>
                                            <form onSubmit={saveLogo} className="space-y-6">
                                                <div className="flex items-center gap-8 mb-6">
                                                    <div className="w-32 h-32 bg-slate-50 rounded-xl p-4 border border-slate-200 flex items-center justify-center">
                                                        <img 
                                                            src={logo} 
                                                            alt="Current Logo"
                                                            className="max-w-full max-h-full object-contain"
                                                            onError={(e) => {
                                                                e.target.onerror = null;
                                                                e.target.src = DEFAULT_LOGO;
                                                            }}
                                                        />
                                                    </div>
                                                    <div className="text-sm text-slate-500">
                                                        Current Logo
                                                    </div>
                                                </div>
                                                
                                                <div className="flex gap-4 mb-4">
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="logoType"
                                                            checked={logoForm.type === 'url'}
                                                            onChange={() => setLogoForm({...logoForm, type: 'url'})}
                                                        />
                                                        <span className="text-sm">URL</span>
                                                    </label>
                                                    <label className="flex items-center gap-2">
                                                        <input
                                                            type="radio"
                                                            name="logoType"
                                                            checked={logoForm.type === 'file'}
                                                            onChange={() => setLogoForm({...logoForm, type: 'file'})}
                                                        />
                                                        <span className="text-sm">Upload File</span>
                                                    </label>
                                                </div>
                                                
                                                {logoForm.type === 'url' ? (
                                                    <input
                                                        type="url"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                        value={logoForm.url}
                                                        onChange={e => setLogoForm({...logoForm, url: e.target.value})}
                                                        placeholder="Logo URL"
                                                    />
                                                ) : (
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                        onChange={e => handleFile(e.target.files[0], (data) => setLogoForm({...logoForm, data: data}))}
                                                    />
                                                )}
                                                
                                                <button
                                                    type="submit"
                                                    className="bg-brandBlue text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                                >
                                                    Update Logo
                                                </button>
                                            </form>
                                        </div>

                                        {/* Hero Settings */}
                                        <div className="bg-white rounded-3xl p-8 border border-slate-100">
                                            <h3 className="text-xl font-black text-brandDark mb-6">Hero Slider Settings</h3>
                                            <form onSubmit={saveHeroConfig} className="space-y-6">
                                                <div>
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Slide Interval (seconds)</label>
                                                    <input
                                                        type="number"
                                                        min="1"
                                                        max="30"
                                                        className="w-full max-w-xs bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                        value={heroForm.interval}
                                                        onChange={e => setHeroForm({...heroForm, interval: parseInt(e.target.value) || 5})}
                                                    />
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-[10px] font-black uppercase text-slate-400 mb-4">Hero Images</label>
                                                    <div className="space-y-4">
                                                        {heroForm.images.map((img, index) => (
                                                            <div key={index} className="flex gap-4">
                                                                <input
                                                                    type="url"
                                                                    className="flex-grow bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue"
                                                                    value={img}
                                                                    onChange={e => {
                                                                        const newImages = [...heroForm.images];
                                                                        newImages[index] = e.target.value;
                                                                        setHeroForm({...heroForm, images: newImages});
                                                                    }}
                                                                    placeholder={`Image URL ${index + 1}`}
                                                                />
                                                                {index > 0 && (
                                                                    <button
                                                                        type="button"
                                                                        onClick={() => {
                                                                            const newImages = heroForm.images.filter((_, i) => i !== index);
                                                                            setHeroForm({...heroForm, images: newImages});
                                                                        }}
                                                                        className="text-red-400 hover:text-red-600"
                                                                    >
                                                                        <i className="fas fa-times"></i>
                                                                    </button>
                                                                )}
                                                            </div>
                                                        ))}
                                                        <button
                                                            type="button"
                                                            onClick={() => setHeroForm({
                                                                ...heroForm, 
                                                                images: [...heroForm.images, '']
                                                            })}
                                                            className="text-brandBlue text-sm font-bold hover:underline"
                                                        >
                                                            + Add More Image
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <button
                                                    type="submit"
                                                    className="bg-brandBlue text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-blue-600 transition-all"
                                                >
                                                    Save Hero Settings
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                )}
                            </div>
                        ) : (
                            <>
                                {/* HERO SECTION */}
                                {activeSection === 'home' && (
                                    <>
                                        <section className="relative h-[600px] flex items-center overflow-hidden bg-brandDark">
                                            {heroConfig.images.filter(img => img && img.trim()).map((img, index) => {
                                                const activeImages = heroConfig.images.filter(i => i && i.trim());
                                                const isActive = index === currentSlide;
                                                return (
                                                    <div 
                                                        key={index} 
                                                        className={`absolute inset-0 bg-cover bg-center transition-opacity duration-1000 ease-in-out ${
                                                            isActive ? 'opacity-100 z-10' : 'opacity-0 z-0'
                                                        }`} 
                                                        style={{backgroundImage: `url('${img}')`}}
                                                    ></div>
                                                );
                                            })}
                                            {heroConfig.images.filter(img => img && img.trim()).length === 0 && (
                                                <div className="absolute inset-0 bg-slate-800 flex items-center justify-center text-slate-600 font-bold uppercase tracking-widest">
                                                    No Cover Images Configured
                                                </div>
                                            )}
                                            <div className="absolute inset-0 hero-overlay z-20"></div>
                                            <div className="relative z-30 max-w-7xl mx-auto px-4 w-full">
                                                <div className="max-w-3xl animate-fade-in">
                                                    <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 backdrop-blur border border-white/20 mb-6">
                                                        <span className="w-2 h-2 rounded-full bg-brandOrange animate-pulse"></span>
                                                        <span className="text-white text-[10px] font-bold uppercase tracking-widest">ISO 9001:2015 Certified</span>
                                                    </div>
                                                    <h2 className="text-5xl md:text-7xl font-black text-white leading-none mb-8 tracking-tighter">
                                                        FUTURE <br/>
                                                        <span className="text-transparent bg-clip-text bg-gradient-to-r from-brandBlue to-brandOrange">READY</span>
                                                    </h2>
                                                    <p className="text-xl text-slate-300 font-light leading-relaxed mb-10 max-w-xl">
                                                        Premier source for industrial automation components and turnkey electrical solutions in Bangladesh.
                                                    </p>
                                                    <div className="flex gap-4 flex-wrap">
                                                        <button 
                                                            onClick={() => setActiveSection('products')} 
                                                            className="bg-brandBlue text-white px-8 py-4 rounded-full font-black text-xs uppercase tracking-widest hover:bg-blue-600 transition-all shadow-lg hover:-translate-y-0.5"
                                                        >
                                                            View Catalog
                                                        </button>
                                                        <button 
                                                            onClick={() => setActiveSection('contact')} 
                                                            className="bg-white/5 backdrop-blur text-white border border-white/20 px-8 py-4 rounded-full font-black text-xs uppercase tracking-widest hover:bg-white/10 transition-all"
                                                        >
                                                            Contact Us
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2">
                                                {heroConfig.images.filter(img => img && img.trim()).map((_, idx) => (
                                                    <div 
                                                        key={idx} 
                                                        className={`h-1.5 rounded-full transition-all duration-300 ${
                                                            idx === currentSlide ? 'w-8 bg-brandOrange' : 'w-2 bg-white/30'
                                                        }`}
                                                    ></div>
                                                ))}
                                            </div>
                                        </section>

                                        {/* BRANDS CAROUSEL */}
                                        <section className="bg-white border-b border-slate-100 py-12 overflow-hidden relative">
                                            <div className="absolute left-0 top-0 bottom-0 w-32 z-10 pointer-events-none" 
                                                 style={{background: 'linear-gradient(to right, white, transparent)'}}>
                                            </div>
                                            <div className="absolute right-0 top-0 bottom-0 w-32 z-10 pointer-events-none" 
                                                 style={{background: 'linear-gradient(to left, white, transparent)'}}>
                                            </div>
                                            <div className="relative w-full overflow-hidden">
                                                <div className="flex w-[200%] animate-scroll">
                                                    {[...brands, ...brands].map((b, i) => (
                                                        <div 
                                                            key={i} 
                                                            className="flex-1 flex justify-center items-center px-12 min-w-[200px] cursor-pointer hover:opacity-100 transition-opacity"
                                                            onClick={() => handleBrandClick(b.name)}
                                                        >
                                                            <img 
                                                                src={b.logo} 
                                                                alt={b.name}
                                                                className="h-12 w-auto object-contain opacity-50 hover:opacity-100 transition-opacity" 
                                                                title={`Click to view ${b.name} products`}
                                                                onError={(e) => {
                                                                    e.target.onerror = null;
                                                                    e.target.src = 'https://via.placeholder.com/120x40?text=Brand';
                                                                }}
                                                            />
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </section>
                                    </>
                                )}

                                {/* PRODUCTS SECTION */}
                                {activeSection === 'products' && (
                                    <section className="py-20 max-w-7xl mx-auto px-4 animate-fadeIn">
                                        <div className="flex flex-col md:flex-row justify-between items-end mb-12 gap-8">
                                            <div>
                                                <h2 className="text-4xl font-black text-brandDark uppercase tracking-tighter">
                                                    {selectedBrand ? `${selectedBrand} Products` : 'Our Products'}
                                                </h2>
                                                <div className="h-1.5 w-20 bg-brandBlue mt-2 rounded-full"></div>
                                                {selectedBrand && (
                                                    <button 
                                                        onClick={() => setSelectedBrand(null)}
                                                        className="mt-2 text-xs text-brandBlue hover:underline flex items-center gap-1"
                                                    >
                                                        <i className="fas fa-times"></i> Clear Brand Filter
                                                    </button>
                                                )}
                                                <p className="text-slate-500 mt-4 max-w-2xl">
                                                    Browse our extensive collection of industrial automation components and electrical equipment from world-leading brands.
                                                </p>
                                            </div>
                                            <div className="relative w-full md:w-80">
                                                <input 
                                                    type="text" 
                                                    placeholder="Search products..." 
                                                    className="w-full bg-white border border-slate-200 rounded-full py-3 px-6 pl-12 text-sm font-bold shadow-sm focus:outline-none focus:border-brandBlue focus:ring-1 focus:ring-brandBlue transition-all" 
                                                    value={searchQuery}
                                                    onChange={e => setSearchQuery(e.target.value)} 
                                                />
                                                <i className="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                            </div>
                                        </div>

                                        {/* Category Filter */}
                                        <div className="flex flex-wrap gap-2 mb-8">
                                            {categories.map(cat => (
                                                <button
                                                    key={cat}
                                                    onClick={() => setActiveCategory(cat)}
                                                    className={`px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wider transition-all ${
                                                        activeCategory === cat
                                                            ? 'bg-brandBlue text-white'
                                                            : 'bg-slate-100 text-slate-500 hover:bg-slate-200'
                                                    }`}
                                                >
                                                    {cat}
                                                </button>
                                            ))}
                                        </div>
                                        
                                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                                            {filteredProducts.length === 0 ? (
                                                <div className="col-span-full text-center py-20">
                                                    <i className="fas fa-box-open text-6xl text-slate-200 mb-4"></i>
                                                    <p className="text-slate-400 font-bold uppercase tracking-widest">No products found</p>
                                                </div>
                                            ) : (
                                                filteredProducts.map(p => (
                                                    <div 
                                                        key={p.id} 
                                                        className="group bg-white rounded-[2rem] p-6 border border-slate-100 hover:shadow-2xl hover:shadow-brandBlue/10 transition-all duration-300 relative cursor-pointer"
                                                        onClick={() => openProductModal(p)}
                                                    >
                                                        <div className="absolute top-6 right-6 z-10">
                                                            {STOCK_STATUS_OPTIONS.map(option => {
                                                                if (option.value === p.stockStatus) {
                                                                    return (
                                                                        <span key={option.value} className={`stock-badge ${option.color} text-white`}>
                                                                            {option.label}
                                                                        </span>
                                                                    );
                                                                }
                                                                return null;
                                                            })}
                                                        </div>

                                                        <div className="aspect-square bg-slate-50 rounded-2xl mb-6 p-8 relative overflow-hidden flex items-center justify-center">
                                                            <img 
                                                                src={p.image} 
                                                                alt={p.name}
                                                                className="max-w-full max-h-full object-contain mix-blend-multiply group-hover:scale-110 transition-transform duration-500" 
                                                                onError={(e) => {
                                                                    e.target.onerror = null;
                                                                    e.target.src = 'https://via.placeholder.com/200?text=Product';
                                                                }}
                                                            />
                                                            <div className="absolute top-4 left-4 bg-white/90 backdrop-blur px-2 py-1 rounded text-[9px] font-black uppercase text-brandDark">
                                                                {p.brand}
                                                                {p.origin && <span className="ml-1">({p.origin})</span>}
                                                            </div>
                                                        </div>
                                                        
                                                        <h3 className="font-bold text-brandDark text-sm mb-2 line-clamp-2 h-10" title={p.name}>
                                                            {p.name}
                                                        </h3>
                                                        
                                                        {p.description && (
                                                            <p className="text-xs text-slate-400 mb-3 line-clamp-2">
                                                                {p.description}
                                                            </p>
                                                        )}
                                                        
                                                        <div className="flex justify-between items-start mb-4">
                                                            <p className="text-xs text-slate-400 font-bold bg-slate-50 px-2 py-1 rounded">
                                                                {p.category}
                                                            </p>
                                                            {p.stockStatus === 'in-stock' ? (
                                                                <div className="text-right">
                                                                    <p className="text-lg font-black text-brandBlue">à§³{p.price.toLocaleString()}</p>
                                                                    <p className="text-[9px] font-bold text-slate-400 uppercase tracking-wide">+ 5% AIT</p>
                                                                </div>
                                                            ) : (
                                                                <p className="text-xs font-bold text-orange-500 uppercase tracking-widest bg-orange-50 px-2 py-1 rounded">
                                                                    Price on Request
                                                                </p>
                                                            )}
                                                        </div>

                                                        {/* Datasheet Link */}
                                                        {p.datasheet && (
                                                            <div className="mb-3">
                                                                <a 
                                                                    href={p.datasheet} 
                                                                    target="_blank" 
                                                                    rel="noopener noreferrer"
                                                                    className="text-[8px] text-brandBlue hover:underline flex items-center gap-1"
                                                                    onClick={(e) => e.stopPropagation()}
                                                                >
                                                                    <i className="fas fa-file-pdf"></i>
                                                                    View Datasheet
                                                                </a>
                                                            </div>
                                                        )}

                                                        <div className="flex gap-2" onClick={e => e.stopPropagation()}>
                                                            {p.stockStatus === 'in-stock' ? (
                                                                <button 
                                                                    onClick={() => addToCart(p)} 
                                                                    className="flex-1 bg-brandDark text-white py-3 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-brandBlue transition-all shadow-lg hover:-translate-y-0.5 flex items-center justify-center gap-1"
                                                                >
                                                                    <i className="fas fa-shopping-cart"></i> ADD
                                                                </button>
                                                            ) : (
                                                                <button 
                                                                    onClick={() => openQuoteModal(p)} 
                                                                    className="flex-1 bg-brandOrange text-white border border-brandOrange py-3 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-orange-600 transition-all shadow-lg hover:-translate-y-0.5 flex items-center justify-center gap-1"
                                                                >
                                                                    <i className="fas fa-file-invoice"></i> QUOTE
                                                                </button>
                                                            )}
                                                        </div>
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                    </section>
                                )}

                                {/* SERVICES SECTION */}
                                {activeSection === 'services' && (
                                    <section className="py-24 bg-slate-100 animate-fadeIn">
                                        <div className="max-w-7xl mx-auto px-4">
                                            <div className="text-center mb-16">
                                                <h2 className="text-4xl font-black text-brandDark uppercase tracking-tighter">Our Services</h2>
                                                <div className="h-1.5 w-20 bg-brandBlue mt-2 rounded-full mx-auto"></div>
                                                <p className="text-slate-500 mt-4 max-w-2xl mx-auto">
                                                    Providing complete engineering support and solutions for your industrial automation needs.
                                                </p>
                                            </div>
                                            
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                                {SERVICES.map((s, i) => (
                                                    <div key={i} className="bg-white p-10 rounded-[2.5rem] shadow-sm hover:shadow-xl transition-all group hover:-translate-y-1 duration-300">
                                                        <div className="w-14 h-14 bg-brandBlue/10 text-brandBlue rounded-2xl flex items-center justify-center text-xl mb-6 group-hover:scale-110 group-hover:bg-brandBlue group-hover:text-white transition-all">
                                                            <i className={`fas ${s.icon}`}></i>
                                                        </div>
                                                        <h3 className="text-xl font-black text-brandDark mb-3">{s.title}</h3>
                                                        <p className="text-slate-500 text-sm leading-relaxed">{s.desc}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </section>
                                )}

                                {/* CONTACT SECTION - with Live Map and QR Codes */}
                                {activeSection === 'contact' && (
                                    <section className="py-24 max-w-4xl mx-auto px-4 animate-fadeIn">
                                        <div className="bg-white rounded-[3rem] shadow-2xl p-12 border border-slate-100">
                                            <h2 className="text-4xl font-black text-brandDark uppercase tracking-tighter mb-8 text-center">Get In Touch</h2>
                                            
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                                                <div className="bg-slate-50 p-6 rounded-2xl text-center hover:bg-brandBlue/5 transition-colors">
                                                    <i className="fas fa-phone-alt text-brandBlue text-2xl mb-2"></i>
                                                    <p className="font-bold text-brandDark text-sm">{COMPANY_INFO.phone}</p>
                                                    <p className="text-xs text-slate-400 mt-1">24/7 Support</p>
                                                </div>
                                                <div className="bg-slate-50 p-6 rounded-2xl text-center hover:bg-brandBlue/5 transition-colors">
                                                    <i className="fas fa-envelope text-brandOrange text-2xl mb-2"></i>
                                                    <p className="font-bold text-brandDark text-sm break-all">{COMPANY_INFO.email}</p>
                                                    <p className="text-xs text-slate-400 mt-1">Email Support</p>
                                                </div>
                                                <div className="bg-slate-50 p-6 rounded-2xl text-center hover:bg-brandBlue/5 transition-colors">
                                                    <i className="fas fa-map-marker-alt text-brandDark text-2xl mb-2"></i>
                                                    <p className="font-bold text-brandDark text-sm">Visit Our Showroom</p>
                                                    <p className="text-xs text-slate-400 mt-1">Map Available</p>
                                                </div>
                                            </div>

                                            {/* Bank Details Section */}
                                            <div className="mb-8 p-6 bg-blue-50 rounded-2xl">
                                                <h3 className="text-lg font-black text-brandBlue mb-4">Payment Details</h3>
                                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                    <div>
                                                        <p className="text-xs font-bold text-slate-400 mb-1">Bank Transfer</p>
                                                        <p className="font-bold">Account Name: {COMPANY_INFO.bankDetails.accountName}</p>
                                                        <p>A/C: {COMPANY_INFO.bankDetails.accountNumber}</p>
                                                        <p>Bank: {COMPANY_INFO.bankDetails.bankName}</p>
                                                        <p>Branch: {COMPANY_INFO.bankDetails.branch}</p>
                                                    </div>
                                                    <div>
                                                        <p className="text-xs font-bold text-slate-400 mb-1">Mobile Banking</p>
                                                        <p className="font-bold">bKash/Nagad/Rocket:</p>
                                                        <p>{COMPANY_INFO.bankDetails.mobileBanking}</p>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Certificates Section - Only Trade License */}
                                            <div className="mb-8 flex justify-center gap-4">
                                                {tradeLicenseFile && (
                                                    <button 
                                                        onClick={() => openDocumentViewer(tradeLicenseFile)}
                                                        className="flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-green-600 transition-colors"
                                                    >
                                                        <i className="fas fa-certificate"></i>
                                                        View Trade License
                                                    </button>
                                                )}
                                            </div>
                                            
                                            {/* Live Map */}
                                            <div className="mb-8">
                                                <h3 className="text-lg font-black text-brandDark mb-4">Our Location</h3>
                                                <div className="map-container" ref={mapRef}></div>
                                                <p className="text-xs text-slate-400 mt-2 text-center">{COMPANY_INFO.address}</p>
                                            </div>
                                            
                                            <div className="text-center">
                                                <a 
                                                    href={getWhatsAppLink(COMPANY_INFO.whatsapp, 'Hello, I need help with your products')}
                                                    target="_blank"
                                                    rel="noopener noreferrer"
                                                    className="inline-flex items-center gap-3 bg-[#25D366] text-white px-10 py-4 rounded-full font-black uppercase tracking-widest hover:bg-[#20bd5a] transition-all shadow-xl hover:-translate-y-1"
                                                >
                                                    <i className="fab fa-whatsapp text-2xl"></i>
                                                    WhatsApp Us
                                                </a>
                                            </div>
                                        </div>
                                    </section>
                                )}
                            </>
                        )}
                    </main>

                    {/* PUBLIC FOOTER - with QR codes always visible */}
                    {!isAdminMode && (
                        <footer className="bg-brandDark text-white pt-20 pb-10">
                            <div className="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-12 mb-16">
                                <div className="md:col-span-2">
                                    <div className="flex items-center gap-3 mb-6">
                                        <div className="w-10 h-10 bg-gradient-to-br from-brandBlue to-brandOrange rounded-xl flex items-center justify-center text-white font-black text-lg">
                                            SA
                                        </div>
                                        <h2 className="text-2xl font-black uppercase tracking-tighter">
                                            SHAFA ABID <span className="text-brandBlue">AUTOMATION</span>
                                        </h2>
                                    </div>
                                    <p className="text-slate-400 text-sm mb-8 max-w-sm leading-relaxed">
                                        {COMPANY_INFO.slogan} - Your trusted partner in industrial automation solutions.
                                    </p>
                                    <div className="flex gap-4 flex-wrap">
                                        {/* Social Icons with proper handlers */}
                                        <button
                                            onClick={() => handleSocialClick('facebook', COMPANY_INFO.facebook)}
                                            className="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-facebook transition-all hover:-translate-y-1 social-link"
                                            title="Facebook"
                                        >
                                            <i className="fab fa-facebook-f"></i>
                                        </button>
                                        <button
                                            onClick={() => handleSocialClick('wechat', '')}
                                            className="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-wechat transition-all hover:-translate-y-1 social-link"
                                            title="WeChat"
                                        >
                                            <i className="fab fa-weixin"></i>
                                        </button>
                                        <button
                                            onClick={() => handleSocialClick('map', COMPANY_INFO.mapLink)}
                                            className="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-green-600 transition-all hover:-translate-y-1 social-link"
                                            title="Location"
                                        >
                                            <i className="fas fa-map-marker-alt"></i>
                                        </button>
                                        <button
                                            onClick={() => handleSocialClick('whatsapp', getWhatsAppLink(COMPANY_INFO.whatsapp, 'Hello, I have a question'))}
                                            className="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-[#25D366] transition-all hover:-translate-y-1 social-link"
                                            title="WhatsApp"
                                        >
                                            <i className="fab fa-whatsapp"></i>
                                        </button>
                                        <a 
                                            href={`mailto:${COMPANY_INFO.email}`} 
                                            className="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-brandBlue transition-all hover:-translate-y-1 social-link"
                                            title="Email"
                                        >
                                            <i className="fas fa-envelope"></i>
                                        </a>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 className="font-black text-[10px] uppercase tracking-[0.2em] text-brandOrange mb-6">Location</h4>
                                    <p className="text-slate-400 text-sm leading-relaxed mb-4">
                                        {COMPANY_INFO.address}
                                    </p>
                                    <button
                                        onClick={() => handleSocialClick('map', COMPANY_INFO.mapLink)}
                                        className="text-brandBlue text-xs font-bold hover:underline"
                                    >
                                        View on Map â†’
                                    </button>
                                </div>
                                
                                <div>
                                    <h4 className="font-black text-[10px] uppercase tracking-[0.2em] text-brandBlue mb-6">Contact</h4>
                                    <p className="text-white font-bold mb-2 text-sm">{COMPANY_INFO.phone}</p>
                                    <p className="text-slate-400 text-sm mb-2 break-all">{COMPANY_INFO.email}</p>
                                    <p className="text-xs text-slate-500 mt-4">
                                        <i className="fab fa-weixin mr-2 text-wechat"></i>
                                        WeChat: {COMPANY_INFO.wechat}
                                    </p>
                                    <p className="text-xs text-slate-500 mt-2">
                                        <i className="fas fa-mobile-alt mr-2 text-brandOrange"></i>
                                        Mobile Banking: {COMPANY_INFO.bankDetails.mobileBanking}
                                    </p>
                                </div>
                            </div>
                            
                            <div className="max-w-7xl mx-auto px-4 pt-8 border-t border-white/10 text-center md:text-left flex flex-col md:flex-row justify-between items-center text-[10px] font-bold uppercase tracking-widest text-slate-500">
                                <p>Â© {new Date().getFullYear()} {COMPANY_INFO.name}. All rights reserved.</p>
                                <p className="mt-2 md:mt-0">Software Generated Invoice - No Signature Required</p>
                            </div>
                        </footer>
                    )}

                    {/* ADMIN LOGIN OVERLAY */}
                    {showAdminLogin && (
                        <div className="fixed inset-0 z-[100] bg-brandDark/90 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2.5rem] p-12 max-w-sm w-full text-center relative overflow-hidden">
                                <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-brandBlue to-brandOrange"></div>
                                <i className="fas fa-user-shield text-5xl text-brandBlue mb-4"></i>
                                <h2 className="text-2xl font-black text-brandDark uppercase mb-2">Staff Access</h2>
                                <p className="text-xs text-slate-400 mb-8">Enter your secure passkey</p>
                                
                                <input 
                                    type="password" 
                                    placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" 
                                    className="w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-4 text-center font-black text-lg tracking-[0.3em] mb-6 focus:border-brandBlue outline-none transition-all" 
                                    value={adminLoginInput} 
                                    onChange={e => setAdminLoginInput(e.target.value)} 
                                    onKeyDown={e => e.key === 'Enter' && handleAdminLogin()}
                                    autoFocus
                                />
                                
                                <button 
                                    onClick={handleAdminLogin} 
                                    className="w-full bg-brandDark text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-black transition-all mb-4 shadow-lg"
                                >
                                    Unlock
                                </button>
                                
                                <button 
                                    onClick={() => {
                                        setShowAdminLogin(false);
                                        setAdminLoginInput('');
                                    }} 
                                    className="text-slate-400 text-xs font-bold hover:text-brandDark transition-colors"
                                >
                                    Cancel
                                </button>
                            </div>
                        </div>
                    )}

                    {/* CUSTOMER AUTH MODAL */}
                    {showAuthModal && (
                        <div className="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-[2rem] max-w-md w-full p-8 relative">
                                <button 
                                    onClick={() => {
                                        setShowAuthModal(false);
                                        setAuthForm({ name: '', phone: '', password: '', road: '', thana: '', city: '', profilePic: null });
                                    }} 
                                    className="absolute top-4 right-4 w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-400 hover:bg-red-50 hover:text-red-500 transition-colors"
                                >
                                    <i className="fas fa-times"></i>
                                </button>
                                
                                <div className="text-center mb-6">
                                    <i className={`fas ${authMode === 'login' ? 'fa-user-circle' : 'fa-user-plus'} text-4xl text-brandBlue mb-2`}></i>
                                    <h2 className="text-2xl font-black text-brandDark uppercase">
                                        {authMode === 'login' ? 'Welcome Back' : 'Create Account'}
                                    </h2>
                                    <p className="text-xs text-slate-400 mt-1">
                                        {authMode === 'login' 
                                            ? 'Sign in to access your orders' 
                                            : 'Join for faster checkout'}
                                    </p>
                                </div>
                                
                                <form onSubmit={handleAuthSubmit} className="space-y-4">
                                    {authMode === 'register' && (
                                        <>
                                            <div>
                                                <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Profile Picture</label>
                                                <div className="flex items-center gap-4">
                                                    {authForm.profilePic ? (
                                                        <img 
                                                            src={authForm.profilePic} 
                                                            alt="Profile Preview"
                                                            className="w-16 h-16 rounded-full object-cover border-2 border-brandBlue"
                                                        />
                                                    ) : (
                                                        <div className="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center">
                                                            <i className="fas fa-user text-2xl text-slate-400"></i>
                                                        </div>
                                                    )}
                                                    <input
                                                        type="file"
                                                        accept="image/*"
                                                        onChange={handleProfilePicUpload}
                                                        className="text-sm"
                                                    />
                                                </div>
                                            </div>
                                            <div>
                                                <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Full Name</label>
                                                <input 
                                                    required 
                                                    type="text" 
                                                    placeholder="Enter your full name" 
                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue transition-all" 
                                                    value={authForm.name} 
                                                    onChange={e => setAuthForm({...authForm, name: e.target.value})} 
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Address (Optional)</label>
                                                <input
                                                    type="text"
                                                    className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue transition-all mb-2"
                                                    value={authForm.road || ''}
                                                    onChange={e => setAuthForm({...authForm, road: e.target.value})}
                                                    placeholder="Road / Village"
                                                />
                                                <div className="grid grid-cols-2 gap-2">
                                                    <input
                                                        type="text"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue transition-all"
                                                        value={authForm.thana || ''}
                                                        onChange={e => setAuthForm({...authForm, thana: e.target.value})}
                                                        placeholder="Thana"
                                                    />
                                                    <input
                                                        type="text"
                                                        className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue transition-all"
                                                        value={authForm.city || ''}
                                                        onChange={e => setAuthForm({...authForm, city: e.target.value})}
                                                        placeholder="City"
                                                    />
                                                </div>
                                            </div>
                                        </>
                                    )}
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Phone Number</label>
                                        <input 
                                            required 
                                            type="tel" 
                                            placeholder="01XXXXXXXXX" 
                                            className={`w-full bg-slate-50 border ${
                                                authForm.phone && !validatePhoneNumber(authForm.phone) 
                                                    ? 'border-red-300 focus:border-red-500' 
                                                    : 'border-slate-200 focus:border-brandBlue'
                                            } rounded-xl p-3 text-sm font-bold outline-none transition-all`} 
                                            value={authForm.phone} 
                                            onChange={e => {
                                                const value = e.target.value.replace(/\D/g, '').slice(0, 11);
                                                setAuthForm({...authForm, phone: value});
                                            }} 
                                        />
                                        {authForm.phone && !validatePhoneNumber(authForm.phone) && (
                                            <p className="text-red-500 text-[9px] font-bold mt-1">Enter valid 11-digit number starting with 0</p>
                                        )}
                                    </div>
                                    
                                    <div>
                                        <label className="block text-[10px] font-black uppercase text-slate-400 mb-2">Password</label>
                                        <div className="password-input-container">
                                            <input 
                                                required 
                                                type={showPassword ? "text" : "password"}
                                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" 
                                                className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm font-bold outline-none focus:border-brandBlue transition-all pr-10" 
                                                value={authForm.password} 
                                                onChange={e => {
                                                    setAuthForm({...authForm, password: e.target.value});
                                                    setPasswordStrength(checkPasswordStrength(e.target.value));
                                                }} 
                                            />
                                            <span 
                                                className="password-toggle"
                                                onClick={() => setShowPassword(!showPassword)}
                                            >
                                                <i className={`fas ${showPassword ? 'fa-eye-slash' : 'fa-eye'}`}></i>
                                            </span>
                                        </div>
                                        {authMode === 'register' && authForm.password && (
                                            <div className={`password-suggestion ${
                                                passwordStrength === 'Strong' ? 'password-strong' :
                                                passwordStrength === 'Medium' ? 'password-medium' : 'password-weak'
                                            }`}>
                                                <p className="text-[9px]">
                                                    Password Strength: <span className="font-bold">{passwordStrength}</span>
                                                </p>
                                                {passwordStrength !== 'Strong' && (
                                                    <p className="text-[8px] mt-1">
                                                        Suggested: <span className="font-mono bg-white px-1 rounded">{suggestedPassword}</span>
                                                    </p>
                                                )}
                                            </div>
                                        )}
                                    </div>
                                    
                                    <button 
                                        type="submit" 
                                        className="w-full bg-brandBlue text-white py-4 rounded-xl font-black uppercase tracking-widest shadow-xl hover:bg-blue-600 transition-all hover:-translate-y-0.5"
                                    >
                                        {authMode === 'login' ? 'Sign In' : 'Register'}
                                    </button>
                                </form>

                                <div className="mt-6 text-center">
                                    <button 
                                        onClick={() => {
                                            setAuthMode(authMode === 'login' ? 'register' : 'login');
                                            setAuthForm({ name: '', phone: '', password: '', road: '', thana: '', city: '', profilePic: null });
                                            setPasswordStrength('');
                                        }} 
                                        className="text-xs font-bold text-slate-400 hover:text-brandDark transition-colors"
                                    >
                                        {authMode === 'login' 
                                            ? "Don't have an account? Join now" 
                                            : "Already have an account? Sign In"}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Initialize React app
        const rootElement = document.getElementById('root');
        if (rootElement) {
            const root = ReactDOM.createRoot(rootElement);
            root.render(<App />);
        }
    </script>
</body>
</html>
